drop table if exists t1;
create table t1 (c1 int,c2 int,primary key (c1,c2),c3 int) partition by range columns(c1,c2)(partition a1 values less than (2,3),partition a2 values less than (4,5),partition a3 values less than (maxvalue,maxvalue));
insert into t1 values(1,2,3);
set yao_query_timeout=25000;
select * from t1;
ERROR HY000: YAO-12: request timeout
drop table if exists t1;
create table t1(c1 int primary key,c2 int) partition by range(c1)(partition q1 values less than (2),partition q2 values less than maxvalue);
set yao_query_timeout=50000;
replace into t1 values(1,1);
set query timeout to 500ms
set yao_query_timeout=500000;
select * from t1 where c1=1;
c1	c2
1	1
select count(*) from t1;
count(*)
1
select * from t1 union select * from t1;
c1	c2
1	1
update t1 set c2=2 where c1=1;
set query timeout to 100ms
set yao_query_timeout=100000;
select * from t1 where c1=1;
c1	c2
1	2
select count(*) from t1;
count(*)
1
select * from t1 union select * from t1;
c1	c2
1	2
update t1 set c2=2 where c1=1;
set query timeout to 25ms
set yao_query_timeout=25000;
select * from t1 where c1=1;
ERROR HY000: YAO-12: Timeout
select count(*) from t1;
ERROR HY000: YAO-12: request timeout
select * from t1 union select * from t1;
ERROR HY000: YAO-12: Timeout
set yao_query_timeout=30000;
update t1 set c2=2 where c1=1;
set query timeout to 10ms
set yao_query_timeout=10000;
select count(*) from t1;
ERROR HY000: YAO-12: request timeout
select * from t1 union select * from t1;
ERROR HY000: YAO-12: Timeout
select * from t1 where c1=1;
ERROR HY000: YAO-12: Timeout
drop table t1;
