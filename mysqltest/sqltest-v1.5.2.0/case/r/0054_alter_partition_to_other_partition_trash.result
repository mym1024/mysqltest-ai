drop table if exists t1_e,t2_e,t3_r,t2_r,t1_r,t4_r,t1_l,t2_l,t1_h,t2_h;
alter system set merge_delay_interval='1s' server_type=yaodatasvr;
alter system set major_freeze_wait_time='6s' server_type=yaoadminsvr;
alter system set min_major_freeze_interval='1s' server_type=yaotxnsvr;
alter system set min_merge_interval='1s' server_type=yaodatasvr;
set global trash_bin_switch = true;
alter system set balance_max_concurrent_migrate_num=30 server_type=yaoadminsvr;
alter system set balance_max_migrate_in_per_ds=6 server_type=yaoadminsvr;
alter system set balance_max_migrate_out_per_ds=6 server_type=yaoadminsvr;
alter system set max_migrate_task_count=6 server_type=yaodatasvr;
create enum partition function e_1(x) '[(1),(2),(3)],[(4),(5),(6)]';
create range partition function r_1(x) '(10),(20),(maxvalue)';
show partition functions;
rule_name	rule_par_num	rule_par_list	rule_body
boc_account_mixs	1	x	 
boc_card_mixs	1	x	 
e_1	1	x	[(1),(2),(3)],[(4),(5),(6)]
r_1	1	x	(10),(20),(maxvalue)
create table t1_e(a int primary key,b int) partition by(ee,e_1,a);
create table t2_e(a int primary key,b int) partition by(,e_1,a);
create index il1 on t1_e(b);
create index il1 on t2_e(b);
"refesh"
Okay
show index on t1_e;
index_name	status	index_type
__3001__idx__il1	4	0
show index on t2_e;
index_name	status	index_type
__3002__idx__il1	4	0
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
insert into t1_e values(1,1),(4,1),(2,1),(5,1);
insert into t1_e values(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
insert into t2_e values(1,1),(4,1),(2,1),(5,1);
insert into t2_e values(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
select * from t1_e;
a	b
1	1
2	1
4	1
5	1
delete from t1_e where a=2;
delete from t1_e where a=4;
select * from t1_e;
a	b
1	1
5	1
select * from t2_e;
a	b
1	1
2	1
4	1
5	1
delete from t2_e where a=2;
delete from t2_e where a=4;
select * from t2_e;
a	b
1	1
5	1
truncate table t1_e;
insert into t1_e values(1,1),(4,1),(2,1),(5,1);
truncate table t2_e;
insert into t2_e values(1,1),(4,1),(2,1),(5,1);
select * from t1_e;
a	b
1	1
2	1
4	1
5	1
delete from t1_e where a=2;
delete from t1_e where a=4;
select * from t1_e;
a	b
1	1
5	1
alter table t1_e partition rule to(rr,r_1,a);
select * from t2_e;
a	b
1	1
2	1
4	1
5	1
delete from t2_e where a=2;
delete from t2_e where a=4;
select * from t2_e;
a	b
1	1
5	1
alter table t2_e partition rule to(,r_1,a);
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#2	2	1	NULL
major_freeze...
merge: DONE
show index on t1_e;
index_name	status	index_type
__3001__idx__il1	1	0
select * from t1_e;
a	b
1	1
5	1
insert into t1_e values(4,1),(2,1),(8,1),(15,1),(20,1);
replace into t1_e values(8,3);
update t1_e set b=5 where a=2;
select * from t1_e;
a	b
1	1
2	5
4	1
5	1
8	3
15	1
20	1
delete from t1_e where a=1;
delete from t1_e where a=5;
select * from t1_e;
a	b
2	5
4	1
8	3
15	1
20	1
show index on t2_e;
index_name	status	index_type
__3002__idx__il1	1	0
select * from t2_e;
a	b
1	1
5	1
insert into t2_e values(4,1),(2,1),(8,1),(15,1),(20,1);
replace into t2_e values(8,3);
update t2_e set b=5 where a=2;
select * from t2_e;
a	b
1	1
2	5
4	1
5	1
8	3
15	1
20	1
delete from t2_e where a=1;
delete from t2_e where a=5;
select * from t2_e;
a	b
2	5
4	1
8	3
15	1
20	1
truncate table t1_e;
select * from t1_e;
a	b
insert into t1_e values(4,1),(2,1),(8,1);
select * from t1_e;
a	b
2	1
4	1
8	1
truncate table t2_e;
select * from t2_e;
a	b
insert into t2_e values(4,1),(2,1),(8,1);
select * from t2_e;
a	b
2	1
4	1
8	1
major_freeze...
merge: DONE
show index on t1_e;
index_name	status	index_type
__3001__idx__il1	1	0
select * from t1_e;
a	b
2	1
4	1
8	1
show index on t2_e;
index_name	status	index_type
__3002__idx__il1	1	0
select * from t2_e;
a	b
2	1
4	1
8	1
drop table  t1_e,t2_e;
create enum partition function e_2(x) '[(1),(2),(3)],[(4),(5),(6)]';
create hash partition function h_1(x) 'x';
show partition functions;
rule_name	rule_par_num	rule_par_list	rule_body
boc_account_mixs	1	x	 
boc_card_mixs	1	x	 
e_1	1	x	[(1),(2),(3)],[(4),(5),(6)]
e_2	1	x	[(1),(2),(3)],[(4),(5),(6)]
h_1	1	x	x
r_1	1	x	(10),(20),(maxvalue)
create table t1_e(a int primary key,b int) partition by(ee,e_2,a);
create table t2_e(a int primary key,b int) partition by(,e_2,a);
create index il1 on t1_e(b);
create index il1 on t2_e(b);
"refesh"
Okay
show index on t1_e;
index_name	status	index_type
__3005__idx__il1	4	0
show index on t2_e;
index_name	status	index_type
__3006__idx__il1	4	0
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#2	2	1	NULL
insert into t1_e values(1,1),(4,1),(2,1),(5,1);
insert into t1_e values(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
insert into t2_e values(1,1),(4,1),(2,1),(5,1);
insert into t2_e values(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
select * from t1_e;
a	b
1	1
2	1
4	1
5	1
delete from t1_e where a=2;
delete from t1_e where a=4;
select * from t1_e;
a	b
1	1
5	1
select * from t2_e;
a	b
1	1
2	1
4	1
5	1
delete from t2_e where a=2;
delete from t2_e where a=4;
select * from t2_e;
a	b
1	1
5	1
truncate table t1_e;
insert into t1_e values(1,1),(4,1),(2,1),(5,1);
truncate table t2_e;
insert into t2_e values(1,1),(4,1),(2,1),(5,1);
select * from t1_e;
a	b
1	1
2	1
4	1
5	1
delete from t1_e where a=2;
delete from t1_e where a=4;
select * from t1_e;
a	b
1	1
5	1
alter table t1_e partition rule to(hh,h_1,a);
select * from t2_e;
a	b
1	1
2	1
4	1
5	1
delete from t2_e where a=2;
delete from t2_e where a=4;
select * from t2_e;
a	b
1	1
5	1
alter table t2_e partition rule to(,h_1,a);
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
major_freeze...
merge: DONE
show index on t1_e;
index_name	status	index_type
__3005__idx__il1	1	0
select * from t1_e;
a	b
1	1
5	1
insert into t1_e values(4,1),(2,1),(8,1),(15,1),(20,1);
replace into t1_e values(8,3);
update t1_e set b=5 where a=2;
select * from t1_e;
a	b
1	1
2	5
4	1
5	1
8	3
15	1
20	1
delete from t1_e where a=1;
delete from t1_e where a=5;
select * from t1_e;
a	b
2	5
4	1
8	3
15	1
20	1
show index on t2_e;
index_name	status	index_type
__3006__idx__il1	1	0
select * from t2_e;
a	b
1	1
5	1
insert into t2_e values(4,1),(2,1),(8,1),(15,1),(20,1);
replace into t2_e values(8,3);
update t2_e set b=5 where a=2;
select * from t2_e;
a	b
1	1
2	5
4	1
5	1
8	3
15	1
20	1
delete from t2_e where a=1;
delete from t2_e where a=5;
select * from t2_e;
a	b
2	5
4	1
8	3
15	1
20	1
truncate table t1_e;
select * from t1_e;
a	b
insert into t1_e values(4,1),(2,1),(8,1);
select * from t1_e;
a	b
2	1
4	1
8	1
truncate table t2_e;
select * from t2_e;
a	b
insert into t2_e values(4,1),(2,1),(8,1);
select * from t2_e;
a	b
2	1
4	1
8	1
major_freeze...
merge: DONE
show index on t1_e;
index_name	status	index_type
__3005__idx__il1	1	0
select * from t1_e;
a	b
2	1
4	1
8	1
show index on t2_e;
index_name	status	index_type
__3006__idx__il1	1	0
select * from t2_e;
a	b
2	1
4	1
8	1
drop table  t1_e,t2_e;
create range partition function r_2(x) '(10),(20),(maxvalue)';
show partition functions;
rule_name	rule_par_num	rule_par_list	rule_body
boc_account_mixs	1	x	 
boc_card_mixs	1	x	 
e_1	1	x	[(1),(2),(3)],[(4),(5),(6)]
e_2	1	x	[(1),(2),(3)],[(4),(5),(6)]
h_1	1	x	x
r_1	1	x	(10),(20),(maxvalue)
r_2	1	x	(10),(20),(maxvalue)
create table t1_l(a int primary key,b int) partition by list(a) (partition p0 values in(1,2,3),partition p1 values in(4,5,6)) with prefix(ll);
create table t2_l(a int primary key,b int) partition by list(a) (partition p0 values in(1,2,3),partition p1 values in(4,5,6));
create index il1 on t1_l(b);
create index il1 on t2_l(b);
"refesh"
Okay
show index on t1_l;
index_name	status	index_type
__3009__idx__il1	4	0
show index on t2_l;
index_name	status	index_type
__3010__idx__il1	4	0
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
insert into t1_l values(1,1),(4,1),(2,1),(5,1);
insert into t1_l values(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
insert into t2_l values(1,1),(4,1),(2,1),(5,1);
insert into t2_l values(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
select * from t1_l;
a	b
1	1
2	1
4	1
5	1
delete from t1_l where a=2;
delete from t1_l where a=4;
select * from t1_l;
a	b
1	1
5	1
select * from t2_l;
a	b
1	1
2	1
4	1
5	1
delete from t2_l where a=2;
delete from t2_l where a=4;
select * from t2_l;
a	b
1	1
5	1
truncate table t1_l;
insert into t1_l values(1,1),(4,1),(2,1),(5,1);
truncate table t2_l;
insert into t2_l values(1,1),(4,1),(2,1),(5,1);
select * from t1_l;
a	b
1	1
2	1
4	1
5	1
delete from t1_l where a=2;
delete from t1_l where a=4;
select * from t1_l;
a	b
1	1
5	1
alter table t1_l partition rule to(rr,r_2,a);
select * from t2_l;
a	b
1	1
2	1
4	1
5	1
delete from t2_l where a=2;
delete from t2_l where a=4;
select * from t1_l;
a	b
1	1
5	1
alter table t1_l partition rule to(,r_2,a);
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
major_freeze...
merge: DONE
show index on t1_l;
index_name	status	index_type
__3009__idx__il1	1	0
select * from t1_l;
a	b
1	1
5	1
insert into t1_l values(4,1),(2,1),(8,1);
replace into t1_l values(8,3);
insert into t1_l values(10,1),(20,1),(15,1);
update t1_l set b=5 where a=2;
select * from t1_l;
a	b
1	1
2	5
4	1
5	1
8	3
10	1
15	1
20	1
delete from t1_l where a=1;
delete from t1_l where a=5;
select * from t1_l;
a	b
2	5
4	1
8	3
10	1
15	1
20	1
show index on t2_l;
index_name	status	index_type
__3010__idx__il1	1	0
select * from t2_l;
a	b
1	1
5	1
insert into t2_l values(4,1),(2,1),(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
replace into t2_l values(8,3);
ERROR HY000: YAO-5702: Table has no partition for given value.
insert into t2_l values(10,1),(20,1),(15,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
update t2_l set b=5 where a=2;
select * from t2_l;
a	b
1	1
5	1
delete from t2_l where a=1;
delete from t2_l where a=5;
select * from t2_l;
a	b
truncate table t1_l;
select * from t1_l;
a	b
insert into t1_l values(4,1),(2,1),(8,1);
select * from t1_l;
a	b
2	1
4	1
8	1
truncate table t2_l;
select * from t2_l;
a	b
insert into t2_l values(4,1),(2,1),(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
select * from t2_l;
a	b
major_freeze...
merge: DONE
show index on t1_l;
index_name	status	index_type
__3009__idx__il1	1	0
select * from t1_l;
a	b
2	1
4	1
8	1
show index on t2_l;
index_name	status	index_type
__3010__idx__il1	1	0
select * from t2_l;
a	b
drop table  t1_l,t2_l;
create hash partition function h_3(x) 'x';
show partition functions;
rule_name	rule_par_num	rule_par_list	rule_body
boc_account_mixs	1	x	 
boc_card_mixs	1	x	 
e_1	1	x	[(1),(2),(3)],[(4),(5),(6)]
e_2	1	x	[(1),(2),(3)],[(4),(5),(6)]
h_1	1	x	x
h_3	1	x	x
r_1	1	x	(10),(20),(maxvalue)
r_2	1	x	(10),(20),(maxvalue)
__list@3009	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3010	1	a	[(1),(2),(3)],[(4),(5),(6)]
create table t1_l(a int primary key,b int) partition by list(a) (partition p0 values in(1,2,3),partition p1 values in(4,5,6)) with prefix(ll);
create table t2_l(a int primary key,b int) partition by list(a) (partition p0 values in(1,2,3),partition p1 values in(4,5,6));
create index il1 on t1_l(b);
create index il1 on t2_l(b);
"refesh"
Okay
show index on t1_l;
index_name	status	index_type
__3013__idx__il1	4	0
show index on t2_l;
index_name	status	index_type
__3014__idx__il1	4	0
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
insert into t1_l values(1,1),(4,1),(2,1),(5,1);
insert into t1_l values(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
insert into t2_l values(1,1),(4,1),(2,1),(5,1);
insert into t2_l values(8,1);
ERROR HY000: YAO-5702: Table has no partition for given value.
select * from t1_l;
a	b
1	1
2	1
4	1
5	1
delete from t1_l where a=2;
delete from t1_l where a=4;
select * from t1_l;
a	b
1	1
5	1
select * from t2_l;
a	b
1	1
2	1
4	1
5	1
delete from t2_l where a=2;
delete from t2_l where a=4;
select * from t2_l;
a	b
1	1
5	1
truncate table t1_l;
insert into t1_l values(1,1),(4,1),(2,1),(5,1);
truncate table t2_l;
insert into t2_l values(1,1),(4,1),(2,1),(5,1);
select * from t1_l;
a	b
1	1
2	1
4	1
5	1
delete from t1_l where a=2;
delete from t1_l where a=4;
select * from t1_l;
a	b
1	1
5	1
alter table t1_l partition rule to(hh,h_3,a);
select * from t2_l;
a	b
1	1
2	1
4	1
5	1
delete from t2_l where a=2;
delete from t2_l where a=4;
select * from t2_l;
a	b
1	1
5	1
alter table t2_l partition rule to(,h_3,a);
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
major_freeze...
merge: DONE
show index on t1_l;
index_name	status	index_type
__3013__idx__il1	1	0
select * from t1_l;
a	b
1	1
5	1
insert into t1_l values(4,1),(2,1),(8,1);
replace into t1_l values(8,3);
insert into t1_l values(10,1),(20,1),(15,1);
update t1_l set b=5 where a=2;
select * from t1_l;
a	b
1	1
2	5
4	1
5	1
8	3
10	1
15	1
20	1
delete from t1_l where a=1;
delete from t1_l where a=5;
select * from t1_l;
a	b
2	5
4	1
8	3
10	1
15	1
20	1
show index on t2_l;
index_name	status	index_type
__3014__idx__il1	1	0
select * from t2_l;
a	b
1	1
5	1
insert into t2_l values(4,1),(2,1),(8,1);
replace into t2_l values(8,3);
insert into t2_l values(10,1),(20,1),(15,1);
update t2_l set b=5 where a=2;
select * from t2_l;
a	b
1	1
2	5
4	1
5	1
8	3
10	1
15	1
20	1
delete from t2_l where a=1;
delete from t2_l where a=5;
select * from t2_l;
a	b
2	5
4	1
8	3
10	1
15	1
20	1
truncate table t1_l;
select * from t1_l;
a	b
insert into t1_l values(4,1),(2,1),(8,1);
select * from t1_l;
a	b
2	1
4	1
8	1
truncate table t2_l;
select * from t2_l;
a	b
insert into t2_l values(4,1),(2,1),(8,1);
select * from t2_l;
a	b
2	1
4	1
8	1
major_freeze...
merge: DONE
show index on t1_l;
index_name	status	index_type
__3013__idx__il1	1	0
select * from t1_l;
a	b
2	1
4	1
8	1
show index on t2_l;
index_name	status	index_type
__3014__idx__il1	1	0
select * from t2_l;
a	b
2	1
4	1
8	1
drop table  t1_l,t2_l;
create range partition function r_11(x) '(10),(20),(maxvalue)';
create range partition function r_22(x) '(20),(40),(maxvalue)';
show partition functions;
rule_name	rule_par_num	rule_par_list	rule_body
boc_account_mixs	1	x	 
boc_card_mixs	1	x	 
e_1	1	x	[(1),(2),(3)],[(4),(5),(6)]
e_2	1	x	[(1),(2),(3)],[(4),(5),(6)]
h_1	1	x	x
h_3	1	x	x
r_1	1	x	(10),(20),(maxvalue)
r_11	1	x	(10),(20),(maxvalue)
r_2	1	x	(10),(20),(maxvalue)
r_22	1	x	(20),(40),(maxvalue)
__list@3009	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3010	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3013	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3014	1	a	[(1),(2),(3)],[(4),(5),(6)]
create table t1_r(a int primary key,b int) partition by(rr,r_11,a);
create table t2_r(a int primary key,b int) partition by(,r_11,a);
create table t3_r(a int primary key,b int) partition by range(a)(partition p0 values less than(10),partition p1 values less than(20),partition p2 values less than(maxvalue)) with prefix(rr);
create table t4_r(a int primary key,b int) partition by range(a)(partition p0 values less than(10),partition p1 values less than(20),partition p2 values less than(maxvalue));
create index il1 on t3_r(b);
create index il1 on t2_r(b);
create index il1 on t1_r(b);
create index il1 on t4_r(b);
"refesh"
Okay
show index on t3_r;
index_name	status	index_type
__3019__idx__il1	4	0
show index on t2_r;
index_name	status	index_type
__3018__idx__il1	4	0
show index on t1_r;
index_name	status	index_type
__3017__idx__il1	4	0
show index on t4_r;
index_name	status	index_type
__3020__idx__il1	4	0
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
rr#p0	10	0	NULL
rr#p1	10	1	NULL
rr#p2	10	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
t2_r#0	10	1	NULL
t2_r#1	10	0	NULL
t2_r#2	10	1	NULL
t4_r#p0	10	1	NULL
t4_r#p1	10	0	NULL
t4_r#p2	10	1	NULL
insert into t1_r values(1,1),(10,1),(20,1);
insert into t2_r values(1,1),(10,1),(20,1);
insert into t3_r values(1,1),(10,1),(20,1);
insert into t4_r values(1,1),(10,1),(20,1);
select * from t1_r;
a	b
1	1
10	1
20	1
delete from t1_r where a=1;
delete from t1_r where a=10;
select * from t1_r;
a	b
20	1
select * from t2_r;
a	b
1	1
10	1
20	1
delete from t2_r where a=1;
delete from t2_r where a=10;
select * from t2_r;
a	b
20	1
select * from t3_r;
a	b
1	1
10	1
20	1
delete from t3_r where a=1;
delete from t3_r where a=10;
select * from t3_r;
a	b
20	1
select * from t4_r;
a	b
1	1
10	1
20	1
delete from t4_r where a=1;
delete from t4_r where a=10;
select * from t4_r;
a	b
20	1
truncate table t1_r;
insert into t1_r values(1,1),(10,1),(20,1);
truncate table t2_r;
insert into t2_r values(1,1),(10,1),(20,1);
truncate table t3_r;
insert into t3_r values(1,1),(10,1),(20,1);
truncate table t4_r;
insert into t4_r values(1,1),(10,1),(20,1);
select * from t3_r;
a	b
1	1
10	1
20	1
delete from t3_r where a=1;
delete from t3_r where a=10;
select * from t3_r;
a	b
20	1
alter table t3_r partition rule to (rr,r_22,a);
select * from t2_r;
a	b
1	1
10	1
20	1
delete from t2_r where a=1;
delete from t2_r where a=10;
select * from t2_r;
a	b
20	1
alter table t2_r partition rule to (,r_22,a);
select * from t1_r;
a	b
1	1
10	1
20	1
delete from t1_r where a=1;
delete from t1_r where a=10;
select * from t1_r;
a	b
20	1
alter table t1_r partition rule to (rr,r_22,a);
select * from t4_r;
a	b
1	1
10	1
20	1
delete from t4_r where a=1;
delete from t4_r where a=10;
select * from t4_r;
a	b
20	1
alter table t4_r partition rule to (,r_22,a);
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
rr#p0	10	0	NULL
rr#p1	10	1	NULL
rr#p2	10	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
t2_r#0	10	1	NULL
t2_r#1	10	0	NULL
t2_r#2	10	1	NULL
t4_r#0	10	1	NULL
t4_r#1	10	0	NULL
t4_r#2	10	1	NULL
t4_r#p0	10	1	NULL
t4_r#p1	10	0	NULL
t4_r#p2	10	1	NULL
major_freeze...
merge: DONE
show index on t3_r;
index_name	status	index_type
__3019__idx__il1	1	0
select * from t3_r;
a	b
20	1
insert into t3_r values(1,1),(10,1),(30,1);
replace into t3_r values(30,3);
update t3_r set b=5 where a=1;
select * from t3_r;
a	b
1	5
10	1
20	1
30	3
delete from t3_r where a=1;
delete from t3_r where a=10;
select * from t3_r;
a	b
20	1
30	3
show index on t4_r;
index_name	status	index_type
__3020__idx__il1	1	0
select * from t4_r;
a	b
20	1
insert into t4_r values(1,1),(10,1),(30,1);
replace into t4_r values(30,3);
update t4_r set b=5 where a=1;
select * from t4_r;
a	b
1	5
10	1
20	1
30	3
delete from t4_r where a=1;
delete from t4_r where a=10;
select * from t4_r;
a	b
20	1
30	3
show index on t2_r;
index_name	status	index_type
__3018__idx__il1	1	0
select * from t2_r;
a	b
20	1
insert into t2_r values(1,1),(10,1),(30,1);
replace into t2_r values(30,3);
update t2_r set b=5 where a=1;
select * from t2_r;
a	b
1	5
10	1
20	1
30	3
delete from t2_r where a=1;
delete from t2_r where a=10;
select * from t2_r;
a	b
20	1
30	3
show index on t1_r;
index_name	status	index_type
__3017__idx__il1	1	0
select * from t1_r;
a	b
20	1
insert into t1_r values(1,1),(10,1),(30,1);
replace into t1_r values(30,3);
update t1_r set b=5 where a=1;
select * from t1_r;
a	b
1	5
10	1
20	1
30	3
delete from t1_r where a=1;
delete from t1_r where a=10;
select * from t1_r;
a	b
20	1
30	3
truncate table t3_r;
select * from t3_r;
a	b
insert into t3_r values(1,1),(10,1),(20,1),(30,1);
select * from t3_r;
a	b
1	1
10	1
20	1
30	1
truncate table t1_r;
select * from t1_r;
a	b
insert into t1_r values(1,1),(10,1),(20,1),(30,1);
select * from t1_r;
a	b
1	1
10	1
20	1
30	1
truncate table t2_r;
select * from t2_r;
a	b
insert into t2_r values(1,1),(10,1),(20,1),(30,1);
select * from t2_r;
a	b
1	1
10	1
20	1
30	1
truncate table t4_r;
select * from t4_r;
a	b
insert into t4_r values(1,1),(10,1),(20,1),(30,1);
select * from t4_r;
a	b
1	1
10	1
20	1
30	1
major_freeze...
merge: DONE
show index on t3_r;
index_name	status	index_type
__3019__idx__il1	1	0
select * from t3_r;
a	b
1	1
10	1
20	1
30	1
show index on t2_r;
index_name	status	index_type
__3018__idx__il1	1	0
select * from t2_r;
a	b
1	1
10	1
20	1
30	1
show index on t1_r;
index_name	status	index_type
__3017__idx__il1	1	0
select * from t1_r;
a	b
1	1
10	1
20	1
30	1
show index on t4_r;
index_name	status	index_type
__3020__idx__il1	1	0
select * from t4_r;
a	b
1	1
10	1
20	1
30	1
drop table t3_r,t2_r,t1_r,t4_r;
create range partition function r_13(x) '(10),(20),(maxvalue)';
create hash partition function h_23(x) 'x';
show partition functions;
rule_name	rule_par_num	rule_par_list	rule_body
boc_account_mixs	1	x	 
boc_card_mixs	1	x	 
e_1	1	x	[(1),(2),(3)],[(4),(5),(6)]
e_2	1	x	[(1),(2),(3)],[(4),(5),(6)]
h_1	1	x	x
h_23	1	x	x
h_3	1	x	x
r_1	1	x	(10),(20),(maxvalue)
r_11	1	x	(10),(20),(maxvalue)
r_13	1	x	(10),(20),(maxvalue)
r_2	1	x	(10),(20),(maxvalue)
r_22	1	x	(20),(40),(maxvalue)
__list@3009	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3010	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3013	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3014	1	a	[(1),(2),(3)],[(4),(5),(6)]
__range@3019	1	a	(10),(20),(maxvalue)
__range@3020	1	a	(10),(20),(maxvalue)
create table t1_r(a int primary key,b int) partition by(rr,r_13,a);
create table t2_r(a int primary key,b int) partition by(,r_13,a);
create table t3_r(a int primary key,b int) partition by range(a)(partition p0 values less than(10),partition p1 values less than(20),partition p2 values less than(maxvalue)) with prefix(rr);
create table t4_r(a int primary key,b int) partition by range(a)(partition p0 values less than(10),partition p1 values less than(20),partition p2 values less than(maxvalue));
create index il1 on t3_r(b);
create index il1 on t2_r(b);
create index il1 on t1_r(b);
create index il1 on t4_r(b);
"refesh"
Okay
show index on t3_r;
index_name	status	index_type
__3027__idx__il1	4	0
show index on t2_r;
index_name	status	index_type
__3026__idx__il1	4	0
show index on t1_r;
index_name	status	index_type
__3025__idx__il1	4	0
show index on t4_r;
index_name	status	index_type
__3028__idx__il1	4	0
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
rr#p0	10	0	NULL
rr#p1	10	1	NULL
rr#p2	10	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
t2_r#0	10	1	NULL
t2_r#1	10	0	NULL
t2_r#2	10	1	NULL
t4_r#0	10	1	NULL
t4_r#1	10	0	NULL
t4_r#2	10	1	NULL
t4_r#p0	10	1	NULL
t4_r#p1	10	0	NULL
t4_r#p2	10	1	NULL
insert into t1_r values(1,1),(10,1),(20,1);
insert into t2_r values(1,1),(10,1),(20,1);
insert into t3_r values(1,1),(10,1),(20,1);
insert into t4_r values(1,1),(10,1),(20,1);
select * from t1_r;
a	b
1	1
10	1
20	1
delete from t1_r where a=1;
delete from t1_r where a=10;
select * from t1_r;
a	b
20	1
select * from t2_r;
a	b
1	1
10	1
20	1
delete from t2_r where a=1;
delete from t2_r where a=10;
select * from t2_r;
a	b
20	1
select * from t3_r;
a	b
1	1
10	1
20	1
delete from t3_r where a=1;
delete from t3_r where a=10;
select * from t3_r;
a	b
20	1
select * from t4_r;
a	b
1	1
10	1
20	1
delete from t4_r where a=1;
delete from t4_r where a=10;
select * from t4_r;
a	b
20	1
truncate table t1_r;
insert into t1_r values(1,1),(10,1),(20,1);
truncate table t2_r;
insert into t2_r values(1,1),(10,1),(20,1);
truncate table t3_r;
insert into t3_r values(1,1),(10,1),(20,1);
truncate table t4_r;
insert into t4_r values(1,1),(10,1),(20,1);
select * from t3_r;
a	b
1	1
10	1
20	1
delete from t3_r where a=1;
delete from t3_r where a=10;
select * from t3_r;
a	b
20	1
alter table t3_r partition rule to (hh,h_23,a);
select * from t2_r;
a	b
1	1
10	1
20	1
delete from t2_r where a=1;
delete from t2_r where a=10;
select * from t2_r;
a	b
20	1
alter table t2_r partition rule to (,h_23,a);
select * from t1_r;
a	b
1	1
10	1
20	1
delete from t1_r where a=1;
delete from t1_r where a=10;
select * from t1_r;
a	b
20	1
alter table t1_r partition rule to (hh,h_23,a);
select * from t4_r;
a	b
1	1
10	1
20	1
delete from t4_r where a=1;
delete from t4_r where a=10;
select * from t4_r;
a	b
20	1
alter table t4_r partition rule to (,h_23,a);
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
rr#p0	10	0	NULL
rr#p1	10	1	NULL
rr#p2	10	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
t2_r#0	10	1	NULL
t2_r#1	10	0	NULL
t2_r#10	12	1	NULL
t2_r#11	12	0	NULL
t2_r#12	12	1	NULL
t2_r#2	10	1	NULL
t2_r#3	12	0	NULL
t2_r#4	12	1	NULL
t2_r#5	12	0	NULL
t2_r#6	12	1	NULL
t2_r#7	12	0	NULL
t2_r#8	12	1	NULL
t2_r#9	12	0	NULL
t4_r#0	10	1	NULL
t4_r#1	10	0	NULL
t4_r#10	12	1	NULL
t4_r#11	12	0	NULL
t4_r#12	12	1	NULL
t4_r#2	10	1	NULL
t4_r#3	12	0	NULL
t4_r#4	12	1	NULL
t4_r#5	12	0	NULL
t4_r#6	12	1	NULL
t4_r#7	12	0	NULL
t4_r#8	12	1	NULL
t4_r#9	12	0	NULL
t4_r#p0	10	1	NULL
t4_r#p1	10	0	NULL
t4_r#p2	10	1	NULL
major_freeze...
merge: DONE
show index on t3_r;
index_name	status	index_type
__3027__idx__il1	1	0
select * from t3_r;
a	b
20	1
insert into t3_r values(1,1),(10,1),(30,1);
replace into t3_r values(30,3);
update t3_r set b=5 where a=1;
select * from t3_r;
a	b
1	5
10	1
20	1
30	3
delete from t3_r where a=1;
delete from t3_r where a=10;
select * from t3_r;
a	b
20	1
30	3
show index on t4_r;
index_name	status	index_type
__3028__idx__il1	1	0
select * from t4_r;
a	b
20	1
insert into t4_r values(1,1),(10,1),(30,1);
replace into t4_r values(30,3);
update t4_r set b=5 where a=1;
select * from t4_r;
a	b
1	5
10	1
20	1
30	3
delete from t4_r where a=1;
delete from t4_r where a=10;
select * from t4_r;
a	b
20	1
30	3
show index on t2_r;
index_name	status	index_type
__3026__idx__il1	1	0
select * from t2_r;
a	b
20	1
insert into t2_r values(1,1),(10,1),(30,1);
replace into t2_r values(30,3);
update t2_r set b=5 where a=1;
select * from t2_r;
a	b
1	5
10	1
20	1
30	3
delete from t2_r where a=1;
delete from t2_r where a=10;
select * from t2_r;
a	b
20	1
30	3
show index on t1_r;
index_name	status	index_type
__3025__idx__il1	1	0
select * from t1_r;
a	b
20	1
insert into t1_r values(1,1),(10,1),(30,1);
replace into t1_r values(30,3);
update t1_r set b=5 where a=1;
select * from t1_r;
a	b
1	5
10	1
20	1
30	3
delete from t1_r where a=1;
delete from t1_r where a=10;
select * from t1_r;
a	b
20	1
30	3
truncate table t3_r;
select * from t3_r;
a	b
insert into t3_r values(1,1),(10,1),(20,1),(30,1);
select * from t3_r;
a	b
1	1
10	1
20	1
30	1
truncate table t1_r;
select * from t1_r;
a	b
insert into t1_r values(1,1),(10,1),(20,1),(30,1);
select * from t1_r;
a	b
1	1
10	1
20	1
30	1
truncate table t2_r;
select * from t2_r;
a	b
insert into t2_r values(1,1),(10,1),(20,1),(30,1);
select * from t2_r;
a	b
1	1
10	1
20	1
30	1
truncate table t4_r;
select * from t4_r;
a	b
insert into t4_r values(1,1),(10,1),(20,1),(30,1);
select * from t4_r;
a	b
1	1
10	1
20	1
30	1
major_freeze...
merge: DONE
show index on t3_r;
index_name	status	index_type
__3027__idx__il1	1	0
select * from t3_r;
a	b
1	1
10	1
20	1
30	1
show index on t2_r;
index_name	status	index_type
__3026__idx__il1	1	0
select * from t2_r;
a	b
1	1
10	1
20	1
30	1
show index on t1_r;
index_name	status	index_type
__3025__idx__il1	1	0
select * from t1_r;
a	b
1	1
10	1
20	1
30	1
show index on t4_r;
index_name	status	index_type
__3028__idx__il1	1	0
select * from t4_r;
a	b
1	1
10	1
20	1
30	1
drop table t3_r,t2_r,t1_r,t4_r;
create hash partition function h_14(x) 'x';
create range partition function r_14(x) '(10),(20),(maxvalue)';
show partition functions;
rule_name	rule_par_num	rule_par_list	rule_body
boc_account_mixs	1	x	 
boc_card_mixs	1	x	 
e_1	1	x	[(1),(2),(3)],[(4),(5),(6)]
e_2	1	x	[(1),(2),(3)],[(4),(5),(6)]
h_1	1	x	x
h_14	1	x	x
h_23	1	x	x
h_3	1	x	x
r_1	1	x	(10),(20),(maxvalue)
r_11	1	x	(10),(20),(maxvalue)
r_13	1	x	(10),(20),(maxvalue)
r_14	1	x	(10),(20),(maxvalue)
r_2	1	x	(10),(20),(maxvalue)
r_22	1	x	(20),(40),(maxvalue)
__list@3009	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3010	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3013	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3014	1	a	[(1),(2),(3)],[(4),(5),(6)]
__range@3019	1	a	(10),(20),(maxvalue)
__range@3020	1	a	(10),(20),(maxvalue)
__range@3027	1	a	(10),(20),(maxvalue)
__range@3028	1	a	(10),(20),(maxvalue)
create table t1_h(a int primary key,b int) partition by(hh,h_14,a);
create table t2_h(a int primary key,b int) partition by(,h_14,a);
create index il1 on t1_h(b);
create index il1 on t2_h(b);
"refesh"
Okay
show index on t1_h;
index_name	status	index_type
__3033__idx__il1	4	0
show index on t2_h;
index_name	status	index_type
__3034__idx__il1	4	0
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
rr#p0	10	0	NULL
rr#p1	10	1	NULL
rr#p2	10	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_h#0	14	1	NULL
t2_h#1	14	0	NULL
t2_h#10	14	1	NULL
t2_h#11	14	0	NULL
t2_h#12	14	1	NULL
t2_h#2	14	1	NULL
t2_h#3	14	0	NULL
t2_h#4	14	1	NULL
t2_h#5	14	0	NULL
t2_h#6	14	1	NULL
t2_h#7	14	0	NULL
t2_h#8	14	1	NULL
t2_h#9	14	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
t2_r#0	10	1	NULL
t2_r#1	10	0	NULL
t2_r#10	12	1	NULL
t2_r#11	12	0	NULL
t2_r#12	12	1	NULL
t2_r#2	10	1	NULL
t2_r#3	12	0	NULL
t2_r#4	12	1	NULL
t2_r#5	12	0	NULL
t2_r#6	12	1	NULL
t2_r#7	12	0	NULL
t2_r#8	12	1	NULL
t2_r#9	12	0	NULL
t4_r#0	10	1	NULL
t4_r#1	10	0	NULL
t4_r#10	12	1	NULL
t4_r#11	12	0	NULL
t4_r#12	12	1	NULL
t4_r#2	10	1	NULL
t4_r#3	12	0	NULL
t4_r#4	12	1	NULL
t4_r#5	12	0	NULL
t4_r#6	12	1	NULL
t4_r#7	12	0	NULL
t4_r#8	12	1	NULL
t4_r#9	12	0	NULL
t4_r#p0	10	1	NULL
t4_r#p1	10	0	NULL
t4_r#p2	10	1	NULL
insert into t1_h values(1,1),(4,1),(2,1),(5,1);
insert into t2_h values(1,1),(4,1),(2,1),(5,1);
select * from t1_h;
a	b
1	1
2	1
4	1
5	1
delete from t1_h where a=2;
delete from t1_h where a=4;
select * from t1_h;
a	b
1	1
5	1
select * from t2_h;
a	b
1	1
2	1
4	1
5	1
delete from t2_h where a=2;
delete from t2_h where a=4;
select * from t2_h;
a	b
1	1
5	1
truncate table t1_h;
insert into t1_h values(1,1),(4,1),(2,1),(5,1);
truncate table t2_h;
insert into t2_h values(1,1),(4,1),(2,1),(5,1);
select * from t1_h;
a	b
1	1
2	1
4	1
5	1
delete from t1_h where a=2;
delete from t1_h where a=4;
select * from t1_h;
a	b
1	1
5	1
alter table t1_h partition rule to (rr,r_14,a);
select * from t2_h;
a	b
1	1
2	1
4	1
5	1
delete from t2_h where a=2;
delete from t2_h where a=4;
select * from t2_h;
a	b
1	1
5	1
alter table t2_h partition rule to (,r_14,a);
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
rr#p0	10	0	NULL
rr#p1	10	1	NULL
rr#p2	10	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_h#0	14	1	NULL
t2_h#1	14	0	NULL
t2_h#10	14	1	NULL
t2_h#11	14	0	NULL
t2_h#12	14	1	NULL
t2_h#2	14	1	NULL
t2_h#3	14	0	NULL
t2_h#4	14	1	NULL
t2_h#5	14	0	NULL
t2_h#6	14	1	NULL
t2_h#7	14	0	NULL
t2_h#8	14	1	NULL
t2_h#9	14	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
t2_r#0	10	1	NULL
t2_r#1	10	0	NULL
t2_r#10	12	1	NULL
t2_r#11	12	0	NULL
t2_r#12	12	1	NULL
t2_r#2	10	1	NULL
t2_r#3	12	0	NULL
t2_r#4	12	1	NULL
t2_r#5	12	0	NULL
t2_r#6	12	1	NULL
t2_r#7	12	0	NULL
t2_r#8	12	1	NULL
t2_r#9	12	0	NULL
t4_r#0	10	1	NULL
t4_r#1	10	0	NULL
t4_r#10	12	1	NULL
t4_r#11	12	0	NULL
t4_r#12	12	1	NULL
t4_r#2	10	1	NULL
t4_r#3	12	0	NULL
t4_r#4	12	1	NULL
t4_r#5	12	0	NULL
t4_r#6	12	1	NULL
t4_r#7	12	0	NULL
t4_r#8	12	1	NULL
t4_r#9	12	0	NULL
t4_r#p0	10	1	NULL
t4_r#p1	10	0	NULL
t4_r#p2	10	1	NULL
major_freeze...
merge: DONE
show index on t1_h;
index_name	status	index_type
__3033__idx__il1	1	0
select * from t1_h;
a	b
1	1
5	1
insert into t1_h values(4,1),(2,1),(8,1);
replace into t1_h values(8,3);
update t1_h set b=5 where a=2;
select * from t1_h;
a	b
1	1
2	5
4	1
5	1
8	3
delete from t1_h where a=1;
delete from t1_h where a=5;
select * from t1_h;
a	b
2	5
4	1
8	3
show index on t2_h;
index_name	status	index_type
__3034__idx__il1	1	0
select * from t2_h;
a	b
1	1
5	1
insert into t2_h values(4,1),(2,1),(8,1);
replace into t2_h values(8,3);
update t2_h set b=5 where a=2;
select * from t2_h;
a	b
1	1
2	5
4	1
5	1
8	3
delete from t2_h where a=1;
delete from t2_h where a=5;
select * from t2_h;
a	b
2	5
4	1
8	3
truncate table t1_h;
select * from t1_h;
a	b
insert into t1_h values(4,1),(2,1),(8,1);
select * from t1_h;
a	b
2	1
4	1
8	1
truncate table t2_h;
select * from t2_h;
a	b
insert into t2_h values(4,1),(2,1),(8,1);
select * from t2_h;
a	b
2	1
4	1
8	1
major_freeze...
merge: DONE
show index on t1_h;
index_name	status	index_type
__3033__idx__il1	1	0
select * from t1_h;
a	b
2	1
4	1
8	1
show index on t2_h;
index_name	status	index_type
__3034__idx__il1	1	0
select * from t2_h;
a	b
2	1
4	1
8	1
drop table t1_h,t2_h;
create hash partition function h_15(x) 'x';
create hash partition function h_25(x) 'x*3-1';
show partition functions;
rule_name	rule_par_num	rule_par_list	rule_body
boc_account_mixs	1	x	 
boc_card_mixs	1	x	 
e_1	1	x	[(1),(2),(3)],[(4),(5),(6)]
e_2	1	x	[(1),(2),(3)],[(4),(5),(6)]
h_1	1	x	x
h_14	1	x	x
h_15	1	x	x
h_23	1	x	x
h_25	1	x	x*3-1
h_3	1	x	x
r_1	1	x	(10),(20),(maxvalue)
r_11	1	x	(10),(20),(maxvalue)
r_13	1	x	(10),(20),(maxvalue)
r_14	1	x	(10),(20),(maxvalue)
r_2	1	x	(10),(20),(maxvalue)
r_22	1	x	(20),(40),(maxvalue)
__list@3009	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3010	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3013	1	a	[(1),(2),(3)],[(4),(5),(6)]
__list@3014	1	a	[(1),(2),(3)],[(4),(5),(6)]
__range@3019	1	a	(10),(20),(maxvalue)
__range@3020	1	a	(10),(20),(maxvalue)
__range@3027	1	a	(10),(20),(maxvalue)
__range@3028	1	a	(10),(20),(maxvalue)
create table t1_h(a int primary key,b int) partition by(hh,h_15,a);
create table t2_h(a int primary key,b int) partition by(,h_15,a);
create index il1 on t1_h(b);
create index il1 on t2_h(b);
"refesh"
Okay
show index on t1_h;
index_name	status	index_type
__3037__idx__il1	4	0
show index on t2_h;
index_name	status	index_type
__3038__idx__il1	4	0
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
rr#p0	10	0	NULL
rr#p1	10	1	NULL
rr#p2	10	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_h#0	14	1	NULL
t2_h#1	14	0	NULL
t2_h#10	14	1	NULL
t2_h#11	14	0	NULL
t2_h#12	14	1	NULL
t2_h#2	14	1	NULL
t2_h#3	14	0	NULL
t2_h#4	14	1	NULL
t2_h#5	14	0	NULL
t2_h#6	14	1	NULL
t2_h#7	14	0	NULL
t2_h#8	14	1	NULL
t2_h#9	14	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
t2_r#0	10	1	NULL
t2_r#1	10	0	NULL
t2_r#10	12	1	NULL
t2_r#11	12	0	NULL
t2_r#12	12	1	NULL
t2_r#2	10	1	NULL
t2_r#3	12	0	NULL
t2_r#4	12	1	NULL
t2_r#5	12	0	NULL
t2_r#6	12	1	NULL
t2_r#7	12	0	NULL
t2_r#8	12	1	NULL
t2_r#9	12	0	NULL
t4_r#0	10	1	NULL
t4_r#1	10	0	NULL
t4_r#10	12	1	NULL
t4_r#11	12	0	NULL
t4_r#12	12	1	NULL
t4_r#2	10	1	NULL
t4_r#3	12	0	NULL
t4_r#4	12	1	NULL
t4_r#5	12	0	NULL
t4_r#6	12	1	NULL
t4_r#7	12	0	NULL
t4_r#8	12	1	NULL
t4_r#9	12	0	NULL
t4_r#p0	10	1	NULL
t4_r#p1	10	0	NULL
t4_r#p2	10	1	NULL
insert into t1_h values(1,1),(4,1),(2,1),(5,1);
insert into t2_h values(1,1),(4,1),(2,1),(5,1);
select * from t1_h;
a	b
1	1
2	1
4	1
5	1
delete from t1_h where a=2;
delete from t1_h where a=4;
select * from t1_h;
a	b
1	1
5	1
select * from t2_h;
a	b
1	1
2	1
4	1
5	1
delete from t2_h where a=2;
delete from t2_h where a=4;
select * from t2_h;
a	b
1	1
5	1
truncate table t1_h;
insert into t1_h values(1,1),(4,1),(2,1),(5,1);
truncate table t2_h;
insert into t2_h values(1,1),(4,1),(2,1),(5,1);
select * from t1_h;
a	b
1	1
2	1
4	1
5	1
delete from t1_h where a=2;
delete from t1_h where a=4;
select * from t1_h;
a	b
1	1
5	1
alter table t1_h partition rule to (hh,h_25,a);
select * from t2_h;
a	b
1	1
2	1
4	1
5	1
delete from t2_h where a=2;
delete from t2_h where a=4;
select * from t2_h;
a	b
1	1
5	1
alter table t2_h partition rule to (,h_25,a);
show partition groups;
group_name	start_version	paxos_id	reserver_field1
ee#0	2	0	NULL
ee#1	2	1	NULL
hh#0	4	0	NULL
hh#1	4	1	NULL
hh#10	4	0	NULL
hh#11	4	1	NULL
hh#12	4	0	NULL
hh#2	4	0	NULL
hh#3	4	1	NULL
hh#4	4	0	NULL
hh#5	4	1	NULL
hh#6	4	0	NULL
hh#7	4	1	NULL
hh#8	4	0	NULL
hh#9	4	1	NULL
ll#p0	6	0	NULL
ll#p1	6	1	NULL
rr#0	2	0	NULL
rr#1	2	1	NULL
rr#2	2	0	NULL
rr#p0	10	0	NULL
rr#p1	10	1	NULL
rr#p2	10	0	NULL
t1_l#0	6	1	NULL
t1_l#1	6	0	NULL
t1_l#2	6	1	NULL
t2_e#0	2	0	NULL
t2_e#1	2	1	NULL
t2_e#10	4	1	NULL
t2_e#11	4	0	NULL
t2_e#12	4	1	NULL
t2_e#2	2	1	NULL
t2_e#3	4	0	NULL
t2_e#4	4	1	NULL
t2_e#5	4	0	NULL
t2_e#6	4	1	NULL
t2_e#7	4	0	NULL
t2_e#8	4	1	NULL
t2_e#9	4	0	NULL
t2_h#0	14	1	NULL
t2_h#1	14	0	NULL
t2_h#10	14	1	NULL
t2_h#11	14	0	NULL
t2_h#12	14	1	NULL
t2_h#2	14	1	NULL
t2_h#3	14	0	NULL
t2_h#4	14	1	NULL
t2_h#5	14	0	NULL
t2_h#6	14	1	NULL
t2_h#7	14	0	NULL
t2_h#8	14	1	NULL
t2_h#9	14	0	NULL
t2_l#0	8	1	NULL
t2_l#1	8	0	NULL
t2_l#10	8	1	NULL
t2_l#11	8	0	NULL
t2_l#12	8	1	NULL
t2_l#2	8	1	NULL
t2_l#3	8	0	NULL
t2_l#4	8	1	NULL
t2_l#5	8	0	NULL
t2_l#6	8	1	NULL
t2_l#7	8	0	NULL
t2_l#8	8	1	NULL
t2_l#9	8	0	NULL
t2_l#p0	6	0	NULL
t2_l#p1	6	1	NULL
t2_r#0	10	1	NULL
t2_r#1	10	0	NULL
t2_r#10	12	1	NULL
t2_r#11	12	0	NULL
t2_r#12	12	1	NULL
t2_r#2	10	1	NULL
t2_r#3	12	0	NULL
t2_r#4	12	1	NULL
t2_r#5	12	0	NULL
t2_r#6	12	1	NULL
t2_r#7	12	0	NULL
t2_r#8	12	1	NULL
t2_r#9	12	0	NULL
t4_r#0	10	1	NULL
t4_r#1	10	0	NULL
t4_r#10	12	1	NULL
t4_r#11	12	0	NULL
t4_r#12	12	1	NULL
t4_r#2	10	1	NULL
t4_r#3	12	0	NULL
t4_r#4	12	1	NULL
t4_r#5	12	0	NULL
t4_r#6	12	1	NULL
t4_r#7	12	0	NULL
t4_r#8	12	1	NULL
t4_r#9	12	0	NULL
t4_r#p0	10	1	NULL
t4_r#p1	10	0	NULL
t4_r#p2	10	1	NULL
major_freeze...
merge: DONE
show index on t1_h;
index_name	status	index_type
__3037__idx__il1	1	0
select * from t1_h;
a	b
1	1
5	1
insert into t1_h values(4,1),(2,1),(8,1);
replace into t1_h values(8,3);
update t1_h set b=5 where a=2;
select * from t1_h;
a	b
1	1
2	5
4	1
5	1
8	3
delete from t1_h where a=1;
delete from t1_h where a=5;
select * from t1_h;
a	b
2	5
4	1
8	3
show index on t2_h;
index_name	status	index_type
__3038__idx__il1	1	0
select * from t2_h;
a	b
1	1
5	1
insert into t2_h values(4,1),(2,1),(8,1);
replace into t2_h values(8,3);
update t2_h set b=5 where a=2;
select * from t2_h;
a	b
1	1
2	5
4	1
5	1
8	3
delete from t2_h where a=1;
delete from t2_h where a=5;
select * from t2_h;
a	b
2	5
4	1
8	3
truncate table t1_h;
select * from t1_h;
a	b
insert into t1_h values(4,1),(2,1),(8,1);
select * from t1_h;
a	b
2	1
4	1
8	1
truncate table t2_h;
select * from t2_h;
a	b
insert into t2_h values(4,1),(2,1),(8,1);
select * from t2_h;
a	b
2	1
4	1
8	1
major_freeze...
merge: DONE
show index on t1_h;
index_name	status	index_type
__3037__idx__il1	1	0
select * from t1_h;
a	b
2	1
4	1
8	1
show index on t2_h;
index_name	status	index_type
__3038__idx__il1	1	0
select * from t2_h;
a	b
2	1
4	1
8	1
drop table t1_h,t2_h;
