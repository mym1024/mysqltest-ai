drop table if exists t1,t2,t3,t11,t12;
drop partition function h1;
ERROR HY000: YAO-5077: partition function 'h1' doesn't exist
create hash partition function h1(x,y) 'x+y+1';
create TABLE t1 (a int, b int, c int, primary key(a,b)) partition by(ta1,h1,a,b);
Okay
INSERT INTO t1 VALUES(1,1,0);
INSERT INTO t1 VALUES(1,2,0);
INSERT INTO t1 VALUES(1,3,0);
DELETE from t1 where a=1 and b=1;
INSERT INTO t1 VALUES(1,1,0);
DELETE from t1 where a=1 and b=1;
DELETE from t1 where a=1 and b=2;
DELETE from t1 where a=1 and b=3;
INSERT INTO t1 VALUES(1,2,0);
DELETE from t1 where a=1 and b=2;
INSERT INTO t1 VALUES(1,2,0);
DELETE from t1 where a=1 and b=2;
drop table t1;
drop partition function h1;
create table t1 (
a bigint not null,
b bigint not null default 0,
c bigint not null default 0,
d bigint not null default 0,
e bigint not null default 0,
f bigint not null default 0,
g bigint not null default 0,
h bigint not null default 0,
i bigint not null default 0,
j bigint not null default 0,
primary key (a)) partition by range(a)(partition r1 values less than(10),partition r2 values less than(20),partition r3 values less than(30),partition r4 values less than maxvalue);
Okay
insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23);
delete from t1 where a=26;
drop table t1;
create table t1 (
a bigint not null,
b bigint not null default 0,
c bigint not null default 0,
d bigint not null default 0,
e bigint not null default 0,
f bigint not null default 0,
g bigint not null default 0,
h bigint not null default 0,
i bigint not null default 0,
j bigint not null default 0,
primary key (a)) partition by list(a)(partition a1 values in(2,4,6,8,10,12,14),partition a2 values in(16,18,20,22,24,26,23,27));
Okay
insert into t1 (a) values (2),(4),(6),(8),(10),(12),(14),(16),(18),(20),(22),(24),(26),(23),(27);
delete from t1 where a=27;
drop table t1;
drop partition function e1;
ERROR HY000: YAO-5077: partition function 'e1' doesn't exist
create enum partition function e1(x)'[(a)],[(b)],[(c)],[(d)]';
CREATE TABLE t1 (
bool1 char(0) default NULL,
not_null varchar(20) NOT NULL default '',
misc integer not null,
PRIMARY KEY (not_null)
) partition by(ta1,e1,not_null) ;
Okay
INSERT INTO t1 VALUES (NULL, 'a',4), (NULL, 'b',5), (NULL, 'c',6), (NULL, 'd',7);
select * from t1 where misc > 5 and bool1 is null;
bool1	not_null	misc
NULL	c	6
NULL	d	7
delete   from t1 where not_null='c';
delete   from t1 where not_null='d';
select * from t1 where misc > 5 and bool1 is null;
bool1	not_null	misc
select count(*) from t1;
count(*)
2
select count(*) from t1;
count(*)
2
select count(*) from t1;
count(*)
2
drop table t1;
drop partition function e1;
Okay
