drop table if exists tl,t2,t3,t4 purge;
-- close trash
set global trash_bin_switch = false;
drop no table database
create database test1;
drop database test1;
show databases;
Database
test
trash
yao
select drop_name,object_name,type from __all_trash;
drop_name	object_name	type
use purge drop no table database
create database test1;
drop database test1 purge;
select drop_name,object_name,type from __all_trash;
drop_name	object_name	type
show databases;
Database
test
trash
yao
open trash
set global trash_bin_switch = true;
drop no table database
create database test1;
drop database test1;
show databases;
Database
test
trash
yao
select drop_name,object_name,type from __all_trash;
drop_name	object_name	type
__trash_test1_5	test1	1
purge recyclebin;
drop has table database
create database test1;
using database test1;
create table t1(cl int primary key,c2 int);
insert into t1 values(1,1);
drop database test1;
show databases;
Database
test
trash
yao
select drop_name,object_name,type from __all_trash;
drop_name	object_name	type
__trash_test1_6	test1	1
flashback database __trash_test1_6 to before drop;
show recyclebin;
drop_name	drop_time	object_name	type
using database test1;
show tables;
table_name_in_test1
t1
drop table if exists t1 purge;
show recyclebin;
drop_name	drop_time	object_name	type
drop database test1 purge;
use purge drop no table database
create database test1;
drop database test1 purge;
show databases;
Database
test
trash
yao
select drop_name,object_name,type from __all_trash;
drop_name	object_name	type
purge recyclebin;
-- close trash
set global trash_bin_switch = false;
drop database "trash";
ERROR HY000: YAO--1: default database 'TRASH' can not be droped!
drop database test100;
ERROR HY000: YAO-5602: Database not exist
-- open trash
set global trash_bin_switch = true;
drop database "trash" purge;
ERROR HY000: YAO--1: default database 'TRASH' can not be droped!
create database test1;
using database test1;
create table t1(c1 int,c2 int primary key);
drop table t1;
select drop_name,object_name,type from __all_trash;
drop_name	object_name	type
t1_3002	t1	2
show tables;
table_name_in_test1
drop database test1 purge;
ERROR HY000: YAO-5095: Still has table in trash
flashback t1 to before drop;
show recyclebin;
drop_name	drop_time	object_name	type
show tables;
table_name_in_test1
t1
drop table if exists t1 purge;
drop database test1 purge;
show recyclebin;
drop_name	drop_time	object_name	type
purge recyclebin;
drop database test100 purge;
ERROR HY000: YAO-5602: Database not exist
create database test1;
create database test2;
create user 'u1' identified by 'pass-12345';
grant drop on * to 'u1';
drop database test1 purge;
revoke drop on * from 'u1';
drop database test2 purge;
ERROR HY000: YAO-5036: no privilege
drop database test2 purge;
drop user 'u1';
create database __trash_a;
ERROR HY000: YAO-5036: invalid db name to create, db_name=__trash_a
create database testtt;
using database testtt;
create table
t_255_1_10_asdsad_20_asdsad_30_asdsad_40_asdsad_50_asdsad_60_asdsad_70_asdsad_80_asdsad_90_asdsa_100_asdsa_110_asdsa_120_asdsa_130_asdsa_140_asdsa_150asdsa_160_asdsa_170_asdsa_180_asdsa_190_asdsa_200_asdsa_210_asdsa_220_asdsa_230_asdsa_240_asdsa_250_s255(id int primary key,c2 varchar(10),c3 decimal(10));
drop database testtt;
ERROR HY000: YAO-5108: drop table name or index name is too long in open trash
