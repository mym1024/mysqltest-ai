drop table if exists t1;
create table t1 (c1 int primary key,c2 int);
insert into t1 values(1,1);
select * from t1;
c1	c2
1	1
'conn1'
start transaction;
update t1 set c2 = 10 where c1 = 1;
select * from t1;
c1	c2
1	10
'conn2'
truncate table t1;
'conn1'
commit;
ERROR HY000: YAO-155: table is locked
select * from t1;
c1	c2
insert into t1 values(2,2);
'conn1'
start transaction;
delete from t1 where c1 = 2;
select * from t1;
c1	c2
'conn2'
truncate table t1;
'conn1'
commit;
ERROR HY000: YAO-155: table is locked
select * from t1;
c1	c2
'conn1'
set autocommit = 0;
insert into t1 values(2,2);
select * from t1;
c1	c2
2	2
'conn2'
truncate table t1;
'conn1'
commit;
ERROR HY000: YAO-155: table is locked
select * from t1;
c1	c2
'conn1'
replace into t1 values(1,2);
select * from t1;
c1	c2
1	2
'conn2'
truncate table t1;
'conn1'
commit;
ERROR HY000: YAO-155: table is locked
select * from t1;
c1	c2
drop table t1;
