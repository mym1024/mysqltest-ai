##############################################################################################
###1.测试功能点：在range分区规则下，进行读写操作
##
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：xxx
###6.编写/修改人：zhuyinying
###7.编写/修改日期：2019-12-23
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################

--disable_warnings
drop table if exists t1,t2;
--enable_warnings

###2-1:读写bigint类型的数据
create table t1(pk bigint,a bigint,primary key(pk)) partition by range(pk) (partition ta1 values less than (2),partition ta2 values less than(5),partition ta3 values less than maxvalue);
--real_sleep 3
insert into t1 values(1,18446744073709551615),(2,18446744073709551613),(3,18446744073709551612);
--real_sleep 5
select * from t1;
select * from t1 where a=18446744073709551615;
select * from t1 where a=18446744073709551613;
select * from t1 where a='18446744073709551615';
select * from t1;
drop table t1;

create table t1(a bigint primary key,big bigint) partition by list(a) (partition a1 values in (1,3),partition a2 values in (2,4,5));
--real_sleep 1
insert into t1(a,big) values(1,-1),(2,12345678901234567),(3,9223372036854775807),(4,18446744073709551615);
--real_sleep 5
select * from t1;
select min(big),max(big),max(big)-1 from t1;
select min(big),max(big),max(big)-1 from t1 group by a;
--real_sleep 1
insert into t1(a,big) values(5,18446744073709551635);
select * from t1;
select min(big),max(big),max(big)-1 from t1;
select min(big),max(big),max(big)-1 from t1 group by a;
drop table t1;

create table t1(pk bigint primary key,f double) partition by range(pk) (partition b1 values less than (2),partition b2 values less than (5),partition b3 values less than maxvalue);
--real_sleep 5
insert into t1 values(1,10000000000000000000);
--real_sleep 5
insert into t1 values(2,10000000000000000000.0);
insert into t1 values(3,'10000000000000000000');
--real_sleep 5
select * from t1;
drop table t1;

--error 5077
drop partition function h1;
create hash partition function h1(x,y)'x+y-3';
create table t1 (
value64 bigint,
value32 bigint,
extra bigint,
primary key(value64,value32)
)partition by(ta1,h1,value64,value32);

--error 5077
drop partition function h2;
create hash partition function h2(x,y)'y-x';
create table t2 (
value64 bigint,
value32 bigint,
extra bigint,
primary key(value64,value32)
)partition by(ta2,h2,value64,value32);

--real_sleep 3
insert into t1(value64,value32) values(17156792991891826145,1);
insert into t1(value64,value32) values(9223372036854775807,2);
--real_sleep 5
insert into t2(value64,value32) values(17156792991891826145,3);
insert into t2(value64,value32) values(9223372036854775807,4);
--real_sleep 5
select * from t1;
select * from t2;
drop table t1,t2;
drop partition function h1,h2;
--error 5077
drop partition function h3;
--real_sleep 5
create hash partition function h3(x)'x+4';
create table t1 (sint64 bigint primary key,a bigint)partition by(ta3,h3,sint64);
--real_sleep 3
insert into t1(sint64) values (-9223372036854775808);
select * from t1;
drop table t1;
drop partition function h3;

--error 5077
drop partition function h4;
create hash partition function h4(x)'x%10';
create table t1 (a char(100) primary key,b varchar(100),c varchar(256),d varchar(256))partition by(ta5,h4,a);
--real_sleep 3
insert into t1 values(
18446744073709551615,18446744073709551615,
18446744073709551615,18446744073709551615
);
--real_sleep 5
select * from t1;
drop table t1;
drop partition function h4;

create table t1 (quantity int primary key,extra bigint) partition by list(quantity)(partition a1 values in (-1,-500),partition a2 values in(0,500));
--real_sleep 3
insert into t1(quantity) values (500),(-500),(0),(-1);
--real_sleep 5
select * from t1;
drop table t1;


###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
