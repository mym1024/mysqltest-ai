####################################必填######################################################
###1.测试功能点：测试系统函数_数学函数round、div、uuid、ceiling、pi、mod、abs、log10、方差VARIANCE、标准差STDDEV、协方差COVAR
#                 
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：
###4.问题号：
###5.预计运行时间：
###6.编写/修改人：
###7.编写/修改日期：
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################
set character_set_results='utf8mb4';
set character_set_connection='utf8mb4';
set character_set_client='utf8mb4';
###2-1：测试round函数支持单参数
create table t1(c1 int,c2 varchar(10),c3 decimal(5,2));
insert into t1 (c1, c2, c3) values (1, 'aaa', 10.55),(2, 'bbb', 15.44),(3, 'ccc', 9.99);

##无小数位数
select round(10.6);
select round(10.4);
select round(-10.6);
select round(-10.4);
select round(0);

##指定小数位数
select round(10.678, 2);
select round(10.674, 2);
select round(-10.678, 2);
select round(-10.674, 2);
select round(0, 2);
select round(10.678, -2);
select round(10.674, -2);
select round(-10.678, -2);
select round(-10.674, -2);
select round(0, -2);
select round(10.678, 5);
select round(10.674, 5);
select round(-10.678, 5);
select round(-10.674, 5);
select round(0, 5);
select round(12345, -5);
select round(12345, -1);
select round(-12345, -5);
select round(-12345, -1);
select round(0, -5);
##使用在表中
select c2, round(c3) as rounded_c3 from t1;
update t1 SET c3 = round(c3, 2);
delete from t1 where c3 < 10;
select count(*), round(sum(c3)) from t1;
select c2, round(c3 + 5.99, 2) from t1;
select c2, round(c3 * c1) from t1 where c1 > 0;
select round(avg(c3), 2) from t1;
drop table t1;

###2-2：测试div系统函数
create table t1(c1 int,c2 float,c3 double,c4 decimal(10,5));
insert into t1 values(1,2.5,3.5,4.5),(2,5.5,6.5,7.5),(3,10.5,12.5,22.5),(0,0,0,0);

##分子和分母都为整数
select 2 div 2;
select 5 div 2;
select 5 div 10;
select 5 div -10;
select 5 div -2;
select 5 div -3;
select -10 div 4;
select -10 div 3;
select -10 div -10;
select -10 div -100;
select -10 div 0;

##分子为整数
select  2 div 2.2 ;
select 5 div 2.5;
select 5 div -1.0;
--error 5001
select 1 div;

##分母为整数
select 5.5 div 4;
select 2.5 div 4;
select -8.0 div 4;

##分子和分母都不为整数
select -8.0 div 8.0;
select -8.0 div 19.0;
select 8.0 div 5.0;

##四则运算
select (1+2+3) div (2+1);
select (1+2+3) div (2+1+0.5);
select (2*5.2) div (2+1+0.5);
select (2*5.2) div (2+1-0.5*6);

##从表中查询
select c1 div 2 from t1;
select c1 div -0.5 from t1;
select c2 div 2 from t1;
select c2 div -2.2 from t1;
select c3 div -2.2 from t1;
select c3 div 1.5 from t1;
select (c3+1.5) div 2 from t1;
select (c4+11) div 2 from t1;
select (c4+11) div -3 from t1;
select (c4+11) div (c1-1) from t1;
select (c4+2.6) div (c1-1) from t1;
#视图
create view v1(a) as select (c4+2.6) div (c1-1) from t1;select * from v1;
##数据类型为字符串
select '10' div 2;
select '-10' div 2;
select '10+2+2.5+10' div 4;
select 10  div '2.5';
select 10  div '2.5+1';
select '10+2.5' div 5.5;
select '+10+2.5' div 5.5;
select '   -10+2.5  ' div 5.5;
select '   20+2.5  ' div 5.5;
select '   20+2.5  ' div '5+0.5';
select '   20+2.5  ' div c4 from t1;
select '   20+2.5  ' div c3 from t1;
select '    ' div c3 from t1;
select '6.123' div '2a.swjdifjwi';
select 'asjijds.wdi' div '2.2adadw';
select ' abc ' div c3 from t1;
select ('10'+'0') div 10;
select ('10'+'0'+'2') div 2;
select ('10'+'a'+'b') div 2;
##嵌套系统函数、关键字
select left('10.5',3) div 5;
select left('10.5',3) div right('5.20',2);
select (11 mod 3 ) div 2;
select (1 and 1) div 1;
#语句中使用
insert into t1 values(100 div 20,20 div 20,30 div 15,40 div 2);
select * from t1 where c1 = (20 div 20);
delete from t1 where c1 = (6 div 2 );
drop table t1;

###2-3：测试uuid函数
create table test1(id int,c1 varchar(36));
create table test2(id int,c1 varchar(35));
insert into test1 values(1,'uuid');
insert into test2 values(1,'uuid');

##参数个数不同
--replace_column 1 'ef6b39a3-8764-11ee-841b-f02f74977060'
select uuid();
#select uuid(),uuid(),uuid()\G
--error 5054
select uuid('');
--error 5054
select uuid(null);
--error 5054
select uuid('expr1',2+3*null);
--error 5054
select uuid(4+3-7);
##函数位置不同
update test1 set c1=uuid() where id=1;
update test1 set id=10 where c1=uuid();
select * from test1 group by c1 having c1=uuid();
select id from test1 where c1=uuid() order by c1;
insert into test1(id,c1) values(2,uuid());
insert into test1(id,c1) values(3,uuid()),(4,uuid());
--replace_column 2 'ef6c32d7-8764-11ee-841b-f02f74977060'
select * from test1 order by uuid();
--error 5611
insert into test2(id,c1) values(2,uuid());
delete from test1 where c1=uuid();
#集合
(select c1 from test1 where c1=uuid()) union (select c1 from test2 where c1=uuid());
select * from test1 where c1=uuid() intersect select * from test1 where c1=uuid();
--replace_column 2 'ef6c32d7-8764-11ee-841b-f02f74977060'
select * from test1 where id=1 except (select * from test1 where c1=uuid());
#其它函数
--replace_column 1 '-8764-11ee-841b-f02f74977060'
select substr(uuid(),9) from test1;
--replace_column 1 'efa60538-8764-11ee-841b-f02f74977060base'
select concat(uuid(),'base');
--replace_column 1 'efa62121-8764-11ee-841b-f02f74977060;yao'
select concat_ws(';',uuid(),'yao');
--replace_column 1 'EFA63A04-8764-11EE-841B-F02F74977060'
select upper(uuid());

drop table if exists test1,test2;

###2-4：测试ceiling函数
##参数不同
select ceiling(3.85);
--error 5054
select ceiling();
--error 2
select ceiling('');
select ceiling(NULL);
#--error 153
select ceiling('工');
select ceiling(678);
#--error 153
select ceiling('abc');
select ceiling('9.6');
 select ceiling(true);
select ceiling(false);
#--error 153
select ceiling('1998-09-03 00:00:00') res;
select ceiling(cast(1.23 as float)) res;
select ceiling(cast(1.23 as double)) res;
select ceiling(1e3);
##函数位置不同
create table student(id int,name varchar(25),age int,sex varchar(5));
insert into student values(1,'aaa',22,'男'),(2,'bbb',20,'男'),(3,'ccc',27,'女'),(4,'ddd',25,'女');
create table teacher(id int,name varchar(25),age int);
insert into teacher values(1,'Tom',22),(2,'Jack',20),(3,'Mary',27);
update student set name = 'Jack' where id = ceiling(3.45);
update student set age = ceiling(20.3) where id = 1;
select * from student;
select * from student where id > ceiling(3.0) order by age;
insert into student values(5,'测试',ceiling(18.3),'男'); 
delete from student where id=ceiling(1.0); 
select * from student;
(select name from student where age=ceiling(19.5)) union (select name from student where id=2);
(select name from student where age=ceiling(26.7)) intersect (select name from student where age>=20);
(select name from student where age>=19) except (select name from student where age=ceiling('26.7'));
select ceiling(ceiling(-5.6));
select ceiling(replace('bc45','bc','23')) res;
select s.name,t.name from student s,teacher t where t.id=ceiling('1.5') and s.id=ceiling(3.2); 
##运算
select ceiling(1<2) res;
select ceiling(1>=2) res;
select ceiling(1!=2) res;
select ceiling(1=1) res;
select ceiling(1+1.7) res;
select ceiling(9.0/2) res;
select ceiling(id-1) from student;
select ceiling(id*2) from student;
select ceiling(id%10) from student;
select ceiling(sum(id)) from student;
select ceiling(min(id)) from student;
select ceiling(id<=2) from student;
select ceiling(id!=2) from student;
select ceiling(id<>2) from student;
select ceiling(1=2) from student;
##表操作添加
insert into teacher values(4,'Tom',ceiling(28-1));
#--error 153
insert into teacher values(5,'test1',ceiling('1998-09-03 00:00:00'));
insert into teacher values(6,'test2',ceiling(2+1.6));
insert into teacher values(7,'Bob',ceiling(23.3));
insert into teacher values(8,substr('abcdTom',ceiling(4.1)),22);
select ceiling((select age from student where id =1));
select ceiling((select name from student where id =1));
select ceiling(age) from student;
##数据类型不同
select ceiling(id) from student;
#--error 153
select ceiling(name) from student;
select ceiling(cast(id as float))  from student;
select ceiling(cast(id as double)) from student;
##列参数不同
select ceiling(id) from student;
select ceiling(id) from student;
select ceiling(student.id) from student, teacher;

###2-5：测试PI函数
create table test(name varchar(25),num double);
insert into test values('jack',pi()),('bbb',1),('ccc',6);
create table multi(name varchar(25),num double);
insert into multi values('jack',pi()),('bbb',1),('ccc',6);
select pi();
--error 5054
select pi(1);
select pi()+0.0000000;
select pi()+0.000000;
select pi()+0.00000000000000000;
SELECT ROUND(2*PI(),2);
update test set name='abcd' where num=pi();
update test set num=pi() where name='abcd';
select * from test having num = pi();
select * from test where num > pi() order by num;
insert into test values('aaa', pi()); 
delete from test where num=pi(); 
(select name from test where num=pi()) union (select name from test where num=2);
(select name from test where num=pi()) intersect (select name from test where num=3);
(select name from test where num>=pi()) except (select name from test where num=pi());
select ceil(pi());
select name from test where num between pi() and 5;
select s.name,t.name from test s,multi t where t.num=pi() and s.num>=pi(); 

###2-6：测试mod函数
SELECT MOD(10, 3);
SELECT MOD(-10, 3);
SELECT MOD(0, 3);
SELECT MOD(10.5, 3.2);
SELECT MOD(10, -3);
SELECT MOD(-10, -3);
SELECT MOD(1234567890123456789, 1234);
SELECT MOD(5, 8);
SELECT MOD(10, 1234567890123456789);
SELECT -9223372036854775808 MOD -1;
SELECT -9223372036854775808999 MOD -1;
SELECT -9223372036854775808 MOD -1;
CREATE TABLE test_table (id INT PRIMARY KEY,value INT);
INSERT INTO test_table (id, value) VALUES (1, 10), (2, 20), (3, 30), (4, 40);
SELECT * FROM test_table WHERE MOD(value, 3) = 0;
UPDATE test_table SET value = MOD(value, 5) WHERE id = 2;
DELETE FROM test_table WHERE id = 4 AND MOD(value, 10) = 4;
SELECT * FROM test_table WHERE MOD(ABS(value), 5) = 0;
SELECT * FROM test_table WHERE MOD(CONCAT(id, value), 10) = 3;

###2-7：测试abs函数
create table test1(c1_int int primary key,c2_varchar varchar(40),c3_float float,c4_double double,c5_bool bool,c6_timestamp timestamp,c7_datetime datetime,c8_date date,c9_time time,c10_decimal decimal(38,37));
insert into test1 values(1001,'123456789',123.456,1234567.123456, true,'2022-12-30 22:34:39','2022-12-30 22:34:39','2022-12-30','22:34:39',0.12345678910111213141516171819);
insert into test1 values(-1001,'-123456789',-123.456,-1234567.123456,false,'2021-12-30 22:34:39','2021-12-30 22:34:39', '2021-12-30','21:34:39',-0.12345678910111213141516171819);
insert into test1 values(-1002,NULL,-123.457,-12345678.123456, false,'2022-12-30 02:34:39','2022-12-03 22:34:39','2022-01-30','22:04:39',-1.12345678910111213141516171819);
insert into test1 values(1002,'-123456789.123456',123.457, 12345678.123456,true,'2022-12-30 02:34:39','2022-12-03 22:34:39', '2022-01-30','22:04:39',1.12345678910111213141516171819);
select abs(null);
--error 5054
select abs();
--error 5054
select abs(1,2);
select abs(0);
select abs(111);
select abs(-999);
--error 16
select abs('');
--error 16
select abs('abc');
select abs('-123456');
--error 16
select abs(true);
--error 16
select abs(to_timestamp('2022-12-30 22:34:39','yyyy-mm-dd hh:mm:ss'));
select abs(0.12345678910111213141516171819);
select abs(-0.12345678910111213141516171819);
select abs(1.2345e3);
select abs(-1.2345e-2);
select abs(9223372036854775807);
select abs(-9223372036854775807);
select abs(0.9999999999999999999999999999999999999);
#--error 58
select abs(0.99999999999999999999999999999999999991);
select abs(3+4);
select abs(-3*null);
select abs(-3/4.0);
select abs(null/4.0);
#--error 78
select abs(-3/0);
select abs(34 mod(5));
select abs(null mod(5));
select abs(34%5);
select abs(null%5);
select abs(-((3+4.123-'1000.1')*'-1000.1'/(5%2)-123456.123456+1.123456789101112));
select abs(-((123+123.123-'456.123')*'-1000.123'/(456%5.0)+123456.123456*1.123456789101112));
--error 16
select abs(1<=1);
--error 16
select abs(1!=1);
--error 16
select abs(1<>1);
update test1 set c3_float=123.458 where c1_int=abs(-1001);
update test1 set c3_float=abs(-123.456) where c2_varchar='123456789';
select c1_int,c2_varchar,c3_float from test1 where c1_int=abs(-1001);
select c1_int,c2_varchar,c3_float from test1 having c1_int < abs(-1002);
select abs(c1_int),c2_varchar,c3_float from test1 order by c1_int desc;
insert into test1 values(1003,'12345678910',abs(-123.4567),abs(-1234567.12345678),true,NULL,NULL,NULL,NULL,NULL);
delete from test1 where c1_int=abs(-1003);
delete from test1 where c2_varchar=abs('12345678910');
(select c1_int,abs(c1_int),c2_varchar from test1 where c1_int=1001) union (select c1_int,abs(c1_int),c2_varchar from test1 where c1_int=-1001);
(select c1_int,abs(c1_int),c2_varchar from test1 where c2_varchar='123456789') union (select c1_int,abs(c1_int),c2_varchar from test1 where c2_varchar='-123456789');
(select abs(c1_int),abs(c2_varchar) from test1 where c2_varchar='123456789') intersect (select abs(c1_int),abs(c2_varchar) from test1 where c2_varchar='-123456789');
(select c1_int,abs(c1_int),c2_varchar from test1 where c1_int<1001) except (select c1_int,abs(c1_int),c2_varchar from test1 where c1_int=-1001);
select c1_int,c2_varchar,c3_float from test1 where c1_int between abs(-1000) and abs(-2000);
select c1_int,c2_varchar,c3_float from test1 where c3_float between abs(-100.456) and abs(-200.456);
select abs(abs(abs(-123456.123456)));
select length('yaobase_test'),abs(length('yaobase_test'));
select round(-1234.567,1),abs(-round(1234.567,1));
select abs(-123456.7891011),ceil(abs(-123456.7891011));
select floor(-1234.567),abs(floor(-1234.567));
select abs(-123456.7891011),floor(abs(-123456.7891011));
select c3_float,abs(c3_float) from test1;
select c4_double,abs(c4_double) from test1;
--error 16
select c5_bool,abs(c5_bool) from test1;
--error 16
select c6_timestamp,abs(c6_timestamp) from test1;
select c10_decimal,abs(c10_decimal) from test1;
select abs(c1_int),abs(c3_float),abs(c4_double),abs(c10_decimal) from test1;
select c4_double mod(c1_int),abs(c4_double mod(c1_int)) from test1;
select abs(c10_decimal+(c1_int*(c1_int-c4_double)+c3_float/c1_int)*(c4_double%c1_int)) abs from test1;
select abs(c10_decimal-(c1_int*(c2_varchar-c4_double)+c3_float/c1_int)+(c4_double%c1_int)) abs from test1;
select c1_int,c2_varchar,abs(max(c1_int)),abs(min(c4_double)),abs(sum(c3_float)),abs(avg(c1_int)),abs(count(c2_varchar)) from test1 group by c1_int,c2_varchar;
select c2_varchar from test1 where c1_int in (select abs(c1_int) from test1);
select t1.c1_int,t2.c1_int,abs(t1.c2_varchar) from test1 as t1,test1 as t2 where t1.c1_int<t2.c1_int;
select abs(t1.c1_int),t1.c2_varchar,t2.c2_varchar from test1 as t1,test1 as t2 where t1.c2_varchar<t2.c2_varchar;
select t1.c1_int,t2.c1_int,abs(t1.c2_varchar) from test1 as t1 join test1 as t2 on t1.c1_int<abs(t2.c1_int);
select abs(t1.c1_int),t1.c2_varchar,t2.c2_varchar from test1 as t1 join test1 as t2 on t1.c2_varchar<abs(t2.c2_varchar);

###2-8：测试log10函数
drop table test1;
create table test1(c1_int int,c2_varchar varchar(40),c3_float float,c4_double double,c5_bool bool,c6_timestamp timestamp,c7_datetime datetime,c8_date date,c9_time time,c10_decimal decimal(38,37));
insert into test1 values(1,'2',3.33,4.4444, true,'2022-12-30 22:34:39','2022-12-30 22:34:39','2022-12-30','22:34:39',5.12345678910111213141516171819);
insert into test1 values(-1,'-2',-3.33,-4.4444,false,'2021-12-30 22:34:39','2021-12-30 22:34:39', '2021-12-30','21:34:39',-5.12345678910111213141516171819);
insert into test1 values(1,'4',4.44,6.6666, true,'2023-12-30 22:34:39','2023-12-30 22:34:39','2023-12-30','22:34:39',6.12345678910111213141516171819);
insert into test1 values(-1,'3',5.55,7.7777,false,'2024-12-30 22:34:39','2024-12-30 22:34:39', '2024-12-30','21:34:39',7.12345678910111213141516171819);
select log10(null);
--error 5054
select log10();
--error 5054
select log10(1,2);
select log10(0),log10(-1),log10(1),log10(111),log10(-999);
select log10('');
select log10('abc');
select log10('-123456.123456');
select log10(123.4567);
select log10(true);
select log10(false);
select log10(to_timestamp('2022-12-30 22:34:39','yyyy-mm-dd hh:mm:ss'));
select log10(to_date('2022-12-30','yyyy-mm-dd'));
select log10(1.2345e3);
select log10(-1.2345e-2);
select log10(9223372036854775808);
select log10(-9223372036854775807);
select log10(0.9999999999999999999999999999999999999);
#--error 58
select log10(0.99999999999999999999999999999999999991);
select log10(3+4),log10(3-4),log10(-3*4),log10(-3/4.0);
select log10(-3*null),log10(null/4.0),log10(3-null),log10(3+null);
#--error 78
select log10(-3/0);
select log10(34 mod(5)),log10(null mod(5)),log10(null%5);
select log10(((123+123.123+'456.123')*'1000.123'/(456%5.0)+123456.123456*1.123456789101112));
select log10(1=1),log10(1<1),log10(1>=1),log10(1!=1),log10(1<>1);
update test1 set c3_float=8.88 where c2_varchar=log10('100');
update test1 set c3_float=log10(7777.888888) where c1_int=1;
update test1 set c3_float=log10(1) where c2_varchar='-2';
select c1_int,c2_varchar,c3_float from test1 where c2_varchar=log10(100);
select c1_int,c2_varchar,c3_float from test1 having c1_int < log10(1000);
select log10(c1_int),c2_varchar,c3_float from test1 order by c1_int;
insert into test1 values(2,'-2',log10(100),log10(1000),true,NULL,NULL,NULL,NULL,NULL);
delete from test1 where c1_int=log10(10);
delete from test1 where c2_varchar=log10(100);
insert into test1 values(1,'4',4.44,6.6666, true,'2023-12-30 22:34:39','2023-12-30 22:34:39','2023-12-30','22:34:39',6.12345678910111213141516171819);
(select c1_int,log10(c1_int),c2_varchar from test1 where c2_varchar='2') union (select c1_int,log10(c1_int),c2_varchar from test1 where c2_varchar='-2');
(select log10(c1_int),log10(c2_varchar) from test1 where c1_int=1) intersect (select log10(c1_int),log10(c2_varchar) from test1);
(select c1_int,log10(c1_int),c2_varchar from test1 where c1_int<1001) except (select c1_int,log10(c1_int),c2_varchar from test1 where c2_varchar='2');
select c1_int,c2_varchar,c3_float from test1 where c1_int between log10(1) and log10(10000);
select c1_int,c2_varchar,c3_float from test1 where c3_float between log10(0.0000001) and log10(10000000);
select length('yaobase_test'),log10(length('yaobase_test'));
select round(1234.567,1),log10(round(1234.567,1));
select log10(123456.7891011),round(log10(123456.7891011),2);
select ceil(9999.5555555555),log10(ceil(9999.5555555555));
select log10(9999.9999),ceil(log10(9999.9999));
select floor(10.1),log10(floor(10.1)),log10(10),floor(log10(10)),log10(log10(log10(0.1))),log10(log10(100));
select c2_varchar,log10(c2_varchar) from test1;
select c5_bool,log10(c5_bool) from test1;
select c6_timestamp,log10(c6_timestamp) from test1;
select c7_datetime,log10(c7_datetime) from test1;
select c8_date,log10(c8_date) from test1;
select c9_time,log10(c9_time) from test1;
select log10(c1_int),log10(c3_float),log10(c4_double),log10(c10_decimal) from test1;
select c2_varchar mod(c1_int),log10(c2_varchar mod(c1_int)) from test1;
select log10(c10_decimal+(c1_int*(c1_int-c4_double)+c2_varchar/c1_int)*(c2_varchar%c1_int)) log10 from test1;
select log10(c10_decimal-(c1_int*(c2_varchar-c4_double)+c3_float/c1_int)+(c2_varchar%c1_int)) log10 from test1;
select c1_int,c2_varchar,log10(max(c1_int)),log10(min(c4_double)),log10(sum(c3_float)),log10(avg(c1_int)),log10(count(c2_varchar)) from test1 group by c1_int,c2_varchar;
select c2_varchar from test1 where c1_int in (select log10(100) from test1);
select c1_int from test1 where c2_varchar in (select log10(100) from test1);
select t1.c1_int,t2.c1_int,log10(t1.c2_varchar) from test1 as t1,test1 as t2 where t1.c1_int<t2.c1_int;
select log10(t1.c1_int),t1.c2_varchar,t2.c2_varchar from test1 as t1,test1 as t2 where t1.c2_varchar<t2.c2_varchar;
select t1.c1_int,t2.c1_int,log10(t1.c2_varchar) from test1 as t1 join test1 as t2 on t1.c1_int<log10(t2.c1_int);
select log10(t1.c1_int),t1.c2_varchar,t2.c2_varchar from test1 as t1 join test1 as t2 on t1.c2_varchar<log10(t2.c2_varchar);

###2-9：方差variance/var
drop table if exists test,test1,test2;
create table test(id int primary key,score int,weight float,name varchar(1));
create table test1(id int primary key,grade double,date_ date,time_ time,datetime_ datetime,hight decimal(7,2));
create table test2(id int primary key,score int);  
CREATE TABLE sales (product_id INT,sale_amount DECIMAL(10,2));
CREATE TABLE variance_results (product_id INT,expected_variance DECIMAL(10,2));
insert into test values (1,12,54.2,'a'),(2,13,44.2,'a'),(3,34,56.2,'b'),(4,89,67.1,'c'),(5,59,40.1,'c'),(6,45,78.8,'d');                                 
insert into test1 values (1,1.23,'2019-03-15','18:23:41','2019-03-15 18:23:41',54.21),(2,13.1,'2019-12-21','23:12:21','2019-12-21  23:12:21',44.29),(3,34.009,'2019-11-28','10:45:23','2019-11-28 10:45:23',56.20),(4,89.7,'2019-01-12','13:23:34','2019-01-12 13:23:34',67.18),(5,59.7,'2017-09-16','21:23:54','2017-09-16 21:23:54',40.1);                                                                                                       
insert into test2 values (1,null),(2,34),(3,66),(4,88),(5,99),(6,null);
INSERT INTO sales (product_id, sale_amount) VALUES(1, 100.00),(1, 150.00),(1, 200.00),(2, 90.00),(2, 120.00),(2, 140.00);
INSERT INTO variance_results (product_id, expected_variance) VALUES(1, 1666.67),(2, 1120.00); 

--error 5001
select variance(score, weight) from test;
select 1 + variance(score+2) + 1 from test;
select 2 * variance(score*3) * 4 from test;
select 2 * variance(score*3) / 4 from test;
select 20 - variance(score-3) - 4 from test;
select variance(score) from test2;
select var(score) from test;
select var(weight) from test;
select var(score + weight) from test;
select var(score * weight) from test;
select var(score - weight) from test;
select var(score / weight) from test;
select var(score+weight*12+length(name)) from test;
select var(score*2) from test;
select var(score*4-10) from test;
select var(score),avg(score),sum(score),min(score),max(score) from test;
select var(score) from test group by name;
select var(weight) from test group by name;
select var(10) from test;
insert into test values (7,2147483647,3.4e38,'a');
select var(score) from test;
select var(weight) from test;
insert into test values (8,-2147483648,1.1754e-38,'b');               
select var(weight) from test;
select var(grade) from test1;
select var(hight) from test1;
select var(grade+5) from test1;
select var(hight*2) from test1;
select var(grade+hight) from test1;
select var(grade*hight) from test1;
select var(grade/hight) from test1;
select var(year(date_)) from test1;
select var(month(date_)) from test1;
select var(day(date_)) from test1;
insert into test values (9,NULL,89.9,'l');
select var(score) from test;
delete from test2;
select var(score) from test2;
--error 2
select var(date_) from test1;
--error 2
select var(time_) from test1;
--error 2
select var(datetime_) from test1;
select variance(distinct score) from test;
SELECT name,score FROM test WHERE score<(SELECT variance(score) FROM test);
SELECT name FROM test GROUP BY name HAVING variance(score)>=1;
SELECT name,score FROM test WHERE score in (SELECT variance(score) FROM test);
SELECT name,score FROM test WHERE exists (SELECT variance(score) FROM test where id = 1);
select a.product_id,a.expected_variance,b.v from variance_results as a join (select product_id,variance(sale_amount) as v from sales group by product_id) b on a.product_id = b.product_id where abs(a.expected_variance - b.v) < 0.1;
select product_id as id,expected_variance,(select variance(sale_amount) as v from sales group by product_id having product_id = 1 order by product_id) as Ev from variance_results where product_id = 1;
drop view v1;
create view v1 as select variance(score) from test;
desc v1;
select * from v1;
PREPARE stmt1 FROM 'select variance(?) from test';
set @a=2;
execute stmt1 using @a;

###2-10：标准差STDDEV
select stddev(score) from test;
select stddev(weight) from test;
select stddev(score + weight) from test;
select stddev(score * weight) from test;
select stddev(score - weight) from test;
select stddev(score / weight) from test;
select stddev(score + weight * 12+length(name)) from test;
select stddev(score * 2) from test;
select stddev(score * 4 - 10) from test;
insert into test2 values (1,null),(2,34),(3,66),(4,88),(5,99),(6,null);
--real_sleep 3
select stddev(score) from test2;
select stddev(score) from test group by name;
select stddev(weight) from test group by name;
select stddev(10) from test;
select stddev(score) from test;
select stddev(weight) from test;
select stddev(grade) from test1;
select stddev(hight) from test1;
select stddev(grade + 5) from test1;
select stddev(hight * 2) from test1;
select stddev(grade + hight) from test1;
select stddev(grade * hight) from test1;
select stddev(grade / hight) from test1;
select stddev(year(date_)) from test1;
select stddev(month(date_)) from test1;
select stddev(day(date_)) from test1;
select stddev(score) from test;
delete from test2;
--real_sleep 5
select stddev(score) from test2;
--error 2
select stddev(date_) from test1;
--error 2
select stddev(time_) from test1;
--error 2
select stddev(datetime_) from test1;
select stddev(distinct score) from test;
SELECT name,score FROM test WHERE score<(SELECT stddev(score) FROM test);
SELECT name FROM test GROUP BY name HAVING stddev(score)>=1;
SELECT name,score FROM test WHERE score in (SELECT stddev(score) FROM test);
SELECT name,score FROM test WHERE exists (SELECT stddev(score) FROM test where id = 1);
select a.product_id,a.expected_variance,b.v from variance_results as a join (select product_id,stddev(sale_amount) as v from sales group by product_id) b on a.product_id = b.product_id where abs(a.expected_variance - b.v) < 0.1;
select product_id as id,expected_variance,(select stddev(sale_amount) as v from sales group by product_id having product_id = 1 order by product_id) as Ev from variance_results where product_id = 1;
drop view v1;
create view v1 as select stddev(score) from test;
desc v1;
select * from v1;
PREPARE stmt1 FROM 'select stddev(?) from test';
set @a=2;
execute stmt1 using @a;

###2-11：协方差COVARIANCE/COVAR
create table num (id int primary key,itest int,ftest float,doutest double,detest decimal(9,2));
insert into num values (1,1,1.1,1.2,1.3), (2,2,2.1,2.2,2.3), (3,3,3.1,3.2,3.3);
insert into num values(4,4,4.6,3.5,6.9);
insert into num values(5,-5,-3.3,-9.9,-2.34);
insert into num values(6,-7,-3.13,-4.9,-2.15);
insert into num values(7,-7,-3.73,-9.3,-2.15);
insert into num values(8,-7,-3.73,-9.9,4.5);
select covar(itest,itest) from num;
select covar(itest,ftest) from num;
select covar(itest,doutest) from num;
select covar(itest,detest) from num;
select covar(ftest,itest) from num;
select covar(ftest,ftest) from num;
select covar(ftest,doutest) from num;
select covar(ftest,detest) from num;
select covar(doutest,itest) from num;
select covar(doutest,ftest) from num;
select covar(doutest,doutest) from num;
select covar(doutest,detest) from num;
select covar(detest,itest) from num;
select covar(detest,ftest) from num;
select covar(detest,detest) from num;
select covar(detest,itest) from num;
select covar(doutest,ftest) from num;
select covar(ftest,itest) from num;
select covar(itest,doutest) from num;
select covar(detest,doutest) from num;
select covar(cast(itest as double),itest) from num;
select covar(cast(ftest as double),itest) from num;
select covar(itest,cast(detest as double)) from num;
select covar(cast(detest as double),doutest) from num;
select covar(itest+1,doutest+1) from num;
select covar(itest+1,doutest-1) from num;
select covar(itest-1,doutest-1) from num;
select covar(itest*2-1,doutest-1) from num;
select covar(itest+1,(doutest+1)/2) from num;
select covar(itest*3,doutest/2) from num;
--error 5001
select covar(itest) from num;
--error 5006
select covar(itest,doutest,ftest) from num;
select covar(null,itest) from num;
select covar(itest,null) from num;
select covar(null,null) from num;
--error 2
select covar('a',detest) from num;
select id,doutest from num where doutest < (select covar(itest,detest) from num);
select round(covar(itest, detest),2) from num group by id;
select itest,detest from num group by id having covar(itest, detest) > 1;
select itest,detest from num where detest in(select covar(itest,detest) from num);
select itest,detest from num where  exists (select avg(itest*detest) - avg(itest)*avg(detest) from num);
select a.product_id,a.expected_variance,b.v from variance_results as a join (select product_id,avg(product_id*sale_amount) - avg(product_id)*avg(sale_amount) as v from sales group by product_id) b on a.product_id = b.product_id where abs(a.expected_variance - b.v) < 0.1;
insert into test2 values (1,null),(2,34),(3,66),(4,88),(5,99),(6,null);
select covar(id,score) from test2;
select covar(score,weight) ,covar(score,weight),covar(score,weight)from test;


###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
