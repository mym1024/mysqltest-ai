####################################必填######################################################
###1.测试功能点：指定range分区规则，测试bloomfilter_join与merge_join的使用
##
#
###2.测试项：
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：96 s
###6.编写/修改人：machen
###7.编写/修改日期：2019-11-28
###8.其他（选填）：
###
##
#
##############################################################################################

#####################################Do sql###################################################
create database b;
using database b;
sleep 5;
--disable_warnings
drop table if exists t1,t2,t3,t4;
--enable_warnings

###2-1:指定range分区规则，测试bloomfilter_join与merge_join的使用
create table t1 (id bigint, c1 bigint, c2 bigint, c3 int, c4 int, primary key(id,c1,c2)) partition by range columns(id,c1,c2)(partition rr0 values less than(1,2,3),partition rr1 values less than(3,5,7),partition rr2 values less than(5,6,8),partition rr3 values less than (maxvalue,maxvalue,maxvalue));
--real_sleep 3
insert into t1 values(1,2,3,4,5);
insert into t1 values(2,5,6,2,1);
insert into t1 values(3,4,8,2,3);
insert into t1 values(4,1,2,6,8);

create table t2 (id bigint primary key, c1 int, c2 int, c3 int, c4 int) partition by range(id)(partition r0 values less than(3),partition r1 values less than(5),partition r2 values less than(10),partition r3 values less than maxvalue);
--real_sleep 3
insert into t2 values(2,5,2,4,4);
insert into t2 values(5,5,2,5,4);
insert into t2 values(6,5,2,5,9);

create table t3 (id bigint primary key, c1 int, c2 int, c3 int, c4 int, c5 int, c6 int) partition by range(id)(partition b1 values less than(2),partition b2 values less than (5),partition b3 values less than maxvalue) ;
--real_sleep 3
insert into t3 values(1,5,2,4,4,3,22);
insert into t3 values(2,5,2,4,4,9,13);


create table t4 (id bigint primary key, c1 int, c2 int) partition by range(id)(partition c1 values less than(5),partition c2 values less than (10),partition c3 values less than maxvalue);
--real_sleep 3
insert into t4 values(3,7,2);
insert into t4 values(7,4,5);


select /*+ join(bloomfilter_join) */ * from t1 left join t2 on t1.id=t2.id and t1.c1=t2.id;
select /*+ join(bloomfilter_join) */ * from t1 inner join t2 on t1.id=t2.id and t1.c1=t2.id;
select /*+ join(bloomfilter_join) */ * from t1 right join t2  on t1.id=t2.id;
select /*+ join(bloomfilter_join) */ * from t1 full join t2  on t1.id=t2.id and t1.c1=t2.id;

select /*+ join(merge_join) */ * from t1 left join t2 on t1.id=t2.id and t1.c1=t2.id;
select /*+ join(merge_join) */ * from t1 inner join t2 on t1.id=t2.id and t1.c1=t2.id;
select /*+ join(merge_join) */ * from t1 right join t2 on t1.id=t2.id and t1.c1=t2.id;
select /*+ join(merge_join) */ * from t1 full join t2  on t1.id=t2.id and t1.c1=t2.id;


drop table t1,t2,t3,t4;
###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
