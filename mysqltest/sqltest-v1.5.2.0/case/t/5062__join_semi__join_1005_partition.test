####################################必填######################################################
###1.测试功能点：不同分区规则表中使用semi_join的多表关联查询
##
#
###2.测试项：
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：96 s
###6.编写/修改人：machen
###7.编写/修改日期：2019-11-28
###8.其他（选填）：
###
##
#
##############################################################################################

#####################################Do sql###################################################
sleep 5;
--disable_warnings
drop table if exists t1,t2,t3,t4;
--error 5077
drop partition function h1,e1;
--enable_warnings
create hash partition function h1(x)'x*3';
create table t1 (id int, c1 int, c2 int, c3 int, c4 int, primary key(id,c1,c2)) partition by(ta1,h1,id);
--real_sleep 5
insert into t1 values(1,2,3,4,5); 
insert into t1 values(2,5,6,2,1);
insert into t1 values(3,4,8,2,3);
insert into t1 values(4,1,2,6,8);

create enum partition function e1(x)'[(2)],[(5)],[(6)]';
create table t2 (id int primary key, c1 int, c2 int, c3 int, c4 int) partition by(ta2,e1,id);
--real_sleep 5
insert into t2 values(2,5,2,4,4);
insert into t2 values(5,5,2,5,4);
insert into t2 values(6,5,2,5,9);


create table t3 (id int primary key, c1 int, c2 int, c3 int, c4 int, c5 int, c6 int) partition by range(id)(partition a1 values less than(3),partition a2 values less than maxvalue);
--real_sleep 5
insert into t3 values(1,5,2,4,4,3,22);
insert into t3 values(2,5,2,4,4,9,13);


create table t4 (id int primary key, c1 int, c2 int) partition by list(id)(partition b1 values in(1,3,5),partition b2 values in(2,4,7));
--real_sleep 5
insert into t4 values(3,5,2);
insert into t4 values(7,4,5);


select /*+ join(si) */ * from t1 left join t2 on t1.id=t2.id and t1.c1=t2.id ;
select /*+ join(si) */ * from t1 inner join t2 on t1.id=t2.id and t1.c1=t2.id ;
--error 5205
select /*+ join(si) */ * from t1 right join t2  on t1.id=t2.id ;
select /*+ join(si) */ * from t1 full join t2  on t1.id=t2.id and t1.c1=t2.id ;

select /*+ join(merge_join) */ * from t1 left join t2 on t1.id=t2.id and t1.c1=t2.id ;
select /*+ join(merge_join) */ * from t1 inner join t2 on t1.id=t2.id and t1.c1=t2.id ;
select /*+ join(merge_join) */ * from t1 right join t2 on t1.id=t2.id and t1.c1=t2.id ;
select /*+ join(merge_join) */ * from t1 full join t2  on t1.id=t2.id and t1.c1=t2.id ;


drop table t1,t2,t3,t4;
drop partition function h1,e1;
###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
