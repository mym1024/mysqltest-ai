##############################################################################################
###1.测试功能点：不同分区下group by的使用
##
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：xxx
###6.编写/修改人：zhuyinying
###7.编写/修改日期：2019-12-31
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################
--disable_warnings
drop table if exists t1,t2,t3;
--enable_warnings

###2-1：list test
create table t1(pk int primary key,a int,b int,c int) partition by list(pk)(partition q1 values in(1,2,3,4,5,6,7,8,9),partition q2 values in(10,11,12,13,14,15,16,17,18,19,20),partition q3 values in(21,22,23,24,25,26,27,28));
--real_sleep 6
insert into t1(pk,a,b,c) values
(1,1,1,1),(2,1,1,2),(3,1,1,3),
(4,1,2,1),(5,1,2,2),(6,1,2,3),
(7,1,3,1),(8,1,3,2),(9,1,3,3),
(10,2,1,1),(11,2,1,2),(12,2,1,3),
(13,2,2,1),(14,2,2,2),(15,2,2,3),
(16,2,3,1),(17,2,3,2),(18,2,3,3),
(19,3,1,1),(20,3,1,2),(21,3,1,3),
(22,3,2,1),(23,3,2,2),(24,3,2,3),
(25,3,3,1),(26,3,3,2),(27,3,3,3);
--real_sleep 5
select b/c as v,a from t1 order by v;
select b/c as v,sum(a) from t1 group by v;
select sum(a) from t1 group by b/c;
drop table t1;

###2-2:hash test
create hash partition function h1(x)'(x*2+3)%4';
create table t1(pk int primary key,a int,b int,c int) partition by(ht1,h1,pk);
--real_sleep 3

insert into t1(pk,a,b,c) values
(1,1,1,1),(2,1,1,2),(3,1,1,3),
(4,1,2,1),(5,1,2,2),(6,1,2,3),
(7,1,3,1),(8,1,3,2),(9,1,3,3),
(10,2,1,1),(11,2,1,2),(12,2,1,3),
(13,2,2,1),(14,2,2,2),(15,2,2,3),
(16,2,3,1),(17,2,3,2),(18,2,3,3),
(19,3,1,1),(20,3,1,2),(21,3,1,3),
(22,3,2,1),(23,3,2,2),(24,3,2,3),
(25,3,3,1),(26,3,3,2),(27,3,3,3);
--real_sleep 3
select b/c as v,a from t1 order by v;
select b/c as v,sum(a) from t1 group by v;
select sum(a) from t1 group by b/c;
drop table t1;
drop partition function h1;

###2-3:enum test
create enum partition function e1(x) '[(1)],[(2)],[(3)],[(4)],[(5)],[(6)],[(7)],[(8)],[(9)],[(10)],[(11)],[(12)],[(13)],[(14)],[(15)],[(16)],[(17)],[(18)],[(19)],[(20)],[(21)],[(22)],[(23)],[(24)],[(25)],[(26)],[(27)],[(28)],[(29)],[(30)]';
create table t1(pk int primary key,a int,b int,c int) partition by(et1,e1,pk);
--real_sleep 6
insert into t1(pk,a,b,c) values
(1,1,1,1),(2,1,1,2),(3,1,1,3),
(4,1,2,1),(5,1,2,2),(6,1,2,3),
(7,1,3,1),(8,1,3,2),(9,1,3,3),
(10,2,1,1),(11,2,1,2),(12,2,1,3),
(13,2,2,1),(14,2,2,2),(15,2,2,3),
(16,2,3,1),(17,2,3,2),(18,2,3,3),
(19,3,1,1),(20,3,1,2),(21,3,1,3),
(22,3,2,1),(23,3,2,2),(24,3,2,3),
(25,3,3,1),(26,3,3,2),(27,3,3,3);
--real_sleep 5
select b/c as v,a from t1 order by v;
select b/c as v,sum(a) from t1 group by v;
select sum(a) from t1 group by b/c;
drop table t1;
drop partition function e1;

create table t1(pk int primary key,a int,b int,c int) partition by range(pk)(partition v1 values less than(10),partition v2 values less than(20),partition v3 values less than(30),partition v4 values less than maxvalue);
--real_sleep 6
insert into t1(pk,a,b,c) values
(1,1,1,1),(2,1,1,2),(3,1,1,3),
(4,1,2,1),(5,1,2,2),(6,1,2,3),
(7,1,3,1),(8,1,3,2),(9,1,3,3),
(10,2,1,1),(11,2,1,2),(12,2,1,3),
(13,2,2,1),(14,2,2,2),(15,2,2,3),
(16,2,3,1),(17,2,3,2),(18,2,3,3),
(19,3,1,1),(20,3,1,2),(21,3,1,3),
(22,3,2,1),(23,3,2,2),(24,3,2,3),
(25,3,3,1),(26,3,3,2),(27,3,3,3);
--real_sleep 5
select b/c as v,a from t1 order by v;
select b/c as v,sum(a) from t1 group by v;
select sum(a) from t1 group by b/c;
drop table t1;

###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
