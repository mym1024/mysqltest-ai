##############################################################################################
###1.测试功能点：使用prepare预执行查询操作
#                         
#                 
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：
###4.问题号：
###5.预计运行时间：
###6.编写/修改人： zhuyinying
###7.编写/修改日期：2020-01-13
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################
--disable_warnings
drop table if exists t1,t2,t3,t4;
--enable_warnings


create table t1 (a varchar(20) primary key,b int);
insert into t1 values ('foo',1);
prepare stmt from select length(a) from t1;
#--error 5001
prepare stmt2 from 'select not_a_function (a) from t1';

drop table t1;

create table t1 (a int primary key,b int);
insert into t1(a,b) values (1,0),(2,0),(3,0),(4,0),(5,0),(6,0),(7,0),(8,0),(9,0),(10,0);
prepare stmt from select * from t1 limit ?,?;
set @offset=0;
set @limit=1;
execute stmt using @offset,@limit;
select * from  t1 limit 0,1;

set @offset=3;
set @limit=2;
execute stmt using @offset,@limit;
select * from  t1 limit 3,2;

prepare stmt from select * from t1 limit ?;
execute stmt using @limit;
prepare stmt from select * from t1 union all select * from t1 limit ?,?;

set @offset=9;
set @limit=2;
execute stmt using @offset,@limit;
prepare stmt from (select * from t1 limit ?,?) union all (select * from t1 limit ?,?) order by a limit ?;
execute stmt using @offset,@limit,@offset,@limit,@limit;

drop table t1;
deallocate prepare stmt;

create table t1 (a int primary key,b int);
insert into t1(a,b) values (2,8),(1,9),(3,7);
prepare stmt from select * from t1 order by ?;
set @a=null;
execute stmt using @a;
set @a=1;
execute stmt using @a;
set @a=2;
execute stmt using @a;
deallocate prepare stmt;


select * from t1 order by 1;
prepare stmt from select * from t1 order by ?+1;

set @a=0;
execute stmt using @a;
set @a=1;
execute stmt using @a;
deallocate prepare stmt;

select * from t1 order by 1+1;
drop table t1;

--disable_warnings
drop table if exists t1,t2,t3;
--enable_warnings

create table t1 (i int primary key,j int);
create table t2 (i int primary key,j int);
create table t3 (i int primary key,j int);
prepare stmt from select * from t1 join t2 on (t2.i=t1.i) left join t3 on t3.i = t1.i where t1.i = ?;
set @a=1;
execute stmt using @a;
execute stmt using @a;
deallocate prepare stmt;
drop table if exists t1,t2,t3;


--disable_warnings
drop table if exists t1,t2;
--enable_warnings

create table t1 (i int primary key,j int);
create table t2 (i int primary key,j int);
insert into t1 values (1,0),(2,0);
insert into t2 values (1,0);
prepare stmt from select t2.i from t1  left join t2 on t2.i = t1.i where t1.i = ?;
set @arg=1;
execute stmt using @arg;
set @arg=2;
execute stmt using @arg;
set @arg=1;
execute stmt using @arg;

deallocate prepare stmt;
drop table t1,t2;


--disable_warnings
drop table if exists t1;
--enable_warnings
create table t1 (a bigint primary key,b bigint);
prepare stmt from insert into t1 values(?,?);
set @a= 9999999999999999;
set @b= 14632475938453979136;
execute stmt using @a,@b;
select * from t1;
deallocate prepare stmt;
drop table  t1;


###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
