##############################################################################################
###1.测试功能点：测试GIS函数功能
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：
###4.问题号：
###5.预计运行时间：
###6.编写/修改人：wubw
###7.编写/修改日期：2025-01-13
###8.其他（选填）：新增
###
##
#
##############################################################################################

#####################################Do sql###################################################
connect (conn1,$OBMYSQL_MS0,admin,admin,test,$OBMYSQL_PORT);

connection conn1;
--disable_warnings
source $LOCAL_DIR/../yaobase/bin/default_srs_data_mysql.sql;

###2-1、st_geomfromtext/st_geometryfromtext
--error 5054
select st_geomfromtext();
--error 5252
select st_geomfromtext(cast(1.1 as json));
select st_geomfromtext(null);
--error 5252
select st_geomfromtext('point(1,1)');
select hex(st_geomfromtext('pointz(1 2 3)'));
select hex(st_geomfromtext('multipoint(1 2, 2 3)'));
select hex(st_geomfromtext('multipointz(1 2 4, 2 3 5)'));
select hex(st_geomfromtext('linestring(1 2, 2 3)'));
select hex(st_geomfromtext('linestringz(1 2 3, 2 3 4)'));
select hex(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'));
select hex(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))'));
select hex(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'));
select hex(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))'));
select hex(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'));
select hex(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))'));
select hex(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'));
select hex(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'));

select hex(st_geomfromtext('point(2 3)', 4326.1));
select hex(st_geomfromtext('point(2 3)', '4326.1'));
select hex(st_geomfromtext('point(2 3)', cast(4326.1 as double)));
select hex(st_geomfromtext('point(2 3)', cast(4326.1 as json)));
--error 5238
select hex(st_geomfromtext('point(2 3)', 3));
select hex(st_geomfromtext('point(2 3)', 4326));
--error 5252
select hex(st_geomfromtext('point(2 3)', 4326, cast(1 as json)));
--error 16
select hex(st_geomfromtext('point(2 3)', 4326, 'abc'));
--error 16
select hex(st_geomfromtext('point(2 3)', 4326, 'axis-order=dududu'));
select hex(st_geomfromtext('point(2 3)', 2001, 'axis-order=lat-long'));
select hex(st_geomfromtext('point(2 3)', 4326, 'axis-order=long-lat'));
select hex(st_geomfromtext('point(2 3)', 7037, 'axis-order=srid-defined'));
--error 5215
select hex(st_geomfromtext('point(2 181)', 4326, 'axis-order=lat-long'));
--error 5216
select hex(st_geomfromtext('point(91 3)', 4326, 'axis-order=srid-defined'));
select hex(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326, 'axis-order=long-lat'));

create table geo(b geometry);
insert into geo values(st_geomfromtext('point(1 1)')),(st_geomfromtext('point(2 2)'));
select _st_asewkt(b) from geo;
update geo set b=null where b=st_geomfromtext('point(2 2)');
select _st_asewkt(b) from geo;
update geo set b=st_geomfromtext('point(1 1)');
select _st_asewkt(b) from geo;
update geo set b=st_geomfromtext('point(2 2)') where b=st_geomfromtext('point(1 1)');
select _st_asewkt(b) from geo;
create table func_test(c1 varchar(10), c2 int, c3 varchar(20));
insert into func_test values('point(1 1)', 0, 'axis-order=lat-long'),('point(2 3)', 4326, 'axis-order=long-lat');
select _st_asewkt(st_geomfromtext(c1,c2,c3)) from func_test;
drop table func_test;
truncate table geo;
insert into geo values(st_geomfromtext('point(1 1)')),(st_geomfromtext('point(2 2)'));
select _st_asewkt(b) from geo where b=st_geomfromtext('point(1 1)');
select b,_st_asewkt(b) from geo having b=st_geomfromtext('point(1 1)');
delete from geo where b=st_geomfromtext('point(1 1)');
select * from geo;
truncate table geo;
insert into geo values(st_geomfromtext('point(1 1)')),(st_geomfromtext('point(2 2)'));
(select _st_asewkt(b) from geo) union (select _st_asewkt(b) from geo where b=st_geomfromtext('point(1 1)'));
(select _st_asewkt(b) from geo) intersect (select _st_asewkt(b) from geo where b=st_geomfromtext('point(1 1)'));
(select _st_asewkt(b) from geo) except (select _st_asewkt(b) from geo where b=st_geomfromtext('point(1 1)'));
select st_aswkt(st_geometryfromtext('point(1 1)'));
select count(1) from geo where b in (select st_geomfromtext('point(1  1)'));
create table p(b point);
insert into p values(st_geomfromtext('point(1 1)')),(st_geomfromtext('point(3 3)'));
select * from geo join p on geo.b=st_geometryfromtext('point(1 1)');

###2-2、st_astext/st_aswkt
--error 5054
select st_astext(1,2,3);
--error 5243
select st_astext(cast(1.1 as double));
select st_astext(null);
--error 5243
select st_astext(x'0101010101010101');
select st_astext(x'000000000101000000000000000000F03F000000000000F03F');
select st_astext(st_geomfromtext('point(1 2)'));
select st_astext(st_geomfromtext('pointz(1 2 3)'));
select st_astext(st_geomfromtext('multipoint(1 2, 2 3)'));
select st_astext(st_geomfromtext('multipointz(1 2 4, 2 3 5)'));
select st_astext(st_geomfromtext('linestring(1 2, 2 3)'));
select st_astext(st_geomfromtext('linestringz(1 2 3, 2 3 4)'));
select st_astext(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'));
select st_astext(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))'));
select st_astext(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'));
select st_astext(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))'));
select st_astext(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'));
select st_astext(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))'));
select st_astext(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'));
select st_astext(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'));
--error 16
select st_astext(st_geomfromtext('point(2 3)'), 4326);
--error 16
select st_astext(st_geomfromtext('point(2 3)'), cast(4326.1 as json));
--error 16
select st_astext(st_geomfromtext('point(2 3)'), 'abc');
--error 16
select st_astext(st_geomfromtext('point(2 3)'), 'axis-order');
select st_astext(st_geomfromtext('point(2 3)', 2001), 'axis-order=lat-long');
select st_astext(st_geomfromtext('point(2 3)', 4326), 'axis-order=long-lat');	
select st_astext(st_geomfromtext('point(2 3)', 7037), 'axis-order=srid-defined');
select st_astext(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326), 'axis-order=lat-long');
select st_astext(st_geomfromtext('point(2 3)', 4326, 'axis-order=lat-long'), 'axis-order=lat-long');

create table test_st_aswkt(b varchar(1024));
insert into test_st_aswkt values(st_aswkt(st_geomfromtext('point(1 1)'))),(st_aswkt(st_geomfromtext('point(2 2)')));
select * from test_st_aswkt;
update test_st_aswkt set b=null where b=st_aswkt(st_geomfromtext('point(2 2)'));
select * from test_st_aswkt;
update test_st_aswkt set b=st_aswkt(st_geomfromtext('point(1 1)'));
select * from test_st_aswkt;
update test_st_aswkt set b=st_aswkt(st_geomfromtext('point(2 2)')) where b=st_aswkt(st_geomfromtext('point(1 1)'));
select * from test_st_aswkt;
create table func_test(c1 geometry,  c2 varchar(20));
insert into func_test values(st_geomfromtext('point(1 5)'), 'axis-order=lat-long'),(st_geomfromtext('point(2 1)'), 'axis-order=long-lat');
select st_astext(c1, c2) from func_test;
drop table func_test;
truncate table test_st_aswkt;
insert into test_st_aswkt values('point(1 1)'),('point(2 2)');
select * from test_st_aswkt where b=st_aswkt(st_geomfromtext('point(1 1)'));
select b from test_st_aswkt having b=st_aswkt(st_geomfromtext('point(1 1)'));
delete from test_st_aswkt where b=st_aswkt(st_geomfromtext('point(1 1)'));
select * from test_st_aswkt;
truncate table test_st_aswkt;
insert into test_st_aswkt values('point(1 1)'),('point(2 2)');
(select * from test_st_aswkt) union (select * from test_st_aswkt where b=st_aswkt(st_geomfromtext('point(1 1)')));
(select * from test_st_aswkt) intersect (select * from test_st_aswkt where b=st_aswkt(st_geomfromtext('point(1 1)')));
(select * from test_st_aswkt) except (select * from test_st_aswkt where b=st_aswkt(st_geomfromtext('point(1 1)')));
select st_aswkt(point(1,1));
select length(st_aswkt(point(1,1)));
select count(1) from test_st_aswkt where b in (select st_aswkt(point(1,1)));
create table test_st_aswkt1(b varchar(1024));
insert into test_st_aswkt1 values('point(1 1)'),('point(3 3)');
select * from test_st_aswkt join test_st_aswkt1 on test_st_aswkt.b=st_astext(point(1,1));
drop table test_st_aswkt, test_st_aswkt1;

###2-3、st_buffer_strategy
--error 5054
select st_buffer_strategy();
--error 2
select st_buffer_strategy(cast(1.1 as json));
select st_buffer_strategy(null);
--error 2
select st_buffer_strategy('start_round');
select hex(st_buffer_strategy('point_square'));
--error 2
select hex(st_buffer_strategy('join_miter'));
select hex(st_buffer_strategy('end_flat'));
select hex(st_buffer_strategy('point_circle', 1.1));
select hex(st_buffer_strategy('join_round', 2));
select hex(st_buffer_strategy('join_miter', 3.45));
select hex(st_buffer_strategy('end_round', 8));
--error 2
select hex(st_buffer_strategy('point_circle', -1.1));
--error 2
select hex(st_buffer_strategy('join_round', 'a2'));
select hex(st_buffer_strategy('join_miter', cast(1 as json)));

create table test_st(b varchar(1024));
insert into test_st values(st_buffer_strategy('point_square')),(st_buffer_strategy('end_round', 8));
select hex(b) from test_st;
update test_st set b=null where b=st_buffer_strategy('end_round', 8);
select hex(b) from test_st;
update test_st set b=st_buffer_strategy('point_square');
select hex(b) from test_st;
update test_st set b=st_buffer_strategy('join_round', 2) where b=st_buffer_strategy('point_square');
select hex(b) from test_st;
create table func_test(c1 varchar(20),  c2 double);
insert into func_test values('join_round',2),('point_circle',3);
select hex(st_buffer_strategy(c1, c2)) from func_test;
drop table func_test;
truncate table test_st;
insert into test_st values(st_buffer_strategy('join_round', 2)),(st_buffer_strategy('point_square'));
select hex(b) from test_st where b=st_buffer_strategy('point_square');
select b,hex(b) from test_st having b=st_buffer_strategy('point_square');
delete from test_st where b=st_buffer_strategy('point_square');
select hex(b) from test_st;
truncate table test_st;
insert into test_st values(st_buffer_strategy('join_round', 2)),(st_buffer_strategy('point_square'));
(select hex(b) from test_st) union (select hex(b) from test_st where b=st_buffer_strategy('point_square'));
(select hex(b) from test_st) intersect (select hex(b) from test_st where b=st_buffer_strategy('point_square'));
(select hex(b) from test_st) except (select hex(b) from test_st where b=st_buffer_strategy('point_square'));
select length(st_buffer_strategy('point_square'));
select count(1) from test_st where b in (select st_buffer_strategy('point_square'));
create table test_st1(b varchar(1024));
insert into test_st1 values(st_buffer_strategy('join_round', 3)),(st_buffer_strategy('point_square'));
select hex(test_st.b),hex(test_st1.b) from test_st join test_st1 on test_st.b=st_buffer_strategy('point_square');
drop table test_st, test_st1;

###2-4、st_buffer
--error 5054
select st_buffer(point(1,1));
--error 5238
select st_buffer(cast(1.1 as double), 1.1);
select st_buffer(null, 1.1);
select st_astext(st_buffer(x'000000000101000000000000000000F03F000000000000F03F', 1.1));
select st_astext(st_buffer(st_geomfromtext('pointz(1 2 3)'), 1)) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('point(1 2)'), -1)) as res;
select st_astext(st_buffer(st_geomfromtext('point(1 2)', 4326), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('multipointz(1 2 4, 2 3 5)'), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('multipoint(1 2, 2 3)', 2001), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('linestringz(1 2 3, 2 3 4)'), 1)) as res;
--error 5246
select st_astext(st_buffer(st_geomfromtext('linestring(1 2, 2 3)', 4326), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))'), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))', 2001), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))'), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))'), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), -1)) as res;
select st_astext(st_buffer(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'), 1)) as res;
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), -1)) as res;
--error 5246
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326), 1)) as res;
select st_astext(st_buffer(point(0, 0), cast(3.5 as json)));
--error 2
select st_astext(st_buffer(point(0, 0), 1, 'aaa', st_buffer_strategy('join_round', 2)));
select st_astext(st_buffer(point(0, 0), 1, null, 1));
select st_astext(st_buffer(st_geomfromtext('point(1 2)'), 1, st_buffer_strategy('point_square'))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('point(1 2)', 4326), 1, st_buffer_strategy('point_square'))) as res;
select st_astext(st_buffer(st_geomfromtext('multipoint(1 2, 2 3)'), 1, st_buffer_strategy('point_square'))) as res;
--error 5246
select st_astext(st_buffer(st_geomfromtext('multipoint(1 2, 2 3)', 4326), 1, st_buffer_strategy('point_square'))) as res;
select st_astext(st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), 1, st_buffer_strategy('join_miter', 3))) as res;
select st_astext(st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), 1, st_buffer_strategy('end_round', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1, st_buffer_strategy('point_circle', 8))) as res;
select st_astext(st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1, st_buffer_strategy('end_flat'))) as res;
select st_astext(st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1, st_buffer_strategy('join_round', 2))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), 1, st_buffer_strategy('end_round', 8))) as res;
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), 1, st_buffer_strategy('join_round', 2))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), 1, st_buffer_strategy('point_circle', 8))) as res;
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), -1, st_buffer_strategy('join_round', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), 1, st_buffer_strategy('end_flat'))) as res;
select st_astext(st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), -1, st_buffer_strategy('join_miter', 2))) as res;
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 1, st_buffer_strategy('join_miter', 3))) as res;
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), -1, st_buffer_strategy('join_round', 8))) as res;
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 1, st_buffer_strategy('end_round', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('point(1 2)'), 1, st_buffer_strategy('point_square'), st_buffer_strategy('point_circle', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('multipoint(1 2, 2 3)'), 1, st_buffer_strategy('end_round', 8), st_buffer_strategy('point_square'))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), 1, st_buffer_strategy('join_round', 2), st_buffer_strategy('join_miter', 3))) as res;
select st_astext(st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), 1, st_buffer_strategy('join_miter', 3), st_buffer_strategy('end_round', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1, st_buffer_strategy('point_square'), st_buffer_strategy('point_circle', 8))) as res;
select st_astext(st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1, st_buffer_strategy('join_round', 2), st_buffer_strategy('end_flat'))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), 1, st_buffer_strategy('join_miter', 3), st_buffer_strategy('end_round', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), 1, st_buffer_strategy('join_miter', 3), st_buffer_strategy('end_round', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), 1, st_buffer_strategy('point_square'), st_buffer_strategy('point_circle', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 1, st_buffer_strategy('join_round', 2), st_buffer_strategy('join_miter', 3))) as res;
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 1, st_buffer_strategy('join_miter', 3), st_buffer_strategy('end_round', 8))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('point(1 2)'), 1, st_buffer_strategy('point_square'), st_buffer_strategy('end_flat'), st_buffer_strategy('join_round', 2))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('multipoint(1 2, 2 3)'), 1, st_buffer_strategy('point_circle', 8), st_buffer_strategy('end_round', 8), st_buffer_strategy('join_miter', 3))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), 1, st_buffer_strategy('point_circle', 8), st_buffer_strategy('end_flat'), st_buffer_strategy('join_miter', 3))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1, st_buffer_strategy('point_square'), st_buffer_strategy('end_flat'), st_buffer_strategy('join_round', 2))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), 1, st_buffer_strategy('point_square'), st_buffer_strategy('end_flat'), st_buffer_strategy('join_round', 2))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), -1, st_buffer_strategy('point_circle', 8), st_buffer_strategy('end_round', 8), st_buffer_strategy('join_miter', 3))) as res;
--error 2
select st_astext(st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), 1, st_buffer_strategy('point_circle', 8), st_buffer_strategy('end_round', 8), st_buffer_strategy('join_miter', 3))) as res;
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 1, st_buffer_strategy('point_circle', 8), st_buffer_strategy('end_round', 8), st_buffer_strategy('join_miter', 3))) as res;
select st_astext(st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), -1, st_buffer_strategy('point_circle', 8), st_buffer_strategy('end_round', 8), st_buffer_strategy('join_miter', 3))) as res;
create table test(b geometry);
insert into test values(st_buffer(point(1, 1), 2)),(st_buffer(point(0, 0), 1));
select hex(b) from test;
update test set b= point(2,2) where b=st_buffer(point(0, 0), 1);
select hex(b) from test;
update test set b=st_buffer(point(2, 3), 1);
select hex(b) from test;
select hex(st_buffer(b, 1)) from test limit 1;
select hex(b) from test where b = st_buffer(point(2, 3), 1);
delete from test where b=st_buffer(point(2, 3), 1);
select hex(b) from test;
drop table test;

###2-5、st_transform
--error 5054
select st_transform(point(1,1));
--error 5238
select st_astext(st_transform('a2', 4326));
--error 5252
select st_astext(st_transform(cast(1 as json), 4326));
select st_astext(st_transform(null, 4326));
select st_astext(st_transform(st_geomfromtext('point(1 1)', 4326), '4230'));
--error 5248
select st_astext(st_transform(st_geomfromtext('point(1 1)', 4326), 'aaa'));
select st_astext(st_transform(st_geomfromtext('point(1 1)', 4326), cast(4326 as json)));
select st_astext(st_transform(st_geomfromtext('point(1 1)', 4326), 4230.33));
select st_astext(st_transform(st_geomfromtext('point(1 1)', 4326), null));
select st_astext(st_transform(st_geomfromtext('point(1 1)', 4326), 4230));
select st_astext(st_transform(st_geomfromtext('multipoint(1 1, 2 2)', 4326), 4230));
select st_astext(st_transform(st_geomfromtext('linestring(1 1, 2 3)', 4326), 4230));
select st_astext(st_transform(st_geomfromtext('multilinestring((1 1, 2 2))', 4326), 4230));
select st_astext(st_transform(st_geomfromtext('polygon((1 1, 2 2, 3 3, 1 1))', 4326), 4230));
select st_astext(st_transform(st_geomfromtext('multipolygon(((1 1, 2 2, 3 3, 1 1)))', 4326), 4230));
select st_astext(st_transform(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326), 4230));
--error 5247
select st_astext(st_transform(st_geomfromtext('point(1 1)', 2001), 4230));
select st_astext(st_transform(st_geomfromtext('point(1 1)', 2001), 2001));
select st_astext(st_transform(st_geomfromtext('point(1 1)', 4326), 4326));
--error 5249
select st_astext(st_transform(st_geomfromtext('point(1 1)', 7037), 4326));
select st_srid(st_transform(st_geomfromtext('point(1 1)', 4326), 4230));
create table test(b geometry);
insert into test values(st_geomfromtext('point(1 1)', 4326)),(st_transform(st_geomfromtext('point(1 1)', 4326), 4230));
select hex(b) from test;
update test set b= st_geomfromtext('point(1 1)', 4230) where b=st_transform(st_geomfromtext('point(1 1)', 4326), 4230);
select hex(b) from test;
update test set b=st_transform(st_geomfromtext('point(2 2)', 4326), 4230);
select hex(b) from test;
select hex(st_transform(b, 4326)) from test;
select hex(b) from test where b = st_transform(st_geomfromtext('point(2 2)', 4326), 4230);
delete from test where b=st_transform(st_geomfromtext('point(2 2)', 4326), 4230);
select hex(b) from test;
drop table test;

###2-6、st_geomfromwkb/st_geometryfromwkb
--error 2
select st_geomfromwkb(1,2,3,4);
--error 5252
select st_geomfromwkb(cast(1.1 as json));
select st_geomfromwkb(null);
select st_astext(st_geomfromwkb(x'01E9030000000000000000F03F00000000000000400000000000000840')) res;
select st_astext(st_geomfromwkb(x'01EC0300000200000001E9030000000000000000F03F0000000000000040000000000000104001E9030000000000000000004000000000000008400000000000001440')) res;
select st_astext(st_geomfromwkb(x'01EA03000002000000000000000000F03F00000000000000400000000000000840000000000000004000000000000008400000000000001040')) res;
select st_astext(st_geomfromwkb(x'01ED0300000200000001EA03000002000000000000000000F03F0000000000000040000000000000084000000000000000400000000000000840000000000000104001EA03000002000000000000000000084000000000000010400000000000001440000000000000144000000000000018400000000000001840')) res;
select st_astext(st_geomfromwkb(x'01EB030000010000000500000000000000000000000000000000000000000000000000F03F00000000000010400000000000000000000000000000F03F00000000000010400000000000001040000000000000F03F00000000000000000000000000001040000000000000F03F00000000000000000000000000000000000000000000F03F')) res;
select st_astext(st_geomfromwkb(x'01EB030000020000000500000000000000000000000000000000000000000000000000F03F00000000000010400000000000000000000000000000F03F00000000000010400000000000001040000000000000F03F00000000000000000000000000001040000000000000F03F00000000000000000000000000000000000000000000F03F05000000000000000000F03F000000000000F03F000000000000F03F0000000000000040000000000000F03F000000000000F03F00000000000000400000000000000040000000000000F03F000000000000F03F0000000000000040000000000000F03F000000000000F03F000000000000F03F000000000000F03F')) res;
select st_astext(st_geomfromwkb(x'01EE0300000200000001EB030000010000000500000000000000000000000000000000000000000000000000F03F00000000000010400000000000000000000000000000F03F00000000000010400000000000001040000000000000F03F00000000000000000000000000001040000000000000F03F00000000000000000000000000000000000000000000F03F01EB0300000100000005000000000000000000F03F000000000000F03F000000000000F03F0000000000000040000000000000F03F000000000000F03F00000000000000400000000000000040000000000000F03F000000000000F03F0000000000000040000000000000F03F000000000000F03F000000000000F03F000000000000F03F')) res;
select st_astext(st_geomfromwkb(x'01EF0300000300000001E903000000000000000000400000000000000840000000000000084001EA03000002000000000000000000F03F0000000000000040000000000000004000000000000000400000000000000840000000000000104001EB0300000100000005000000000000000000000000000000000000000000000000001040000000000000104000000000000000000000000000001040000000000000104000000000000010400000000000001040000000000000000000000000000010400000000000001040000000000000000000000000000000000000000000001040')) res;
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', 4326.1)) res;
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', cast(4326.1 as double))) res;
--error 5238
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', 3)) res;
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', 4326)) res;
--error 5252
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', 4326, cast(1 as json))) res;
--error 16
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', 4326, 'axis-order=dududu')) res;
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', 2001, 'axis-order=lat-long')) res;
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', 4326, 'axis-order=long-lat')) res;
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000000840', 7037, 'axis-order=srid-defined')) res;
--error 5215
select st_astext(st_geomfromwkb(x'010100000000000000000000400000000000A06640', 4326, 'axis-order=lat-long')) res;
select st_astext(st_geomfromwkb(x'01010000000000000000C056400000000000000840', 4326, 'axis-order=long-lat')) res;
--error 5216
select st_astext(st_geomfromwkb(x'01010000000000000000C056400000000000000840', 4326, 'axis-order=srid-defined')) res;
select st_astext(st_geomfromwkb(x'010700000003000000010100000000000000000000400000000000000840010200000002000000000000000000F03F000000000000004000000000000000400000000000000840010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000', 4326, 'axis-order=long-lat')) res;
truncate table geo;
insert into geo values(st_geomfromwkb(x'0101000000000000000000F03F000000000000F03F')),(st_geomfromwkb(x'010100000000000000000000400000000000000040'));
select _st_asewkt(b) from geo;
update geo set b=null where b=st_geomfromwkb(x'010100000000000000000000400000000000000040');
select _st_asewkt(b) from geo;
update geo set b=st_geomfromwkb(x'0101000000000000000000F03F000000000000F03F');
select _st_asewkt(b) from geo;
update geo set b=st_geomfromwkb(x'010100000000000000000000400000000000000040') where b=st_geomfromwkb(x'0101000000000000000000F03F000000000000F03F');
select _st_asewkt(b) from geo;
create table func_test(c1 varchar(100), c2 int, c3 varchar(20));
insert into func_test values(x'0101000000000000000000F03F000000000000F03F', 0, 'axis-order=lat-long'),(x'010100000000000000000000400000000000000040', 4326, 'axis-order=long-lat');
select _st_asewkt(st_geomfromwkb(c1,c2,c3)) from func_test;
drop table func_test;
truncate table geo;
insert into geo values(st_geomfromwkb(x'0101000000000000000000F03F000000000000F03F')),(st_geomfromwkb(x'010100000000000000000000400000000000000040'));
select _st_asewkt(b) from geo where b=st_geomfromwkb(x'0101000000000000000000F03F000000000000F03F');
delete from geo where b=st_geomfromwkb(x'0101000000000000000000F03F000000000000F03F');
select * from geo;

###2-7、st_asbinary/st_aswkb
--error 5054
select st_aswkb(1,2,3);
--error 5243
select st_aswkb(cast(1.1 as double));
select st_aswkb(null);
select hex(st_aswkb(x'000000000101000000000000000000F03F000000000000F03F'));
select hex(st_aswkb(st_geomfromtext('pointz(1 2 3)')));
select hex(st_aswkb(st_geomfromtext('multipoint(1 2, 2 3)')));
select hex(st_aswkb(st_geomfromtext('linestringz(1 2 3, 2 3 4)')));
select hex(st_aswkb(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))')));
select hex(st_aswkb(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))')));
select hex(st_aswkb(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select hex(st_aswkb(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))')));
select hex(st_aswkb(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
--error 16
select hex(st_aswkb(st_geomfromtext('point(2 3)'), 4326));
--error 16
select hex(st_aswkb(st_geomfromtext('point(2 3)'), 'axis-order'));
select hex(st_aswkb(st_geomfromtext('point(2 3)', 2001), 'axis-order=lat-long'));
select hex(st_aswkb(st_geomfromtext('point(2 3)', 4326), 'axis-order=long-lat'));
select hex(st_aswkb(st_geomfromtext('point(2 3)', 7037), 'axis-order=srid-defined'));
select hex(st_aswkb(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326), 'axis-order=lat-long'));
select hex(st_aswkb(st_geomfromtext('point(2 3)', 4326, 'axis-order=long-lat'), 'axis-order=lat-long'));
select hex(st_aswkb(st_geomfromtext('point(2 3)', 4326, 'axis-order=lat-long'), 'axis-order=long-lat'));
create table test_st_aswkb(b varchar(1024));
insert into test_st_aswkb values(st_aswkb(st_geomfromtext('point(3 3)'))),(st_aswkb(st_geomfromtext('point(2 2)')));
select hex(b) from test_st_aswkb;
update test_st_aswkb set b=null where b=st_aswkb(st_geomfromtext('point(2 2)'));
select * from test_st_aswkb;
update test_st_aswkb set b=st_aswkb(st_geomfromtext('point(3 3)'));
select hex(b) from test_st_aswkb;
update test_st_aswkb set b=st_aswkb(st_geomfromtext('point(2 2)')) where b=st_aswkb(st_geomfromtext('point(3 3)'));
select hex(b) from test_st_aswkb;
create table func_test(c1 geometry,  c2 varchar(200));
insert into func_test values(st_geomfromtext('point(3 5)'), 'axis-order=lat-long'),(st_geomfromtext('point(2 3)'), 'axis-order=long-lat');
select hex(st_aswkb(c1, c2)) from func_test;
drop table func_test;
truncate table test_st_aswkb;
insert into test_st_aswkb values('point(3 3)'),(x'010100000000000000000000400000000000000040');
select hex(b) from test_st_aswkb where b=st_aswkb(st_geomfromtext('point(2 2)'));
delete from test_st_aswkb where b=st_aswkb(st_geomfromtext('point(2 2)'));
select * from test_st_aswkb;

###2-8、st_area
--error 5054
select st_area(point(1,1),1);
--error 5252
select st_area(cast(1.1 as json));
select st_area(null);
--error 5238
select st_area(x'0101010101010101');
select (st_area(x'00000000010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000')) res;
--error 16
select st_area(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))'));
select st_area(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))'));
select st_area(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',2001));
select st_area(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))',4326));
select st_area(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))',7037));
select st_area(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'));
select st_area(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))',2001));
select st_area(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',4326));
select st_area(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))',7037));
select st_area(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'));
select st_area(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))',2001));
select st_area(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))',4326));
select st_area(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))',7037));
--error 16
select st_area(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'));
create table test(a geometry, b double);
insert into test values(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), st_area(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'))),(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), st_area(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select st_astext(a), b from test;
update test set b=b+1 where b = st_area(a);
select st_astext(a), b from test;
update test set b=st_area(a);
select st_astext(a), b from test;
select st_area(a) *  st_area(a) from test;
select st_astext(a), b from test where b = st_area(a);
delete from test where b = st_area(a);
drop table test;

###2-9、st_srid/_st_setsrid
--error 5054
select st_srid();
--error 5252
select st_srid(1);
select st_srid(null);
select st_srid(x'E61000000101000000000000000000F03F000000000000F03F');
select st_srid(st_geomfromtext('point(1 2)', 4326));
--error 5252
select st_srid(st_geomfromtext('pointz(1 2 3)', 2001));
select st_srid(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'));
--error 5252
select st_srid(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'));
select st_srid(x'010000000101000000000000000000F03F000000000000F03F');
select hex(st_srid(st_geomfromtext('point(2 3)'), cast(4326.1 as double)));
select hex(st_srid(st_geomfromtext('point(2 3)'), 'aaa'));
select hex(st_srid(st_geomfromtext('point(2 3)',4326), 7037));
select hex(st_srid(st_geomfromtext('multipoint(1 2, 2 3)',2001), 0));
select hex(st_srid(st_geomfromtext('linestring(1 2, 2 3)'), 4326));
select hex(st_srid(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))',2001), 4326));
select hex(st_srid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',4326), 7037));
select _st_asewkt(st_srid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',2001), 0));
select _st_asewkt(st_srid(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), 4326)) res;
select _st_asewkt(st_srid(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326), 7037)) res;
--error 5238
select hex(st_srid(st_geomfromtext('point(2 2)', 4326), 1));
select hex(st_srid(st_geomfromtext('point(91 181)'), 2001));
--error 5215
select hex(st_srid(st_geomfromtext('point(181 2)', 2001), 4326));
create table test(a geometry, b int, c geometry);
insert into test values(st_geomfromtext('point(0 3)'), st_srid(st_geomfromtext('point(0 3)')), st_srid(st_geomfromtext('point(0 3)'), 4326)),(st_geomfromtext('point(2 2)', 4326), st_srid(st_geomfromtext('point(2 2)', 4326)), st_srid(st_geomfromtext('point(2 2)', 4326), 2001));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_srid(a);
select _st_asewkt(a), b from test;
update test set b=st_srid(a), c=st_srid(a, 7037);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_srid(a) *  st_srid(a) from test;
select _st_asewkt(a), b from test where b = st_srid(a);
delete from test where b = st_srid(a);
drop table test;

###2-10、st_x
--error 5054
select st_x(1,2,3);
--error 5238
select st_x(1.1);
select st_x(null);
select st_x(x'E61000000101000000000000000000F03F000000000000F03F');
select st_x(st_geomfromtext('point(1 2)', 4326));
--error 5252
select st_x(st_geomfromtext('pointz(1 2 3)', 2001));
--error 16
select st_x(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'));
select st_x(st_geomfromtext('point(2 3)',7037));
select _st_asewkt(st_x(x'000000000101000000000000000000F03F000000000000F03F', 2));
select _st_asewkt(st_x(st_geomfromtext('point(2 3)'), 4326)) res;
select _st_asewkt(st_x(st_geomfromtext('point(2 3)'), cast(4326.1 as double))) res;
select _st_asewkt(st_x(st_geomfromtext('point(2 3)'), 5));
select _st_asewkt(st_x(st_geomfromtext('point(2 3)',2001), -8));
--error 16
select st_x(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),1);
select _st_asewkt(st_x(st_geomfromtext('point(2 3)'), 181));
select _st_asewkt(st_x(st_geomfromtext('point(2 3)', 2001), -89));
select _st_asewkt(st_x(st_geomfromtext('point(2 3)', 2001), 181));
select _st_asewkt(st_x(st_geomfromtext('point(2 3)', 4326), -89));
--error 5216
select _st_asewkt(st_x(st_geomfromtext('point(2 3)', 4326), 91));
select _st_asewkt(st_x(st_geomfromtext('point(2 3)', 7037), 91));
--error 5215
select _st_asewkt(st_x(st_geomfromtext('point(2 3)', 7037), 181));
create table test(a geometry, b int, c geometry);
insert into test values(st_geomfromtext('point(0 3)'), st_x(st_geomfromtext('point(0 3)')), st_x(st_geomfromtext('point(0 3)'), 4)),(st_geomfromtext('point(2 2)', 4326), st_x(st_geomfromtext('point(2 2)', 4326)), st_x(st_geomfromtext('point(2 2)', 4326), 6));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_x(a);
select _st_asewkt(a), b from test;
update test set b=st_x(a), c=st_x(a, -3);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_x(a) *  st_x(a) from test;
select _st_asewkt(a), b from test where b = st_x(a);
delete from test where b = st_x(a);
drop table test;

###2-11、st_y
--error 5054
select st_y();
--error 5238
select st_y(cast(1.1 as double));
select st_y(null);
select st_y(x'E61000000101000000000000000000F03F000000000000F03F');
select st_y(st_geomfromtext('point(1 2)', 4326));
--error 16
select st_y(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'));
select st_y(st_geomfromtext('point(2 3)',4326));
select _st_asewkt(st_y(x'000000000101000000000000000000F03F000000000000F03F', 2));
select _st_asewkt(st_y(st_geomfromtext('point(2 3)'), '4326.1')) res;
select _st_asewkt(st_y(st_geomfromtext('point(2 3)'), cast(4326.1 as json))) res;
select _st_asewkt(st_y(st_geomfromtext('point(2 3)'), 'aaa')) res;
select _st_asewkt(st_y(st_geomfromtext('point(2 3)',2001), -8));
--error 16
select st_y(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),1);
select _st_asewkt(st_y(st_geomfromtext('point(2 3)'), 181));
select _st_asewkt(st_y(st_geomfromtext('point(2 3)', 2001), -89));
--error 5215
select _st_asewkt(st_y(st_geomfromtext('point(2 3)', 4326), 181));
select _st_asewkt(st_y(st_geomfromtext('point(2 3)', 7037), -89));
--error 5216
select _st_asewkt(st_y(st_geomfromtext('point(2 3)', 7037), 91));
create table test(a geometry, b int, c geometry);
insert into test values(st_geomfromtext('point(0 3)'), st_y(st_geomfromtext('point(0 3)')), st_y(st_geomfromtext('point(0 3)'), 4)),(st_geomfromtext('point(2 2)', 4326), st_y(st_geomfromtext('point(2 2)', 4326)), st_y(st_geomfromtext('point(2 2)', 4326), 6));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_y(a);
select _st_asewkt(a), b from test;
update test set b=st_y(a), c=st_y(a, -3);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_y(a) *  st_y(a) from test;
select _st_asewkt(a), b from test where b = st_y(a);
delete from test where b = st_y(a);
drop table test;

###2-12、st_latitude
--error 5054
select st_latitude(1,2,3);
--error 5252
select st_latitude(cast(1.1 as json));
select st_latitude(null);
select st_latitude(x'E61000000101000000000000000000F03F000000000000F03F');
select st_latitude(st_geomfromtext('point(1 2)', 4326));
--error 16
select st_latitude(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'));
--error 7
select st_latitude(st_geomfromtext('point(2 3)',2001));
select st_latitude(st_geomfromtext('point(2 3)',7037));
select _st_asewkt(st_latitude(x'E61000000101000000000000000000F03F000000000000F03F', 2));
select _st_asewkt(st_latitude(st_geomfromtext('point(2 3)',4326), '1.1')) res;
select _st_asewkt(st_latitude(st_geomfromtext('point(2 3)',4326), cast(1.1 as double))) res;
select _st_asewkt(st_latitude(st_geomfromtext('point(2 3)',4326), 'aaa')) res;
select _st_asewkt(st_latitude(st_geomfromtext('point(2 3)',4326), 8));
--error 16
select st_latitude(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326),1);
--error 7
select _st_asewkt(st_latitude(st_geomfromtext('point(2 3)', 2001), -89));
select _st_asewkt(st_latitude(st_geomfromtext('point(2 3)', 4326), -89));
--error 5216
select _st_asewkt(st_latitude(st_geomfromtext('point(2 3)', 7037), 181));
create table test(a geometry, b int, c geometry);
insert into test values(st_geomfromtext('point(0 3)',4326), st_latitude(st_geomfromtext('point(0 3)',4326)), st_latitude(st_geomfromtext('point(0 3)',4326), 4)),(st_geomfromtext('point(2 2)', 7037), st_latitude(st_geomfromtext('point(2 2)', 7037)), st_latitude(st_geomfromtext('point(2 2)', 7037), 6));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_latitude(a);
select _st_asewkt(a), b from test;
update test set b=st_latitude(a), c=st_latitude(a, -3);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_latitude(a) *  st_latitude(a) from test;
select _st_asewkt(a), b from test where b = st_latitude(a);
delete from test where b = st_latitude(a);
drop table test;

###2-13、st_longitude
--error 5054
select st_longitude();
--error 5238
select st_longitude(1);
select st_longitude(null);
select st_longitude(x'E61000000101000000000000000000F03F000000000000F03F');
select st_longitude(st_geomfromtext('point(1 2)', 4326));
--error 16
select st_longitude(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'));
--error 5238
select st_longitude(x'010000000101000000000000000000F03F000000000000F03F');
select st_longitude(st_geomfromtext('point(2 3)',7037));
select _st_asewkt(st_longitude(x'E61000000101000000000000000000F03F000000000000F03F', 2));
select _st_asewkt(st_longitude(st_geomfromtext('point(2 3)',4326), '1.1')) res;
select _st_asewkt(st_longitude(st_geomfromtext('point(2 3)',4326), cast(1.1 as double))) res;
--error 7
select _st_asewkt(st_longitude(st_geomfromtext('point(2 3)'), 5));
select _st_asewkt(st_longitude(st_geomfromtext('point(2 3)',7037), -5));
--error 16
select st_longitude(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326),1);
--error 7
select _st_asewkt(st_longitude(st_geomfromtext('point(2 3)', 2001), 181));
select _st_asewkt(st_longitude(st_geomfromtext('point(2 3)', 4326), 91));
--error 5215
select _st_asewkt(st_longitude(st_geomfromtext('point(2 3)', 7037), 181));
create table test(a geometry, b int, c geometry);
insert into test values(st_geomfromtext('point(0 3)',4326), st_longitude(st_geomfromtext('point(0 3)',4326)), st_longitude(st_geomfromtext('point(0 3)',4326), 4)),(st_geomfromtext('point(2 2)', 7037), st_longitude(st_geomfromtext('point(2 2)', 7037)), st_longitude(st_geomfromtext('point(2 2)', 7037), 6));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_longitude(a);
select _st_asewkt(a), b from test;
update test set b=st_longitude(a), c=st_longitude(a, -3);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_longitude(a) *  st_longitude(a) from test;
select _st_asewkt(a), b from test where b = st_longitude(a);
delete from test where b = st_longitude(a);
drop table test;

###2-14、st_intersects
--error 5054
select st_intersects(point(1,1));
--error 5252
select st_intersects(cast(1.1 as json), point(1,1));
select st_intersects(null, point(1,1));
--error 5252
select st_intersects(point(1,1),cast(1.1 as double));
select st_intersects(point(1,1),null);

select st_intersects(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select st_intersects(point(1,1),point(1,2)) res;
--error 5217
select st_intersects(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 1)', 7037)) res;
select st_intersects(point(1,1), st_geomfromtext('point(1 1 1)'));
select st_intersects(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 1)', 4326)) res;
select st_intersects(st_geomfromtext('pointz(1 1 1)'),st_geomfromtext('pointz(1 1 2)')) res;
select st_intersects(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001)) res;
select st_intersects(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001)) res;
select st_intersects(st_geomfromtext('linestring(1 1, 2 2)', 4326),st_geomfromtext('linestring(1 1, 3 2)', 4326)) res;
select st_intersects(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(3 1 2, 3 2 5)', 2001)) res;
select st_intersects(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 4326),st_geomfromtext('multilinestring((0 0, 1.5 1.5))', 4326)) res;
select st_intersects(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 3 6, 2 2 7),(2 2 4, 3 0 1))')) res;
select st_intersects(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((0 0, -1 1, 0 -1, 0 0))', 2001)) res;
select st_intersects(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001)) res;
select st_intersects(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 4326),st_geomfromtext('polygon((3 3, 3 4, 4 4, 4 3, 3 3))', 4326)) res;
select st_intersects(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1))', 2001)) res;
select st_intersects(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 4326),st_geomfromtext('multipolygon(((3 3, 3 4, 4 4, 4 3, 3 3)))', 4326)) res;
select st_intersects(st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 2001),st_geomfromtext('multipolygonz(((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1)))', 2001)) res;
select st_intersects(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326),st_geomfromtext('geometrycollection(point(10 4))', 4326)) res;
select st_intersects(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(2 4), polygon((0 0, 2 0, 2 2, 0 2, 0 0)))', 2001)) res;
select st_intersects(st_geomfromtext('point(1 1)'), st_geomfromtext('multipoint(1 1, 2 2)')) res;
select st_intersects(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_intersects(st_geomfromtext('point(1.5 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_intersects(st_geomfromtext('point(0 0)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_intersects(st_geomfromtext('point(2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_intersects(st_geomfromtext('point(4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_intersects(st_geomfromtext('point(-1 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_intersects(st_geomfromtext('point(2 3)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_intersects(st_geomfromtext('point(-1 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_intersects(st_geomfromtext('point(0 0)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_intersects(st_geomfromtext('multipoint(1.5 1.5, 3 1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_intersects(st_geomfromtext('multipoint(0 0, -1 -1)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_intersects(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_intersects(st_geomfromtext('multipoint(-2 -2, -3 -3)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_intersects(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_intersects(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_intersects(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_intersects(st_geomfromtext('linestring(3 3, 4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_intersects(st_geomfromtext('linestring(-1 -1, 0 -2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_intersects(st_geomfromtext('linestring(-1 -1, 0 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_intersects(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_intersects(st_geomfromtext('multilinestring((0 1.5, 4 1.5),(0 0, 0 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_intersects(st_geomfromtext('multilinestring((0 1, 0 2),(0 4, 0 5))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_intersects(st_geomfromtext('multilinestring((0 0, 8 8),(0 0, 3 1))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_intersects(st_geomfromtext('multilinestring((0 -1, -2 0),(-2 0, -1 0))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_intersects(st_geomfromtext('multilinestring((0 0, 4 4),(-1 -2, -3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_intersects(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_intersects(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))')) res;
create table test(a geometry, b int, c geometry);
insert into test values(point(0,3), st_intersects(point(0,3), point(0,3)), point(0,3)),(point(0,4), st_intersects(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_intersects(a, c);
select _st_asewkt(a), b from test;
update test set b=st_intersects(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_intersects(a,c) *  st_intersects(a,c) from test;
select _st_asewkt(a), b from test where b = st_intersects(a,c);
delete from test where b = st_intersects(a,c);
drop table test;

###2-15、st_contains
--error 5054
select st_contains(point(1,1));
--error 5252
select st_contains(cast(1.1 as json), point(1,1));
--error 5252
select st_contains(point(1,1),cast(1.1 as double));
select st_contains(point(1,1),null);
select st_contains(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select st_contains(point(1,1),point(1,2)) res;
--error 5217
select st_contains(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 1)', 7037)) res;
select st_contains(point(1,1), st_geomfromtext('point(1 2 1)'));
select st_contains(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select st_contains(st_geomfromtext('pointz(1 1 1)'),st_geomfromtext('pointz(1 1 2)')) res;
select st_contains(st_geomfromtext('multipoint(1 1, 2 2)', 4326),st_geomfromtext('multipoint(1 1, 3 2)', 4326)) res;
select st_contains(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001)) res;
select st_contains(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001)) res;
select st_contains(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('linestring(1 0, 0 1)')) res;
select st_contains(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(1 1 2, 2 2 5)', 2001)) res;
select st_contains(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001)) res;
select st_contains(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),st_geomfromtext('multilinestring((1 3, 2 2),(2 2, 3 0))')) res;
select st_contains(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 1 6, 2 2 7),(2 2 4, 3 1 1))')) res;
select st_contains(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 4326),st_geomfromtext('polygon((1 1, 2 2, 1 3, 1 1))', 4326)) res;
select st_contains(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((0 0, -1 1, 0 -1, 0 0))', 2001)) res;
select st_contains(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001)) res;
select st_contains(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((9 0, 9 1, 10 1, 10 0, 9 0))', 2001)) res;
select st_contains(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((1 1 1, 2 2 2, 2 1 3, 1 1 1))', 2001)) res;
select st_contains(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((4 0, 4 4, 10 4, 10 0, 4 0)))', 2001)) res;
select st_contains(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((9 0, 9 1, 10 1, 10 0, 9 0)))', 2001)) res;
select st_contains(st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 2001),st_geomfromtext('multipolygonz(((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1)))', 2001)) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(10 4), linestring(0 0, 1 2))', 2001)) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(2 4), polygon((0 0, 2 0, 2 2, 0 2, 0 0)))', 2001)) res;
select st_contains(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(1 1, 2 2)')) res;
select st_contains(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_contains(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('point(1.5 1.5)')) res;
select st_contains(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('point(0 0)')) res;
select st_contains(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'), st_geomfromtext('point(2 1.5)')) res;
select st_contains(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('point(1 1)')) res;
select st_contains(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('point(-1 -1)')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('point(2 3)')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('point(-1 -1)')) res;
select st_contains(st_geomfromtext('linestring(1 1, 3 3)'),st_geomfromtext('multipoint(1.5 1.5, 2 2)')) res;
select st_contains(st_geomfromtext('linestring(1 1, 3 3)'),st_geomfromtext('multipoint(0 0, 4 4)')) res;
select st_contains(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),st_geomfromtext('multipoint(0 0, 2 2)')) res;
select st_contains(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),st_geomfromtext('multipoint(1.5 1.5, 3 1)')) res;
select st_contains(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('multipoint(2 1.2, 2 1.5)')) res;
select st_contains(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('multipoint(0 0, -1 -1)')) res;
select st_contains(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('multipoint(1 1, 1 2)')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('multipoint(-1 -1, 2 2)')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('multipoint(-2 -2, -3 -3)')) res;
select st_contains(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),st_geomfromtext('linestring(1 1, 2 2)')) res;
select st_contains(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('linestring(1 1, 2 2)')) res;
select st_contains(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('linestring(0 0, 2 2)')) res;
select st_contains(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('linestring(0 0, 8 8)')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('linestring(0 0, 8 8)')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('linestring(2 3, 0 0)')) res;
select st_contains(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('multilinestring((0 1.5, 4 1.5),(0 0, 0 1))')) res;
select st_contains(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('multilinestring((0 1, 0 2),(0 4, 0 5))')) res;
select st_contains(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('multilinestring((0 0, 8 8),(0 0, 3 1))')) res;
select st_contains(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('multilinestring((0 -1, -2 0),(-2 0, -1 0))')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('multilinestring((0 0, 4 4),(-1 -2, -3 -1))')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))')) res;
select st_contains(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))'),st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))')) res;
create table test(a geometry, b int, c geometry);
insert into test values(point(0,3), st_contains(point(0,3), point(0,3)), point(0,3)),(point(0,4), st_contains(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_contains(a, c);
select _st_asewkt(a), b from test;
update test set b=st_contains(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_contains(a,c) *  st_contains(a,c) from test;
select _st_asewkt(a), b from test where b = st_contains(a,c);
delete from test where b = st_contains(a,c);
drop table test;

###2-16、st_within
--error 5054
select st_within(1,2,3);
--error 5252
select st_within(cast(1.1 as json), point(1,1));
select st_within(null, point(1,1));
--error 5252
select st_within(point(1,1),cast(1.1 as json));
select st_within(point(1,1),null);
select st_within(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select st_within(point(1,1),point(1,2)) res;
--error 5217
select st_within(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 1)', 2001)) res;
select st_within(point(1,1), st_geomfromtext('point(1 1 1)'));
select st_within(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select st_within(st_geomfromtext('pointz(1 1 1)'),st_geomfromtext('pointz(1 1 2)')) res;
select st_within(st_geomfromtext('multipoint(1 1, 2 2)', 4326),st_geomfromtext('multipoint(1 1, 3 2)', 4326)) res;
select st_within(st_geomfromtext('multipoint(1 1, 2 2)'),st_geomfromtext('multipoint(1 1, 2 2)')) res;
select st_within(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001)) res;
select st_within(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001)) res;
select st_within(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001)) res;
select st_within(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 1 6, 2 2 7),(2 2 4, 3 1 1))')) res;
select st_within(st_geomfromtext('polygon((2 2, 2 1, 3 1, 2 2))', 2001),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001)) res;
select st_within(st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001),st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001)) res;
select st_within(st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001)) res;
select st_within(st_geomfromtext('polygonz((1 1 1, 2 2 2, 2 1 3, 1 1 1))', 2001),st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001)) res;
select st_within(st_geomfromtext('multipolygon(((4 0, 4 4, 10 4, 10 0, 4 0)))', 2001),st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001)) res;
select st_within(st_geomfromtext('geometrycollection(point(10 4), linestring(0 0, 1 2))', 2001),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001)) res;
select st_within(st_geomfromtext('geometrycollection(point(2 4), polygon((0 0, 2 0, 2 2, 0 2, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001)) res;
select st_within(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(1 1, 2 2)')) res;
select st_within(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(0 0)')) res;
select st_within(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_within(st_geomfromtext('point(0 0)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_within(st_geomfromtext('point(1.5 1.5)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_within(st_geomfromtext('point(0 0)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_within(st_geomfromtext('point(2 1.5)'),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_within(st_geomfromtext('point(4 4)'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_within(st_geomfromtext('point(-1 -1)'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_within(st_geomfromtext('point(2 3)'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_within(st_geomfromtext('point(-1 -1)'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_within(st_geomfromtext('multipoint(1.5 1.5, 2 2)'),st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_within(st_geomfromtext('multipoint(0 0, 2 2)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_within(st_geomfromtext('multipoint(0 0, 4 4)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_within(st_geomfromtext('multipoint(2 1.2, 2 1.5)'),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_within(st_geomfromtext('multipoint(0 0, -1 -1)'),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_within(st_geomfromtext('multipoint(1 1, 1 2)'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_within(st_geomfromtext('multipoint(-1 -1, 0 -1)'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_within(st_geomfromtext('multipoint(-1 -1, 2 2)'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_within(st_geomfromtext('multipoint(-2 -2, -3 -3)'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_within(st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_within(st_geomfromtext('linestring(1 1, 3 1)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_within(st_geomfromtext('linestring(2 1.5, 2 1.7)'),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_within(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_within(st_geomfromtext('linestring(0 0, 8 8)'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_within(st_geomfromtext('linestring(0 0, 8 8)'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_within(st_geomfromtext('multilinestring((1 1, 2 2),(2 1, 2 2))'),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_within(st_geomfromtext('multilinestring((0 1.5, 4 1.5),(0 0, 0 1))'),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_within(st_geomfromtext('multilinestring((0 -1, -2 0),(-2 0, -1 0))'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_within(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_within(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_within(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))')) res;
create table test(a geometry, b int, c geometry);
insert into test values(point(0,3), st_within(point(0,3), point(0,3)), point(0,3)),(point(0,4), st_within(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_within(a, c);
select _st_asewkt(a), b from test;
update test set b=st_within(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_within(a,c) *  st_within(a,c) from test;
select _st_asewkt(a), b from test where b = st_within(a,c);
delete from test where b = st_within(a,c);
drop table test;

###2-17、st_distance
--error 5054
select st_distance();
--error 5252
select st_distance(cast(1.1 as json), point(1,1));
select st_distance(null, point(1,1));
--error 5252
select st_distance(point(1,1),cast(1.1 as double));
select st_distance(point(1,1),null);
select st_distance(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select st_distance(point(1,1),point(1,1)) res;
--error 5217
select st_distance(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 1)', 7037)) res;
select st_distance(point(1,1), st_geomfromtext('point(1 1 1)'));
select st_distance(st_geomfromtext('point(2 2)', 4326),st_geomfromtext('point(1 1)', 4326)) res;
select st_distance(st_geomfromtext('pointz(1 1 1)'),st_geomfromtext('pointz(1 1 2)')) res;
select st_distance(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))',7037),st_geomfromtext('multilinestringz((1 1 6, 2 2 7),(2 2 4, 3 1 1))',7037)) res;
select st_distance(st_geomfromtext('multipolygon(((9 0, 9 1, 10 1, 10 0, 9 0)))', 2001),st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001)) res;
select st_distance(st_geomfromtext('multipolygonz(((34 30 1, 34 34 2, 30 34 3, 30 30 4, 34 30 1)))', 7037),st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 7037)) res;
select st_distance(st_geomfromtext('geometrycollection(point(10 4))', 4326), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326)) res;
select st_distance(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(2 2, 2 2)')) res;
select st_distance(st_geomfromtext('point(0 0)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_distance(st_geomfromtext('point(-1 -1)',2001),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))',2001)) res;
select st_distance(st_geomfromtext('point(-1 -1)',4326),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326)) res;
select st_distance(st_geomfromtext('multipoint(0 0, 4 4)',2001),st_geomfromtext('linestring(1 1, 3 3)',2001)) res;
select st_distance(st_geomfromtext('multipoint(0 0, 4 4)',2001),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))',2001)) res;
select st_distance(st_geomfromtext('multipoint(-1 -1, 0 -1)',2001),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))',2001)) res;
select st_distance(st_geomfromtext('multipoint(-2 -2, -3 -3)',4326),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326)) res;
select st_distance(st_geomfromtext('linestring(11 11, 13 11)',2001),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))',2001)) res;
select st_distance(st_geomfromtext('linestring(12 11, 12 14)',2001),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))',2001)) res;
select st_distance(st_geomfromtext('linestring(-1 -1, -8 -8)',2001),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))',2001)) res;
select st_distance(st_geomfromtext('linestring(12 13, 30 30)',2001),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',2001)) res;
select st_distance(st_geomfromtext('multilinestring((11 11, 12 12),(3 3, 4 4))',2001),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))',2001)) res;
select st_distance(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_distance(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_distance(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))',4326),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))',4326)) res;
--error 5252
select st_distance(point(1,2),point(1,1),1);
select st_distance(point(1,2),point(1,1),null);
--error 16
select st_distance(point(1,2),point(1,1),'British chain (Benoit 1895 A)');
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'British yard (Sears 1922)') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'centimetre') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'chain') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'Clarke\'s chain') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'fathom') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'foot') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'German legal metre') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'Gold Coast foot') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'Indian foot') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'kilometre') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'link') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'metre') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'nautical mile') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'millimetre') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'Statute mile') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'US survey link') res;
select st_distance(st_geomfromtext('point(1 2)',2001),st_geomfromtext('point(1 1)',2001),'yard') res;
create table test(a geometry, b double, c geometry);
insert into test values(point(0,3), st_distance(point(0,3), point(0,3)), point(0,3)),(point(0,4), st_distance(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_distance(a, c);
select _st_asewkt(a), b from test;
update test set b=st_distance(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_distance(a,c) *  st_distance(a,c) from test;
select _st_asewkt(a), b from test where b = st_distance(a,c);
delete from test where b = st_distance(a,c);
drop table test;

###2-18、st_distance_sphere
--error 5054
select st_distance_sphere(1,2,3,4);
--error 5252
select st_distance_sphere(cast(1.1 as json), point(1,1));
select st_distance_sphere(null, point(1,1));
--error 5252
select st_distance_sphere(point(1,1),cast(1.1 as double));
select st_distance_sphere(point(1,1),null);
select st_distance_sphere(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select st_distance_sphere(point(1,1),point(1,1)) res;
--error 16
select st_distance_sphere(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(2 1)', 2001)) res;
select st_distance_sphere(point(1,1), st_geomfromtext('point(1 2 1)'));
select st_distance_sphere(st_geomfromtext('point(2 2)', 4326),st_geomfromtext('point(1 1)', 4326)) res;
select st_distance_sphere(st_geomfromtext('pointz(1 1 1)'),st_geomfromtext('pointz(1 1 2)')) res;
select st_distance_sphere(st_geomfromtext('multipoint(1 1, 2 2)', 4326),st_geomfromtext('multipoint(3 1, 3 2)', 4326)) res;
select st_distance_sphere(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 7037),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 7037)) res;
--error 7
select st_distance_sphere(st_geomfromtext('geometrycollection(point(10 4))', 4326), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326)) res;
--error 7
select st_distance_sphere(st_geomfromtext('multipolygon(((23 23, 23 24, 24 24, 24 23, 23 23)))', 4326),st_geomfromtext('geometrycollection(point(10 4))', 4326)) res;
select st_distance_sphere(st_geomfromtext('point(1 6)',4326), st_geomfromtext('multipoint(1 1, 2 2)',4326)) res;
select st_distance_sphere(point(1,2),point(1,1),1);
select st_distance_sphere(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 2)', 4326),10086);
--error 7
select st_distance_sphere(point(1,2),point(1,1),-1);
create table test(a geometry, b double, c geometry);
insert into test values(point(0,3), st_distance_sphere(point(0,3), point(0,3)), point(0,3)),(point(0,4), st_distance_sphere(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_distance_sphere(a, c);
select _st_asewkt(a), b from test;
update test set b=st_distance_sphere(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_distance_sphere(a,c) *  st_distance_sphere(a,c) from test;
select _st_asewkt(a), b from test where b = st_distance_sphere(a,c);
delete from test where b = st_distance_sphere(a,c);
drop table test;

###2-19、point
--error 5054
select point(1);
select hex(point(1,null));
select hex(point(1,1.234));
select hex(point(1,'3.1415'));
select hex(point(null,1));
select hex(point(1.234,1));
select hex(point('3.1415',1));
select hex(point('aaaaa',1));
select hex(point(cast(1 as json),1));
select hex(point(1,1));
select hex(point(-1,1));
select hex(point(-181,1));
select hex(point(200.321,1));
select hex(point(-177.09,-1222));
create table test(a geometry, b double, c geometry);
insert into test values(point(0,3), 1.4, point(0,3)),(point(0,4), 7.9, point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=-1.4 where a = point(0,3);
select _st_asewkt(a), b from test;
update test set a=point(b,b);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select hex(point(b,b)) from test;
select _st_asewkt(a), b from test where a = point(-1.4,-1.4);
delete from test where a = point(-1.4,-1.4);
drop table test;

###2-20、linestring
--error 2
select hex(linestring(1));
--error 2
select hex(linestring(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
select hex(linestring(point(1,1), point(2,1)));
--error 2
select hex(linestring(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('geometrycollection(point(-2 -3), linestring(-1 -2, -2 -3), polygon((0 0, -4 0, -4 -4, 0 -4, 0 0)))')));
select hex(linestring(point(1,1), point(2,1),point(2,2),point(1,2)));
--error 2
select hex(linestring(st_geomfromtext('polygon((1 1, 2 2, 3 10, 1 1))'),st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('linestring(1 1, 2 2)'),point(3,2)));
create table test(a geometry, b point, c geometry);
insert into test values(linestring(point(1,1),point(2,2)), point(1,1), linestring(point(1,1),point(2,2))),(linestring(point(2,2),point(3,3)), point(2,2), linestring(point(2,2),point(3,3)));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=point(100,100) where a = linestring(point(1,1),point(2,2));
select _st_asewkt(a), _st_asewkt(b) from test;
update test set a=linestring(point(10,10),point(20,20));
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select hex(linestring(b,b,b)) from test;
select _st_asewkt(a), _st_asewkt(b) from test where a = linestring(point(10,10),point(20,20));
delete from test where a = linestring(point(10,10),point(20,20));
drop table test;

###2-21、multipoint
--error 2
select hex(multipoint(cast(1 as json)));
select hex(multipoint(point(1,1)));
--error 2
select hex(multipoint(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
select hex(multipoint(point(1,1), point(2,1)));
--error 2
select hex(multipoint(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('geometrycollection(point(-2 -3), linestring(-1 -2, -2 -3), polygon((0 0, -4 0, -4 -4, 0 -4, 0 0)))')));
select hex(multipoint(point(1,1), point(2,1),point(2,2),point(1,2)));
create table test(a geometry, b point, c geometry);
insert into test values(multipoint(point(1,1),point(2,2)), point(1,1), multipoint(point(1,1),point(2,2))),(multipoint(point(2,2),point(3,3)), point(2,2), multipoint(point(2,2),point(3,3)));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=point(100,100) where a = multipoint(point(1,1),point(2,2));
select _st_asewkt(a), _st_asewkt(b) from test;
update test set a=multipoint(point(10,10),point(20,20));
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select hex(multipoint(b,b,b)) from test;
select _st_asewkt(a), _st_asewkt(b) from test where a = multipoint(point(10,10),point(20,20));
delete from test where a = multipoint(point(10,10),point(20,20));
drop table test;

###2-22、multilinestring
--error 2
select hex(multilinestring(cast(1 as json)));
select hex(multilinestring(st_geomfromtext('linestring(1 1, 2 2)')));
--error 2
select hex(multilinestring(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
select hex(multilinestring(st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('linestring(1 1, 0 1)')));
select hex(multilinestring(st_geomfromtext('linestring(1 2, 2 3)'),st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('linestring(2 1, 3 2)'),st_geomfromtext('linestring(11 1, 21 2)')));
--error 2
select hex(multilinestring(st_geomfromtext('polygon((1 1, 2 2, 3 10, 1 1))'),st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('linestring(1 1, 2 2)'),point(3,2)));
create table test(a geometry, b linestring, c geometry);
insert into test values(multilinestring(linestring(point(2,2),point(3,3)),linestring(point(2,2),point(2,3))), linestring(point(2,2),point(3,3)), multilinestring(linestring(point(2,2),point(3,3)),linestring(point(2,2),point(2,3)))),(multilinestring(linestring(point(4,4),point(3,3)),linestring(point(4,4),point(2,3))), linestring(point(4,4),point(3,3)), multilinestring(linestring(point(5,5),point(3,3)),linestring(point(5,5),point(2,3))));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=linestring(point(20,2),point(6,3)) where a = multilinestring(linestring(point(2,2),point(3,3)),linestring(point(2,2),point(2,3)));
select _st_asewkt(a), _st_asewkt(b) from test;
update test set a=multilinestring(linestring(point(20,20),point(30,30)),linestring(point(21,21),point(21,31)));
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select hex(multilinestring(b,b,b)) from test;
select _st_asewkt(a), _st_asewkt(b) from test where a = multilinestring(linestring(point(20,20),point(30,30)),linestring(point(21,21),point(21,31)));
delete from test where a = multilinestring(linestring(point(20,20),point(30,30)),linestring(point(21,21),point(21,31)));
drop table test;

###2-23、polygon
--error 2
select hex(polygon(null));
--error 2
select hex(polygon(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
--error 2
select hex(polygon(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('geometrycollection(point(-2 -3), linestring(-1 -2, -2 -3), polygon((0 0, -4 0, -4 -4, 0 -4, 0 0)))')));
--error 5252
select hex(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 3)')));
select hex(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)')));
select hex(polygon(st_geomfromtext('linestring(0 0, 0 10, 10 10, 10 0, 0 0)'),st_geomfromtext('linestring(3 3, 5 3, 5 5, 3 5, 3 3)')));
--error 2
select hex(polygon(st_geomfromtext('polygon((1 1, 2 2, 3 10, 1 1))'),st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('linestring(1 1, 2 2)'),point(3,2)));
create table test(a geometry, b linestring, c geometry);
insert into test values(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)')), st_geomfromtext('linestring(3 3, 5 3, 5 5, 3 5, 3 3)'), polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)'))),(polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)')), st_geomfromtext('linestring(-3 -3, -5 -3, -5 -5, -3 -5, -3 -3)'), polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)')));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=st_geomfromtext('linestring(3 3, 5 3, 5 5, 3 5, 3 3)') where a = polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)'));
select _st_asewkt(a), _st_asewkt(b) from test;
update test set a=polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)'));
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select hex(polygon(b,b,b)) from test;
select _st_asewkt(a), _st_asewkt(b) from test where a = polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)'));
delete from test where a = polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)'));
drop table test;

###2-24、multipolygon
--error 2
select hex(multipolygon('aaaaa'));
select hex(multipolygon(st_geomfromtext('polygon((1 1, 2 2, 3 10, 1 1))')));
select hex(multipolygon(st_geomfromtext('polygon((1 1, 2 2, 3 10, 1 1))'),st_geomfromtext('polygon((-1 -1, -2 -2, -3 -10, -1 -1))')));
create table test(a geometry, b polygon, c geometry);
insert into test values(multipolygon(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)'))), polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)')), multipolygon(polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)')))),(multipolygon(polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)'))), polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)')), multipolygon(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)'))));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=polygon(st_geomfromtext('linestring(-1 -1, -2 -2, -3 -1, -1 -1)')) where a = multipolygon(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)')));
select _st_asewkt(a), _st_asewkt(b) from test;
update test set a=multipolygon(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)')));
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select hex(multipolygon(b,b,b)) from test;
select _st_asewkt(a), _st_asewkt(b) from test where a = multipolygon(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)')));
delete from test where a = multipolygon(polygon(st_geomfromtext('linestring(1 1, 2 2, 3 1, 1 1)')));
drop table test;

###2-25、geomcollection
select geometrycollection();
--error 2
select hex(geometrycollection(cast(1 as json)));
select hex(geometrycollection(point(1,1)));
select hex(geometrycollection(st_geomfromtext('linestring(1 1, 2 2)')));
select hex(geometrycollection(st_geomfromtext('multilinestring((1 1, 2 2))')));
select hex(geometrycollection(st_geomfromtext('multipolygon(((1 1, 2 2, 3 13, 1 1)))')));
select hex(geometrycollection(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
select hex(geometrycollection(st_geomfromtext('multipoint(1 1, 2 2)'),st_geomfromtext('multipoint(3 3, 2 2)')));
select hex(geometrycollection(st_geomfromtext('polygon((1 1, 2 2, 3 10, 1 1))'),st_geomfromtext('polygon((-1 -1, -2 -2, -3 -10, -1 -1))')));
select hex(geometrycollection(st_geomfromtext('multipolygon(((1 1, 2 2, 3 13, 1 1)))'),st_geomfromtext('multipolygon(((-1 -1, -2 -2, -3 -13, -1 -1)))')));
select hex(geometrycollection(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('geometrycollection(point(-2 -3), linestring(-1 -2, -2 -3), polygon((0 0, -4 0, -4 -4, 0 -4, 0 0)))')));
select hex(geometrycollection(st_geomfromtext('polygon((1 1, 2 2, 3 10, 1 1))'),st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('linestring(1 1, 2 2)'),point(3,2)));
select hex(geometrycollection(st_geomfromtext('linestring(1 2, 2 3)'),st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('linestring(2 1, 3 2)'),st_geomfromtext('linestring(11 1, 21 2)')));
select hex(geometrycollection(st_geomfromtext('polygon((1 1, 2 2, 3 10, 1 1))'),st_geomfromtext('linestring(1 1, 2 2)'),st_geomfromtext('linestring(1 1, 2 2)'),point(3,2)));

###2-26、_st_covers
--error 5054
select _st_covers(point(1,1));
select _st_covers(null, point(1,1));
--error 5252
select _st_covers(point(1,1),1);
select _st_covers(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select _st_covers(point(1,1),point(1,1)) res;
--error 5217
select _st_covers(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 1)', 2001)) res;
select _st_covers(point(1,1), st_geomfromtext('point(1 2 1)'));
select _st_covers(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select _st_covers(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select _st_covers(st_geomfromtext('multipoint(1 1, 2 2)', 4326),st_geomfromtext('multipoint(1 1, 3 2)', 4326)) res;
select _st_covers(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001)) res;
select _st_covers(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001)) res;
select _st_covers(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(1 1 2, 2 2 5)', 2001)) res;
select _st_covers(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001)) res;
select _st_covers(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 1 6, 2 2 7),(2 2 4, 3 1 1))')) res;
select _st_covers(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((2 2, 2 1, 3 1, 2 2))', 2001)) res;
select _st_covers(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001)) res;
select _st_covers(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001)) res;
select _st_covers(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((1 1 1, 2 2 2, 2 1 3, 1 1 1))', 2001)) res;
select _st_covers(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 4326),st_geomfromtext('multipolygon(((3 3, 3 4, 4 4, 4 3, 3 3)))', 4326)) res;
select _st_covers(st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 2001),st_geomfromtext('multipolygonz(((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1)))', 2001)) res;
select _st_covers(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(2 4), polygon((0 0, 2 0, 2 2, 0 2, 0 0)))', 2001)) res;
select _st_covers(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(1 1, 2 2)')) res;
select _st_covers(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(0 0)')) res;
select _st_covers(st_geomfromtext('linestring(1 1, 3 3)'),st_geomfromtext('point(2 2)')) res;
select _st_covers(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('point(2 2)')) res;
select _st_covers(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'), st_geomfromtext('point(2 2)')) res;
select _st_covers(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'), st_geomfromtext('point(0 0)')) res;
select _st_covers(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('point(-1 -1)')) res;
select _st_covers(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('point(-1 -1)')) res;
select _st_covers(st_geomfromtext('linestring(1 1, 3 3)'),st_geomfromtext('multipoint(0 0, 4 4)')) res;
select _st_covers(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),st_geomfromtext('multipoint(1.5 1.5, 3 1)')) res;
select _st_covers(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('multipoint(2 1.2, 2 1.5)')) res;
select _st_covers(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('multipoint(-1 -1, 0 -1)')) res;
select _st_covers(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('multipoint(-1 -1, 2 2)')) res;
select _st_covers(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),st_geomfromtext('linestring(1 1, 2 2)')) res;
select _st_covers(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('linestring(2 1.5, 2 1.7)')) res;
select _st_covers(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('linestring(3 3, 4 4)')) res;
select _st_covers(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('linestring(0 0, 8 8)')) res;
select _st_covers(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('multilinestring((0 1.5, 4 1.5),(0 0, 0 1))')) res;
select _st_covers(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),st_geomfromtext('multilinestring((0 0, 8 8),(0 0, 3 1))')) res;
select _st_covers(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),st_geomfromtext('multilinestring((0 0, 4 4),(-1 -2, -3 -1))')) res;
select _st_covers(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))'),st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))')) res;
create table test(a geometry, b int, c geometry);
insert into test values(point(0,3), _st_covers(point(0,3), point(0,3)), point(0,3)),(point(0,4), _st_covers(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = _st_covers(a, c);
select _st_asewkt(a), b from test;
update test set b=_st_covers(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select _st_covers(a,c) *  _st_covers(a,c) from test;
select _st_asewkt(a), b from test where b = _st_covers(a,c);
delete from test where b = _st_covers(a,c);
drop table test;

###2-27、_st_geomfromewkb
--error 5054
select _st_geomfromewkb(1,2,3,4);
select _st_geomfromewkb(null);
--error 5252
select _st_geomfromewkb(x'0101010101');
select st_aswkt(_st_geomfromewkb(x'0101000080000000000000F03F00000000000000400000000000000840')) res;
select st_aswkt(_st_geomfromewkb(x'01040000800200000001E9030000000000000000F03F0000000000000040000000000000104001E9030000000000000000004000000000000008400000000000001440')) res;
select st_aswkt(_st_geomfromewkb(x'010200008002000000000000000000F03F00000000000000400000000000000840000000000000004000000000000008400000000000001040')) res;
select st_aswkt(_st_geomfromewkb(x'01050000800200000001EA03000002000000000000000000F03F0000000000000040000000000000084000000000000000400000000000000840000000000000104001EA03000002000000000000000000084000000000000010400000000000001440000000000000144000000000000018400000000000001840')) res;
select st_aswkt(_st_geomfromewkb(x'0103000080010000000500000000000000000000000000000000000000000000000000F03F00000000000010400000000000000000000000000000F03F00000000000010400000000000001040000000000000F03F00000000000000000000000000001040000000000000F03F00000000000000000000000000000000000000000000F03F')) res;
select st_aswkt(_st_geomfromewkb(x'0103000080020000000500000000000000000000000000000000000000000000000000F03F00000000000010400000000000000000000000000000F03F00000000000010400000000000001040000000000000F03F00000000000000000000000000001040000000000000F03F00000000000000000000000000000000000000000000F03F05000000000000000000F03F000000000000F03F000000000000F03F0000000000000040000000000000F03F000000000000F03F00000000000000400000000000000040000000000000F03F000000000000F03F0000000000000040000000000000F03F000000000000F03F000000000000F03F000000000000F03F')) res;
select st_aswkt(_st_geomfromewkb(x'01060000800200000001EB030000010000000500000000000000000000000000000000000000000000000000F03F00000000000010400000000000000000000000000000F03F00000000000010400000000000001040000000000000F03F00000000000000000000000000001040000000000000F03F00000000000000000000000000000000000000000000F03F01EB0300000100000005000000000000000000F03F000000000000F03F000000000000F03F0000000000000040000000000000F03F000000000000F03F00000000000000400000000000000040000000000000F03F000000000000F03F0000000000000040000000000000F03F000000000000F03F000000000000F03F000000000000F03F')) res;
select st_aswkt(_st_geomfromewkb(x'01070000800300000001E903000000000000000000400000000000000840000000000000084001EA03000002000000000000000000F03F0000000000000040000000000000004000000000000000400000000000000840000000000000104001EB0300000100000005000000000000000000000000000000000000000000000000001040000000000000104000000000000000000000000000001040000000000000104000000000000010400000000000001040000000000000000000000000000010400000000000001040000000000000000000000000000000000000000000001040')) res;
--error 5252
select st_aswkt(_st_geomfromewkb(x'0101000020E610000000000000000008400000000000000040', cast(1 as json))) res;
--error 16
select _st_asewkt(_st_geomfromewkb(x'0101000020E610000000000000000008400000000000000040', 'axis-order=dududu')) res;
select _st_asewkt(_st_geomfromewkb(x'0101000020D107000000000000000000400000000000000840', 'axis-order=long-lat')) res;
select _st_asewkt(_st_geomfromewkb(x'0101000020E610000000000000000008400000000000000040', 'axis-order=lat-long')) res;
select _st_asewkt(_st_geomfromewkb(x'0101000020E610000000000000000008400000000000000040', 'axis-order=srid-defined')) res;
select _st_asewkt(_st_geomfromewkb(x'01010000207D1B000000000000000000400000000000000840','axis-order=srid-defined')) res;
--error 5215
select _st_asewkt(_st_geomfromewkb(x'0101000020E610000000000000000008400000000000A06640', 'axis-order=lat-long')) res;
--error 5216
select _st_asewkt(_st_geomfromewkb(x'0101000020E610000000000000000008400000000000A06640','axis-order=long-lat')) res;
select _st_asewkt(_st_geomfromewkb(x'0107000020E6100000030000000101000000000000000000084000000000000000400102000000020000000000000000000040000000000000F03F00000000000008400000000000000040010300000001000000050000000000000000000000000000000000000000000000000000000000000000001040000000000000104000000000000010400000000000001040000000000000000000000000000000000000000000000000', 'axis-order=long-lat')) res;
truncate table geo;
insert into geo values(_st_geomfromewkb(x'0101000000000000000000F03F000000000000F03F')),(_st_geomfromewkb(x'010100000000000000000000400000000000000040'));
select _st_asewkt(b) from geo;
update geo set b=null where b=_st_geomfromewkb(x'010100000000000000000000400000000000000040');
select _st_asewkt(b) from geo;
update geo set b=_st_geomfromewkb(x'0101000000000000000000F03F000000000000F03F');
select _st_asewkt(b) from geo;
update geo set b=_st_geomfromewkb(x'010100000000000000000000400000000000000040') where b=_st_geomfromewkb(x'0101000000000000000000F03F000000000000F03F');
select _st_asewkt(b) from geo;
truncate table geo;
insert into geo values(_st_geomfromewkb(x'0101000000000000000000F03F000000000000F03F')),(_st_geomfromewkb(x'010100000000000000000000400000000000000040'));
select _st_asewkt(b) from geo where b=_st_geomfromewkb(x'0101000000000000000000F03F000000000000F03F');
delete from geo where b=_st_geomfromewkb(x'0101000000000000000000F03F000000000000F03F');
select * from geo;

###2-28、_st_geomfromewkt
--error 5054
select _st_geomfromewkt(1,2);
--error 5252
select _st_geomfromewkt(cast(1.1 as json));
select _st_geomfromewkt(null);
--error 5252
select _st_geomfromewkt('point(1,1)');
select hex(_st_geomfromewkt('pointz(1 2 3)')) res;
select hex(_st_geomfromewkt('srid=4326;point(1 2)')) res;
select hex(_st_geomfromewkt('multipoint(1 2, 2 3)')) res;
select hex(_st_geomfromewkt('srid=0;multipointz(1 2 4, 2 3 5)')) res;
select hex(_st_geomfromewkt('srid=7037;linestring(1 2, 2 3)')) res;
select hex(_st_geomfromewkt('multilinestring((1 2, 2 3),(3 4, 5 6))')) res;
select hex(_st_geomfromewkt('srid=4326;multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))')) res;
select hex(_st_geomfromewkt('srid=2001;polygon((0 0, 4 0, 4 4, 0 4, 0 0))')) res;
select hex(_st_geomfromewkt('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')) res;
select hex(_st_geomfromewkt('srid=4326;polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))')) res;
select hex(_st_geomfromewkt('srid=0;multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))')) res;
select hex(_st_geomfromewkt('srid=4326;geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))')) res;
--error 5238
select hex(_st_geomfromewkt('srid=3;point(2 3)'));
--error 5216
select hex(_st_geomfromewkt('srid=4326;point(1 -91)'));
truncate table geo;
insert into geo values(_st_geomfromewkt('point(1 1)')),(_st_geomfromewkt('point(2 2)'));
select _st_asewkt(b) from geo;
update geo set b=null where b=_st_geomfromewkt('point(2 2)');
select _st_asewkt(b) from geo;
update geo set b=_st_geomfromewkt('point(1 1)');
select _st_asewkt(b) from geo;
update geo set b=_st_geomfromewkt('point(2 2)') where b=_st_geomfromewkt('point(1 1)');
select _st_asewkt(b) from geo;
truncate table geo;
insert into geo values(_st_geomfromewkt('point(1 1)')),(_st_geomfromewkt('point(2 2)'));
select _st_asewkt(b) from geo where b=_st_geomfromewkt('point(1 1)');
select b,_st_asewkt(b) from geo having b=_st_geomfromewkt('point(1 1)');
delete from geo where b=_st_geomfromewkt('point(1 1)');
select * from geo;

###2-29、_st_asewkt
--error 5054
select _st_asewkt(1,2,3);
--error 5243
select _st_asewkt(cast(1.1 as json));
select _st_asewkt(null);
select _st_asewkt(x'000000000101000000000000000000F03F000000000000F03F');
select _st_asewkt(st_geomfromtext('pointz(1 2 3)',4326));
select _st_asewkt(st_geomfromtext('multipointz(1 2 4, 2 3 5)',2001));
select _st_asewkt(st_geomfromtext('linestringz(1 2 3, 2 3 4)',0));
select _st_asewkt(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))',7037));
select _st_asewkt(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))',2001));
select _st_asewkt(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'));
select _st_asewkt(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'));
select _st_asewkt(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))',4326));
create table test__st_asewkt(b varchar(1024));
insert into test__st_asewkt values(_st_asewkt(st_geomfromtext('point(1 1)'))),(_st_asewkt(st_geomfromtext('point(2 2)')));
select * from test__st_asewkt;
update test__st_asewkt set b=null where b=_st_asewkt(st_geomfromtext('point(2 2)'));
select * from test__st_asewkt;
update test__st_asewkt set b=_st_asewkt(st_geomfromtext('point(1 1)'));
select * from test__st_asewkt;
update test__st_asewkt set b=_st_asewkt(st_geomfromtext('point(2 2)')) where b=_st_asewkt(st_geomfromtext('point(1 1)'));
select * from test__st_asewkt;
truncate table test__st_asewkt;
insert into test__st_asewkt values('point(1 1)'),('point(2 2)');
select * from test__st_asewkt where b=_st_asewkt(st_geomfromtext('point(1 1)'));
select b from test__st_asewkt having b=_st_asewkt(st_geomfromtext('point(1 1)'));
delete from test__st_asewkt where b=_st_asewkt(st_geomfromtext('point(1 1)'));
select * from test__st_asewkt;

###2-30、_st_point
--error 5054
select _st_point(1,2,3,4);
select hex(_st_point(1,1));
--error 2
select hex(_st_point(1,cast(1 as json)));
select hex(_st_point(null,1));
select hex(_st_point(-177.09,-1222));
--error 5238
select hex(_st_point(1,1,1));
select hex(_st_point(1,1,'aaaaa'));
select hex(_st_point(1,2,4326));
--error 5215
select hex(_st_point(181,2,4326));
create table test(a geometry, b double, c geometry);
insert into test values(_st_point(0,3), 1.4, _st_point(0,3)),(_st_point(0,4), 7.9, _st_point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=-1.4 where a = _st_point(0,3);
select _st_asewkt(a), b from test;
update test set a=_st_point(b,b);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select hex(_st_point(b,b)) from test;
select _st_asewkt(a), b from test where a = _st_point(-1.4,-1.4);
delete from test where a = _st_point(-1.4,-1.4);
drop table test;

###2-31、_st_geogfromtext/_st_geographyfromtext
--error 5054
select _st_geogfromtext(1,2);
--error 5252
select _st_geogfromtext(cast(1.1 as double));
select _st_geogfromtext(null);
--error 5252
select _st_geogfromtext('point(1,1)');
select _st_asewkt(_st_geogfromtext('pointz(1 2 3)')) res;
select _st_asewkt(_st_geogfromtext('srid=4326;point(1 2)')) res;
select _st_asewkt(_st_geogfromtext('srid=4326;multipoint(1 2, 2 3)')) res;
select _st_asewkt(_st_geogfromtext('srid=0;multipointz(1 2 4, 2 3 5)')) res;
select _st_asewkt(_st_geogfromtext('linestring(1 2, 2 3)')) res;
select _st_asewkt(_st_geogfromtext('srid=7037;linestring(1 2, 2 3)')) res;
select _st_asewkt(_st_geogfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))')) res;
select _st_asewkt(_st_geogfromtext('srid=4326;multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))')) res;
select _st_asewkt(_st_geogfromtext('srid=7037;polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))')) res;
select _st_asewkt(_st_geogfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')) res;
select _st_asewkt(_st_geogfromtext('srid=4326;polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))')) res;
select _st_asewkt(_st_geogfromtext('srid=0;multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))')) res;
select _st_asewkt(_st_geogfromtext('srid=4326;geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))')) res;
select _st_asewkt(_st_geogfromtext('point(1 91)'));
select _st_asewkt(_st_geogfromtext('point(-181 -1)'));
truncate table geo;
insert into geo values(_st_geogfromtext('point(1 1)')),(_st_geogfromtext('point(2 2)'));
select _st_asewkt(b) from geo;
update geo set b=null where b=_st_geogfromtext('point(2 2)');
select _st_asewkt(b) from geo;
update geo set b=_st_geogfromtext('point(1 1)');
select _st_asewkt(b) from geo;
update geo set b=_st_geogfromtext('point(2 2)') where b=_st_geogfromtext('point(1 1)');
select _st_asewkt(b) from geo;
truncate table geo;
insert into geo values(_st_geogfromtext('point(1 1)')),(_st_geogfromtext('point(2 2)'));
select _st_asewkt(b) from geo where b=_st_geogfromtext('point(1 1)');
select b,_st_asewkt(b) from geo having b=_st_geogfromtext('point(1 1)');
delete from geo where b=_st_geogfromtext('point(1 1)');
select * from geo;

###2-32、_st_buffer
--error 5054
select _st_buffer(point(1,1), 1,1,1);
--error 5252
select _st_buffer(1, 1.1);
select _st_buffer(null, 1.1);
select st_astext(_st_buffer(x'000000000101000000000000000000F03F000000000000F03F', 1.1));
select st_astext(_st_buffer(st_geomfromtext('pointz(1 2 3)'), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('point(1 2)', 4326), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipointz(1 2 4, 2 3 5)'), 1)) as res;
--error 2
select st_astext(_st_buffer(st_geomfromtext('multipoint(1 2, 2 3)'), -1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipoint(1 2, 2 3)', 2001), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('linestring(1 2, 2 3)', 4326), 1)) as res;
--error 2
select st_astext(_st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), -1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))', 2001), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))'), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), -1)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))', 4326), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))'), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), -1)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))', 4326), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))'), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), -1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))', 4326), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'), 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), -1)) as res;
select st_astext(_st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326), 1)) as res;
select st_astext(_st_buffer(point(0, 0), 1));
--error 5252
select st_astext(_st_buffer(point(0, 0), '8'));
select st_astext(_st_buffer(point(0, 0), cast(2 as double)));
--error 2
select st_astext(_st_buffer(point(0, 0), 1, cast(1 as double)));
select st_astext(_st_buffer(point(0, 0), 1, null));
select st_astext(_st_buffer(st_geomfromtext('point(1 2)', 4326), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('point(1 2)'), 1, -1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipoint(1 2, 2 3)'), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipoint(1 2, 2 3)', 4326), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipointz(1 2 2, 2 3 3)'), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), 1, -1)) as res;
select st_astext(_st_buffer(st_geomfromtext('linestringz(1 2 3, 2 3 4)'), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1, 0)) as res;
select st_astext(_st_buffer(st_geomfromtext('multilinestringz((1 2 2, 2 3 2),(3 4 3, 5 6 3))'), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), 1, 0)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 2, 2 1 2, 2 2 2, 1 2 2, 1 1 1))'), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',4326), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), 1, 0)) as res;
select st_astext(_st_buffer(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 1, 2 3 4), polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)))'), 1, 1)) as res;
select st_astext(_st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326), 1, 2)) as res;
select st_astext(_st_buffer(st_geomfromtext('point(1 2)', 4326), 1, 'endcap=flat join=round')) as res;
select st_astext(_st_buffer(st_geomfromtext('point(1 2)'), 1, 'endcap=butt mitre_limit=5.0')) as res;
select st_astext(_st_buffer(st_geomfromtext('pointz(1 2 3)'), 1, 'quad_segs=1 endcap=round join=round mitre_limit=1.2')) as res;
select st_astext(_st_buffer(st_geomfromtext('multipointz(1 2 2, 2 3 3)'), 1, 'quad_segs=1 endcap=round join=round mitre_limit=1.2')) as res;
select st_astext(_st_buffer(st_geomfromtext('multipoint(1 2, 2 3)'), 1, 'endcap=butt mitre_limit=5.0')) as res;
select st_astext(_st_buffer(st_geomfromtext('linestring(1 2, 2 3)'), 1, 'quad_segs=4 join=mitre')) as res;
select st_astext(_st_buffer(st_geomfromtext('linestring(1 2 3, 2 3 4)'), 1, 'quad_segs=1 endcap=round join=round mitre_limit=1.2')) as res;
select st_astext(_st_buffer(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'), 1, 'join=miter mitre_limit=4.0')) as res;
select st_astext(_st_buffer(st_geomfromtext('multilinestringz((1 2 2, 2 3 2),(3 4 3, 5 6 3))'), 1, 'quad_segs=1 endcap=round join=round mitre_limit=1.2')) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), 1, 'join=miter mitre_limit=4.0')) as res;
select st_astext(_st_buffer(st_geomfromtext('polygonz((0 0 1, 4 0 2, 4 4 3, 0 4 4, 0 0 5))'), 1, 'quad_segs=1 endcap=round join=round mitre_limit=1.2')) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), 1, 'quad_segs=4 join=mitre')) as res;
select st_astext(_st_buffer(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 2, 2 1 2, 2 2 2, 1 2 2, 1 1 1))'), 1, 'quad_segs=1 endcap=round join=round mitre_limit=1.2')) as res;
select st_astext(_st_buffer(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',4326), 1, 'endcap=flat join=round')) as res;
select st_astext(_st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'), 1, 'join=miter mitre_limit=4.0')) as res;
select st_astext(_st_buffer(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 2, 0 0 1)), ((1 1 1, 2 1 2, 2 2 3, 1 2 2, 1 1 5)))'), 1, 'quad_segs=1 endcap=round join=round mitre_limit=1.2')) as res;
select st_astext(_st_buffer(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))',4326), 1, 'endcap=flat join=round side=both')) as res;
select st_astext(_st_buffer(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 1, 2 3 4), polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)))'), 1, 'endcap=butt mitre_limit=5.0')) as res;
select st_astext(_st_buffer(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326), 1, 'endcap=flat join=round side=both')) as res;
create table test(b geometry);
insert into test values(_st_buffer(point(1, 1), 2)),(_st_buffer(point(0, 0), 1));
select hex(b) from test;
update test set b= point(2,2) where b=_st_buffer(point(0, 0), 1);
select hex(b) from test;
update test set b=_st_buffer(point(2, 3), 1);
select hex(b) from test;
select hex(_st_buffer(b, 1)) from test limit 1;
select hex(b) from test where b = _st_buffer(point(2, 3), 1);
delete from test where b=_st_buffer(point(2, 3), 1);
select hex(b) from test;
drop table test;

###2-33、_st_asewkb
--error 5054
select _st_asewkb(1,2);
--error 5243
select _st_asewkb(cast(1.1 as json));
select _st_asewkb(null);
select hex(_st_asewkb(x'000000000101000000000000000000F03F000000000000F03F'));
select hex(_st_asewkb(st_geomfromtext('point(1 2)')));
select hex(_st_asewkb(st_geomfromtext('multipointz(1 2 4, 2 3 5)')));
select hex(_st_asewkb(st_geomfromtext('linestring(1 2, 2 3)')));
select hex(_st_asewkb(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))')));
select hex(_st_asewkb(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))')));
select hex(_st_asewkb(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select hex(_st_asewkb(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))')));
select hex(_st_asewkb(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
create table test__st_asewkb(b varchar(1024));
insert into test__st_asewkb values(_st_asewkb(st_geomfromtext('point(3 3)'))),(_st_asewkb(st_geomfromtext('point(2 2)')));
select hex(b) from test__st_asewkb;
update test__st_asewkb set b=null where b=_st_asewkb(st_geomfromtext('point(2 2)'));
select * from test__st_asewkb;
update test__st_asewkb set b=_st_asewkb(st_geomfromtext('point(3 3)'));
select hex(b) from test__st_asewkb;
update test__st_asewkb set b=_st_asewkb(st_geomfromtext('point(2 2)')) where b=_st_asewkb(st_geomfromtext('point(3 3)'));
select hex(b) from test__st_asewkb;
create table func_test(c1 geometry,  c2 varchar(200));
insert into func_test values(st_geomfromtext('point(3 5)'), 'axis-order=lat-long'),(st_geomfromtext('point(2 3)'), 'axis-order=long-lat');
select hex(_st_asewkb(c1)) from func_test;
drop table func_test;
truncate table test__st_asewkb;
insert into test__st_asewkb values('point(3 3)'),(x'010100000000000000000000400000000000000040');
select hex(b) from test__st_asewkb where b=_st_asewkb(st_geomfromtext('point(2 2)'));
delete from test__st_asewkb where b=_st_asewkb(st_geomfromtext('point(2 2)'));
select * from test__st_asewkb;

###2-34、_st_transform
--error 5054
select _st_transform();
--error 5252
select st_astext(_st_transform(3, 4326));
select st_astext(_st_transform(null, 4326));
--error 5252
select st_astext(_st_transform(st_geomfromtext('point(1 1)', 4326), 4230.33));
select st_astext(_st_transform(st_geomfromtext('point(1 1)', 4326), null));
select st_astext(_st_transform(st_geomfromtext('point(1 1)', 4326), 4230));
select st_astext(_st_transform(st_geomfromtext('linestring(1 1, 2 3)', 4326), 4230));
select st_astext(_st_transform(st_geomfromtext('polygon((1 1, 2 2, 3 3, 1 1))', 4326), 4230));
select st_astext(_st_transform(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326), 4230));
select st_astext(_st_transform(st_geomfromtext('multipoint(1 1, 2 2)', 4326), '+proj=longlat +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +no_defs')) res;
select st_astext(_st_transform(st_geomfromtext('multilinestring((1 1, 2 2))', 4326), '+proj=longlat +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +no_defs')) res;
select st_astext(_st_transform(st_geomfromtext('multipolygon(((1 1, 2 2, 3 3, 1 1)))', 4326), '+proj=longlat +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +no_defs'));
select st_astext(_st_transform(st_geomfromtext('point(1 1)'), '+proj=longlat +ellps=mod_airy +towgs84=482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15 +no_defs', '+proj=longlat +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +no_defs')) res;
select st_astext(_st_transform(st_geomfromtext('linestring(1 1, 2 3)'),'+proj=longlat +ellps=mod_airy +towgs84=482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15 +no_defs', '+proj=longlat +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +no_defs')) res;
select st_astext(_st_transform(st_geomfromtext('polygon((1 1, 2 2, 3 3, 1 1))'), '+proj=longlat +ellps=bessel +towgs84=-146.414,507.337,680.507,0,0,0,0 +no_defs','+proj=longlat +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +no_defs')) res;
select st_astext(_st_transform(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), '+proj=longlat +ellps=bessel +towgs84=-146.414,507.337,680.507,0,0,0,0 +no_defs', '+proj=longlat +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +no_defs'));
select st_astext(_st_transform(st_geomfromtext('linestring(1 1, 2 3)'),'+proj=longlat +ellps=mod_airy +towgs84=482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15 +no_defs', 4230)) res;
select st_astext(_st_transform(st_geomfromtext('multipolygon(((1 1, 2 2, 3 3, 1 1)))'), '+proj=longlat +ellps=bessel +towgs84=-146.414,507.337,680.507,0,0,0,0 +no_defs',4230)) res;
select st_astext(_st_transform(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), '+proj=longlat +ellps=bessel +towgs84=-146.414,507.337,680.507,0,0,0,0 +no_defs',4230));
select st_astext(_st_transform(st_geomfromtext('point(1 1)'), '+proj=tmerc +lat_0=0 +lon_0=-62 +k=0.9995000000000001 +x_0=400000 +y_0=0 +ellps=clrk80 +towgs84=-255,-15,71,0,0,0,0 +units=m +no_defs', '+proj=longlat +ellps=intl +towgs84=-87,-98,-121,0,0,0,0 +no_defs'));
select st_astext(_st_transform(st_geomfromtext('point(1 1)', 4326), '+proj=tmerc +lat_0=0 +lon_0=-62 +k=0.9995000000000001 +x_0=400000 +y_0=0 +ellps=clrk80 +towgs84=-255,-15,71,0,0,0,0 +units=m +no_defs'));
select st_astext(_st_transform(st_geomfromtext('point(1 1)'), '+proj=longlat +datum=WGS84 +no_defs', '+proj=tmerc +lat_0=0 +lon_0=-62 +k=0.9995000000000001 +x_0=400000 +y_0=0 +ellps=clrk80 +towgs84=-255,-15,71,0,0,0,0 +units=m +no_defs'));
select st_astext(_st_transform(st_geomfromtext('point(1 1)', 2002), '+proj=tmerc +lat_0=0 +lon_0=-62 +k=0.9995000000000001 +x_0=400000 +y_0=0 +ellps=clrk80 +towgs84=-255,-15,71,0,0,0,0 +units=m +no_defs'));
select st_astext(_st_transform(st_geomfromtext('point(1 1)'), '+proj=tmerc +lat_0=0 +lon_0=-62 +k=0.9995000000000001 +x_0=400000 +y_0=0 +ellps=clrk80 +towgs84=725,685,536,0,0,0,0 +units=m +no_defs', 2001));
select st_astext(_st_transform(st_geomfromtext('point(1 1)', 4326), 4326));
--error 5238
select st_astext(_st_transform(st_geomfromtext('point(1 1)', 4326), 100));
select st_astext(_st_transform(st_geomfromtext('point(1 1)'), '+proj=longlat +datum=WGS84 +no_defs', '+proj=longlat +ellps=GRS80 +no_defs'));
select st_astext(_st_transform(st_geomfromtext('point(1 1)', 7037), 4326));
select st_astext(_st_transform(st_geomfromtext('point(1 1)'), '+proj=longlat +ellps=GRS80 +no_defs', '+proj=longlat +ellps=GRS80 +no_defs'));
--error 5247
select st_astext(_st_transform(st_geomfromtext('point(1 1)'), '+proj=longlat +ellps=GRS80 +no_defs'));
select st_srid(_st_transform(st_geomfromtext('point(1 1)', 4326), 4230));
create table test(b geometry);
insert into test values(st_geomfromtext('point(1 1)', 4326)),(_st_transform(st_geomfromtext('point(1 1)', 4326), 4230));
select hex(b) from test;
update test set b= st_geomfromtext('point(1 1)', 4230) where b=_st_transform(st_geomfromtext('point(1 1)', 4326), 4230);
select hex(b) from test;
update test set b=_st_transform(st_geomfromtext('point(2 2)', 4326), 4230);
select hex(b) from test;
select hex(_st_transform(b, 4326)) from test;
select hex(b) from test where b = _st_transform(st_geomfromtext('point(2 2)', 4326), 4230);
delete from test where b=_st_transform(st_geomfromtext('point(2 2)', 4326), 4230);
select hex(b) from test;
drop table test;

###2-35、_st_dwithin
--error 5054
select _st_dwithin(point(1,1));
--error 5252
select _st_dwithin(point(1,1),1,2.1);
select _st_dwithin(point(1,1),null,2.1);
select _st_dwithin(point(1,1),point(1,1),1.1);
select _st_dwithin(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F',2) res;
select _st_dwithin(point(1,1),point(1,2),1) res;
select _st_dwithin(point(1,1), st_geomfromtext('point(1 2 1)'),0.1);
select _st_dwithin(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001),1) res;
select _st_dwithin(st_geomfromtext('point(2 2)'),st_geomfromtext('point(1 1)'),4) res;
select _st_dwithin(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001),1) res;
select _st_dwithin(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 7037),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 7037),8) res;
select _st_dwithin(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001),4) res;
select _st_dwithin(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 7037),st_geomfromtext('linestringz(0 4 2, 4 4 5)', 7037),32.3) res;
select _st_dwithin(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001),20) res;
select _st_dwithin(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))',7037),st_geomfromtext('multilinestringz((1 1 6, 2 2 7),(2 2 4, 3 1 1))',7037),7644) res;
select _st_dwithin(st_geomfromtext('polygon((2 2, 2 1, 3 1, 2 2))', 2001),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),1.231) res;
select _st_dwithin(st_geomfromtext('polygonz((12 12 3, 12 11 4, 13 11 5, 12 12 3))', 7037),st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 7037),1234) res;
select _st_dwithin(st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),864) res;
select _st_dwithin(st_geomfromtext('polygonz((1 1 1, 2 2 2, 2 1 3, 1 1 1))', 2001),st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),1) res;
select _st_dwithin(st_geomfromtext('multipolygon(((4 0, 4 4, 10 4, 10 0, 4 0)))'),st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))'),1) res;
select _st_dwithin(st_geomfromtext('multipolygonz(((34 30 1, 34 34 2, 30 34 3, 30 30 4, 34 30 1)))', 7037),st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 7037),32) res;
select _st_dwithin(st_geomfromtext('geometrycollection(point(10 14), linestring(10 10, 11 12))', 2001),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),12) res;
select _st_dwithin(st_geomfromtext('point(1 6)',4326), st_geomfromtext('multipoint(1 1, 2 2)',4326),50000) res;
select _st_dwithin(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(0 0, 1 1)'),43) res;
select _st_dwithin(st_geomfromtext('point(1 3)',2001), st_geomfromtext('linestring(1 1, 3 3)',2001),123) res;
select _st_dwithin(st_geomfromtext('point(15 15)',2001),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))',2001),32) res;
select _st_dwithin(st_geomfromtext('point(4 4)',4326),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))',4326),98767) res;
select _st_dwithin(st_geomfromtext('point(1 1)'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),12) res;
select _st_dwithin(st_geomfromtext('point(-1 -1)',4326),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326),1.2) res;
select _st_dwithin(st_geomfromtext('multipoint(0 0, -1 -1)',4326),st_geomfromtext('linestring(1 1, 3 3)',4326),3456789) res;
select _st_dwithin(st_geomfromtext('multipoint(0 0, 2 2)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),1) res;
select _st_dwithin(st_geomfromtext('multipoint(0 0, 4 4)',2001),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))',2001),12) res;
select _st_dwithin(st_geomfromtext('multipoint(2 0, 2 4)',2001),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))',2001),32) res;
select _st_dwithin(st_geomfromtext('multipoint(-1 -1, 0 -1)',2001),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))',2001),0.1) res;
select _st_dwithin(st_geomfromtext('multipoint(-1 -1, 10 10)',2001),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',2001),12) res;
select _st_dwithin(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),8.92) res;
select _st_dwithin(st_geomfromtext('linestring(11 11, 13 11)',2001),st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))',2001),43121) res;
select _st_dwithin(st_geomfromtext('linestring(2 0, 2 -3)',4326),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))',4326),123132) res;
select _st_dwithin(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),1) res;
select _st_dwithin(st_geomfromtext('linestring(-1 -1, -8 -8)',2001),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))',2001),19) res;
select _st_dwithin(st_geomfromtext('linestring(-1 -1, -8 -8)',4326),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326),2) res;
select _st_dwithin(st_geomfromtext('multilinestring((11 11, 12 12),(12 11, 12 12))',2001),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))',2001),1) res;
select _st_dwithin(st_geomfromtext('multilinestring((0 1, 0 2),(0 4, 0 5))',4326),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))',4326),1) res;
select _st_dwithin(st_geomfromtext('multilinestring((0 0, 8 8),(0 0, 3 1))'),st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'),13) res;
select _st_dwithin(st_geomfromtext('multilinestring((12 13, 13 14),(11 12, 12 13))',4326),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326),1) res;
select _st_dwithin(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'),34) res;
select _st_dwithin(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))',4326),st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))',4326),1342523) res;
create table test(a geometry, b double, c geometry);
insert into test values(point(0,3), _st_dwithin(point(0,3), point(0,3),1), point(0,3)),(point(0,4), _st_dwithin(point(0,4), point(0,3),0.4), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = _st_dwithin(a, c, 1);
select _st_asewkt(a), b from test;
update test set b=_st_dwithin(a,c,0.5);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select _st_dwithin(a,c,1) *  _st_dwithin(a,c,0.12) from test;
select _st_asewkt(a), b from test where b = _st_dwithin(a,c,0.5);
delete from test where b = _st_dwithin(a,c,0.5);
drop table test;

###2-36、st_centroid
--error 5054
select st_centroid(point(1,1),1);
--error 5238
select st_centroid(cast(1.1 as double));
select st_centroid(null);
select (st_astext(st_centroid(x'00000000010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000'))) res;
select st_astext(st_centroid(st_geomfromtext('point(1 2)')));
select st_astext(st_centroid(st_geomfromtext('multipoint(1 2, 2 3)')));
select st_astext(st_centroid(st_geomfromtext('linestring(1 2, 2 3)')));
select st_astext(st_centroid(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))')));
select st_astext(st_centroid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',2001)));
--error 5246
select st_astext(st_centroid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',4326)));
select st_astext(st_centroid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select st_astext(st_centroid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',2001)));
select st_astext(st_centroid(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))')));
select st_astext(st_centroid(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))',2001)));
select st_astext(st_centroid(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
create table test(a geometry, b geometry);
insert into test values(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), st_centroid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'))),(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), st_centroid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select st_astext(a), st_astext(b) from test;
update test set b=st_buffer(st_centroid(a),1) where b = st_centroid(a);
select st_astext(a), st_astext(b) from test;
update test set b=st_centroid(a);
select st_astext(a), st_astext(b) from test;
select st_astext(st_centroid(a))   from test;
select st_astext(a), st_astext(b) from test where b = st_centroid(a);
delete from test where b = st_centroid(a);
drop table test;

###2-37、st_crosses
--error 5054
select st_crosses();
--error 5252
select st_crosses(cast(1.1 as json), point(1,1));
select st_crosses(null, point(1,1));
--error 5252
select st_crosses(point(1,1),1);
select st_crosses(point(1,1),null);
select st_crosses(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select st_crosses(point(1,1),point(1,1)) res;
select st_crosses(point(1,1), st_geomfromtext('point(1 1 1)'));
select st_crosses(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 1)', 4326)) res;
select st_crosses(st_geomfromtext('pointz(1 1 1)'),st_geomfromtext('pointz(1 1 2)')) res;
select st_crosses(st_geomfromtext('multipoint(1 1, 2 2)', 4326),st_geomfromtext('multipoint(1 1, 3 2)', 4326)) res;
select st_crosses(st_geomfromtext('multipoint(1 1, 2 2)'),st_geomfromtext('multipoint(1 1, 2 2)')) res;
select st_crosses(st_geomfromtext('linestring(1 1, 2 2)', 4326),st_geomfromtext('linestring(1 1, 3 2)', 4326)) res;
select st_crosses(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('linestring(1 0, 0 1)')) res;
select st_crosses(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 4326),st_geomfromtext('multilinestring((0 0, 1.5 1.5))', 4326)) res;
select st_crosses(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),st_geomfromtext('multilinestring((1 3, 2 2),(2 2, 3 0))')) res;
select st_crosses(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 4326),st_geomfromtext('polygon((1 1, 2 2, 1 3, 1 1))', 4326)) res;
select st_crosses(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((0 0, -1 1, 0 -1, 0 0))', 2001)) res;
select st_crosses(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 4326),st_geomfromtext('polygon((3 3, 3 4, 4 4, 4 3, 3 3))', 4326)) res;
select st_crosses(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((9 0, 9 1, 10 1, 10 0, 9 0))', 2001)) res;
select st_crosses(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 4326),st_geomfromtext('multipolygon(((3 3, 3 4, 4 4, 4 3, 3 3)))', 4326)) res;
select st_crosses(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((9 0, 9 1, 10 1, 10 0, 9 0)))', 2001)) res;
select st_crosses(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326),st_geomfromtext('geometrycollection(point(10 4))', 4326)) res;
select st_crosses(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(2 4), polygon((0 0, 2 0, 2 2, 0 2, 0 0)))', 2001)) res;
select st_crosses(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(1 1, 2 2)')) res;
select st_crosses(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_crosses(st_geomfromtext('point(2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_crosses(st_geomfromtext('point(0 0)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_crosses(st_geomfromtext('point(2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_crosses(st_geomfromtext('point(-1 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;select st_crosses(st_geomfromtext('point(1 1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_crosses(st_geomfromtext('point(-1 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_crosses(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_crosses(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_crosses(st_geomfromtext('multipoint(1.5 1.5, 3 1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_crosses(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_crosses(st_geomfromtext('multipoint(0 0, -1 -1)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_crosses(st_geomfromtext('multipoint(0 0, 3 3)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_crosses(st_geomfromtext('multipoint(-1 -1, 0 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_crosses(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_crosses(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_crosses(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_crosses(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_crosses(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_crosses(st_geomfromtext('linestring(3 3, 4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_crosses(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_crosses(st_geomfromtext('linestring(2 3, 0 0)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_crosses(st_geomfromtext('multilinestring((0 1.5, 4 1.5),(0 0, 0 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_crosses(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_crosses(st_geomfromtext('multilinestring((0 -1, -2 0),(-2 0, -1 0))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_crosses(st_geomfromtext('multilinestring((0 0, 4 4),(-1 -2, -3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_crosses(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
create table test(a geometry, b int, c geometry);
insert into test values(st_geomfromtext('multipoint(0 0, 2 2)'), st_crosses(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')),(st_geomfromtext('multipoint(0 0, 2 1.5)'), st_crosses(st_geomfromtext('multipoint(0 0, 2 1.5)'),st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_crosses(a, c);
select _st_asewkt(a), b from test;
update test set b=st_crosses(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_crosses(a,c) *  st_crosses(a,c) from test;
select _st_asewkt(a), b from test where b = st_crosses(a,c);
delete from test where b = st_crosses(a,c);
drop table test;

###2-38、st_overlaps
--error 5054
select st_overlaps(1,2,3);
--error 5252
select st_overlaps(cast(1.1 as json), point(1,1));
select st_overlaps(null, point(1,1));
select st_overlaps(point(1,1),null);
select st_overlaps(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select st_overlaps(point(1,1),point(1,1)) res;
select st_overlaps(point(1,1), st_geomfromtext('point(1 2 1)'));
select st_overlaps(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select st_overlaps(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select st_overlaps(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001)) res;
select st_overlaps(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001)) res;
select st_overlaps(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001)) res;
select st_overlaps(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(3 1 2, 3 2 5)', 2001)) res;
select st_overlaps(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001)) res;
select st_overlaps(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 3 6, 2 2 7),(2 2 4, 3 0 1))')) res;
select st_overlaps(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((2 2, 2 1, 3 1, 2 2))', 2001)) res;
select st_overlaps(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001)) res;
select st_overlaps(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001)) res;
select st_overlaps(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1))', 2001)) res;
select st_overlaps(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((4 0, 4 4, 10 4, 10 0, 4 0)))', 2001)) res;
select st_overlaps(st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 2001),st_geomfromtext('multipolygonz(((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1)))', 2001)) res;
select st_overlaps(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(10 4), linestring(0 0, 1 2))', 2001)) res;
select st_overlaps(st_geomfromtext('point(1 1)'), st_geomfromtext('multipoint(1 1, 2 2)')) res;
select st_overlaps(st_geomfromtext('point(1 1)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_overlaps(st_geomfromtext('point(0 0)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_overlaps(st_geomfromtext('point(1.5 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_overlaps(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('point(2 2)')) res;
select st_overlaps(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('point(0 0)')) res;
select st_overlaps(st_geomfromtext('point(4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_overlaps(st_geomfromtext('point(1 1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_overlaps(st_geomfromtext('point(-1 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_overlaps(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_overlaps(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_overlaps(st_geomfromtext('multipoint(0 0, 4 4)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_overlaps(st_geomfromtext('multipoint(0 0, 2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_overlaps(st_geomfromtext('multipoint(0 0, 3 3)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_overlaps(st_geomfromtext('multipoint(-1 -1, 0 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_overlaps(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_overlaps(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_overlaps(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_overlaps(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_overlaps(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_overlaps(st_geomfromtext('linestring(-1 -1, 0 -2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_overlaps(st_geomfromtext('linestring(-1 -1, 0 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_overlaps(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_overlaps(st_geomfromtext('multilinestring((0 1, 0 2),(0 4, 0 5))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_overlaps(st_geomfromtext('multilinestring((0 0, 8 8),(0 0, 3 1))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_overlaps(st_geomfromtext('multilinestring((2 3, 3 4),(8 8, 9 9))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_overlaps(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_overlaps(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))')) res;
create table test(a geometry, b int, c geometry);
insert into test values(st_geomfromtext('linestring(0 0, 2 2)'), st_overlaps(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('linestring(1 1, 3 3)')), st_geomfromtext('linestring(1 1, 3 3)')),(st_geomfromtext('linestring(0 0, 2 2)'), st_overlaps(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('linestring(0 0, 3 3)')), st_geomfromtext('linestring(0 0, 3 3)'));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_overlaps(a, c);
select _st_asewkt(a), b from test;
update test set b=st_overlaps(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_overlaps(a,c) *  st_overlaps(a,c) from test;
select _st_asewkt(a), b from test where b = st_overlaps(a,c);
delete from test where b = st_overlaps(a,c);
drop table test;

###2-39、st_union
--error 5054
select st_union(point(1,1));
select st_union(null, point(1,1));
--error 5252
select st_union(point(1,1),cast(1.1 as json));
select st_union(point(1,1),null);
select _st_asewkt(st_union(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F')) res;
select _st_asewkt(st_union(point(1,1),point(1,2))) res;
select _st_asewkt(st_union(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(3 1 2, 3 2 5)', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 3 6, 2 2 7),(2 2 4, 3 0 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((2 2, 2 1, 3 1, 2 2))', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1))', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((4 0, 4 4, 10 4, 10 0, 4 0)))', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 2001),st_geomfromtext('multipolygonz(((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1)))', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(10 4), linestring(0 0, 1 2))', 2001))) res;
select _st_asewkt(st_union(st_geomfromtext('point(1 1)'), st_geomfromtext('multipoint(1 1, 2 2)'))) res;
select _st_asewkt(st_union(st_geomfromtext('point(1 1)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_union(st_geomfromtext('point(0 0)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_union(st_geomfromtext('point(1.5 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('point(2 2)'))) res;
select _st_asewkt(st_union(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('point(0 0)'))) res;
select _st_asewkt(st_union(st_geomfromtext('point(4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_union(st_geomfromtext('point(1 1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_union(st_geomfromtext('point(-1 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_union(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_union(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multipoint(0 0, 4 4)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multipoint(0 0, 2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multipoint(0 0, 3 3)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multipoint(-1 -1, 0 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_union(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_union(st_geomfromtext('linestring(-1 -1, 0 -2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_union(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_union(st_geomfromtext('linestring(2 3, 0 0)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multilinestring((0 1.5, 4 1.5),(0 0, 0 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multilinestring((0 -1, -2 0),(-2 0, -1 0))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_union(st_geomfromtext('multilinestring((0 0, 4 4),(-1 -2, -3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_union(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
create table test(a geometry, b geometry, c geometry);
insert into test values(st_geomfromtext('linestring(0 0, 2 2)'), st_union(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('linestring(1 1, 3 3)')), st_geomfromtext('linestring(1 1, 3 3)')),(st_geomfromtext('linestring(0 0, 2 2)'), st_union(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('linestring(0 0, 3 3)')), st_geomfromtext('linestring(0 0, 3 3)'));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=st_union(b, point(1024,1024)) where b = st_union(a, c);
select _st_asewkt(a), b from test;
update test set b=st_union(a,c);
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select _st_asewkt(st_union(a,b))  from test;
select _st_asewkt(a), _st_asewkt(b) from test where b = st_union(a,c);
delete from test where b = st_union(a,c);
drop table test;

###2-40、st_difference
--error 5054
select st_difference();
select st_difference(null, point(1,1));
--error 5252
select st_difference(point(1,1),1);
select st_difference(point(1,1),null);
select _st_asewkt(st_difference(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F')) res;
select _st_asewkt(st_difference(point(1,1),point(1,1))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(3 1 2, 3 2 5)', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 3 6, 2 2 7),(2 2 4, 3 0 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((2 2, 2 1, 3 1, 2 2))', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1))', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((4 0, 4 4, 10 4, 10 0, 4 0)))', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 2001),st_geomfromtext('multipolygonz(((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1)))', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(10 4), linestring(0 0, 1 2))', 2001))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(1 1)'), st_geomfromtext('multipoint(1 1, 2 2)'))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(1 1)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(0 0)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(1.5 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('point(2 2)'))) res;
select _st_asewkt(st_difference(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('point(0 0)'))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(1 1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(-1 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipoint(0 0, 4 4)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipoint(0 0, 2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipoint(0 0, 3 3)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipoint(-1 -1, 0 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('linestring(-1 -1, 0 -2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('linestring(-1 -1, 0 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multilinestring((0 1, 0 2),(0 4, 0 5))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multilinestring((0 0, 8 8),(0 0, 3 1))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multilinestring((2 3, 3 4),(8 8, 9 9))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_difference(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))'))) res;
create table test(a geometry, b geometry, c geometry);
insert into test values(st_geomfromtext('linestring(0 0, 2 2)'), st_difference(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('linestring(1 1, 3 3)')), st_geomfromtext('linestring(1 1, 3 3)')),(st_geomfromtext('linestring(0 0, 3 3)'), st_difference(st_geomfromtext('linestring(0 0, 3 3)'),st_geomfromtext('linestring(0 0, 2 2)')), st_geomfromtext('linestring(0 0, 2 2)'));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=st_difference(b, point(1024,1024)) where b = st_difference(a, c);
select _st_asewkt(a), _st_asewkt(b) from test;
update test set b=st_difference(a,c);
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select _st_asewkt(st_difference(a,b))  from test;
select _st_asewkt(a), _st_asewkt(b) from test where b = st_difference(a,c);
delete from test where b = st_difference(a,c);
drop table test;

###2-41、st_symdifference
--error 5054
select st_symdifference(1,2,3);
select st_symdifference(null, point(1,1));
--error 5252
select st_symdifference(point(1,1),cast(1.1 as json));
select st_symdifference(point(1,1),null);
select _st_asewkt(st_symdifference(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F')) res;
select _st_asewkt(st_symdifference(point(1,1),point(1,1))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(3 1 2, 3 2 5)', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 3 6, 2 2 7),(2 2 4, 3 0 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((2 2, 2 1, 3 1, 2 2))', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1))', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((4 0, 4 4, 10 4, 10 0, 4 0)))', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 2001),st_geomfromtext('multipolygonz(((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1)))', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(10 4), linestring(0 0, 1 2))', 2001))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(1 1)'), st_geomfromtext('multipoint(1 1, 2 2)'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(1 1)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(0 0)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(1.5 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('point(2 2)'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'),st_geomfromtext('point(0 0)'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(1 1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(-1 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipoint(0 0, 4 4)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipoint(0 0, 2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipoint(0 0, 3 3)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipoint(-1 -1, 0 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('linestring(-1 -1, 0 -2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('linestring(-1 -1, 0 -1)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multilinestring((0 1, 0 2),(0 4, 0 5))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multilinestring((0 0, 8 8),(0 0, 3 1))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multilinestring((2 3, 3 4),(8 8, 9 9))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(st_symdifference(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))'))) res;
create table test(a geometry, b geometry, c geometry);
insert into test values(st_geomfromtext('linestring(0 0, 2 2)'), st_symdifference(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('linestring(1 1, 3 3)')), st_geomfromtext('linestring(1 1, 3 3)')),(st_geomfromtext('linestring(0 0, 3 3)'), st_symdifference(st_geomfromtext('linestring(0 0, 3 3)'),st_geomfromtext('linestring(0 0, 2 2)')), st_geomfromtext('linestring(0 0, 2 2)'));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=st_symdifference(b, point(1024,1024)) where b = st_symdifference(a, c);
select _st_asewkt(a), _st_asewkt(b) from test;
update test set b=st_symdifference(a,c);
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select _st_asewkt(st_symdifference(a,b))  from test;
select _st_asewkt(a), _st_asewkt(b) from test where b = st_symdifference(a,c);
delete from test where b = st_symdifference(a,c);
drop table test;

###2-42、st_length
--error 5054
select st_length(point(1,1),1,2);
select st_length(null);
--error 16
select st_length(st_geomfromtext('linestring(0 0, 1 1)',2001),1);
select st_length(st_geomfromtext('linestring(0 0, 1 1)',2001),null);
select (st_length(x'00000000010200000002000000000000000000F03F000000000000F03F00000000000000400000000000000040')) res;
select st_length(st_geomfromtext('pointz(1 2 3)'));
select st_length(st_geomfromtext('multipoint(1 2, 2 3)'));
select st_length(st_geomfromtext('linestringz(1 2 3, 2 3 4)'));
select st_length(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))'));
select st_length(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))'));
select st_length(st_geomfromtext('linestring(1 1, 2 2)',2001));
select st_length(st_geomfromtext('multilinestring((1 1, 3 1),(2 1, 4 1))',2001));
select st_length(st_geomfromtext('multilinestring((1 1, 3 1),(2 1, 4 1))',4326));
select st_length(st_geomfromtext('multilinestring((1 1, 3 1),(2 1, 4 1))',7037));
select st_length(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))'));
select st_length(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))'));
select st_length(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'));
create table test(a geometry, b double);
insert into test values(st_geomfromtext('linestring(1 1, 5 1)'), st_length(st_geomfromtext('linestring(1 1, 5 1)'))),(st_geomfromtext('linestring(1 1, 2 2)'), st_length(st_geomfromtext('linestring(1 1, 2 2)')));
select st_astext(a), b from test;
update test set b=b+1 where b = st_length(a);
select st_astext(a), b from test;
update test set b=st_length(a);
select st_astext(a), b from test;
select st_length(a) *  st_length(a) from test;
select st_astext(a), b from test where b = st_length(a);
delete from test where b = st_length(a);
drop table test;
--error 16
select st_length(st_geomfromtext('linestring(0 0, 1 0)',0),'British yard (Sears 1922)') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'British foot (Sears 1922)') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'British yard (Sears 1922)') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'chain') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'Clarke\'s foot') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'Clarke\'s yard') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'foot') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'Gold Coast foot') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'Indian yard') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'link') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'nautical mile') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'Statute mile') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'US survey foot') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'US survey link') res;
select st_length(st_geomfromtext('linestring(0 0, 1 0)',2001),'yard') res;

###2-43、st_asgeojson
--error 2
select st_asgeojson(point(1,1),1,2,2);
select st_asgeojson(null);
select st_asgeojson(st_geomfromtext('linestring(0 0, 1 1)',2001),1);
--error 5252
select st_asgeojson(st_geomfromtext('linestring(0 0, 1 1)',2001),1.1);
select st_asgeojson(st_geomfromtext('linestring(0 0, 1 1)',2001),1,null);
select (st_asgeojson(x'00000000010200000002000000000000000000F03F000000000000F03F00000000000000400000000000000040')) res;
select st_asgeojson(st_geomfromtext('point(1 2)'));
select st_asgeojson(st_geomfromtext('multipoint(1 2, 2 3)'));
select st_asgeojson(st_geomfromtext('linestring(1 2, 2 3)'));
select st_asgeojson(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'));
select st_asgeojson(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'));
select st_asgeojson(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'));
select st_asgeojson(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))'));
select st_asgeojson(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',4326));
select st_asgeojson(st_geomfromtext('geometrycollection(point(2.222 3.333), linestring(1.345 2, 2.23 3), polygon((0 0, 4.1165 0, 4 4, 0 4.225, 0 0)))',4326),0) res;
select st_asgeojson(st_geomfromtext('geometrycollection(point(2.222 3.333), linestring(1.345 2, 2.23 3), polygon((0 0, 4.1165 0, 4 4, 0 4.225, 0 0)))',4326),2,1) res;
select st_asgeojson(st_geomfromtext('geometrycollection(point(2.222 3.333), linestring(1.345 2, 2.23 3), polygon((0 0, 4.1165 0, 4 4, 0 4.225, 0 0)))',4326),2,3) res;
select st_asgeojson(st_geomfromtext('geometrycollection(point(2.222 3.333), linestring(1.345 2, 2.23 3), polygon((0 0, 4.1165 0, 4 4, 0 4.225, 0 0)))',4326),2,5) res;
select st_asgeojson(st_geomfromtext('geometrycollection(point(2.222 3.333), linestring(1.345 2, 2.23 3), polygon((0 0, 4.1165 0, 4 4, 0 4.225, 0 0)))',4326),2,7) res;
create table test(a geometry, b json);
insert into test values(st_geomfromtext('linestring(1 1, 5 1)'), st_asgeojson(st_geomfromtext('linestring(1 1, 5 1)'))),(st_geomfromtext('linestring(1 1, 2 2)'), st_asgeojson(st_geomfromtext('linestring(1 1, 2 2)')));
select st_astext(a), b from test;
update test set b=json_extract(b, '$.type') where b = st_asgeojson(a);
select st_astext(a), b from test;
update test set b=st_asgeojson(a);
select st_astext(a), b from test;
select st_asgeojson(a) from test;
select st_astext(a), b from test where b = st_asgeojson(a);
delete from test where b = st_asgeojson(a);
drop table test;

###2-44、_st_pointonsurface
--error 5054
select _st_pointonsurface(point(1,1),1);
select _st_pointonsurface(null);
select (st_astext(_st_pointonsurface(x'00000000010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000'))) res;
select st_astext(_st_pointonsurface(st_geomfromtext('point(1 2)')));
select st_astext(_st_pointonsurface(st_geomfromtext('multipoint(1 2, 2 3)')));
select st_astext(_st_pointonsurface(st_geomfromtext('linestring(1 2, 2 3)')));
select st_astext(_st_pointonsurface(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))')));
select st_astext(_st_pointonsurface(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))')));
select st_astext(_st_pointonsurface(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',2001)));
select st_astext(_st_pointonsurface(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',4326)));
select st_astext(_st_pointonsurface(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',7037)));
select st_astext(_st_pointonsurface(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select st_astext(_st_pointonsurface(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',2001)));
select st_astext(_st_pointonsurface(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))')));
select st_astext(_st_pointonsurface(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))',2001)));
select st_astext(_st_pointonsurface(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))',4326)));
select st_astext(_st_pointonsurface(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))',7037)));
select st_astext(_st_pointonsurface(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')));
create table test(a geometry, b geometry);
insert into test values(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), _st_pointonsurface(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'))),(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), _st_pointonsurface(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select st_astext(a), st_astext(b) from test;
update test set b=st_buffer(_st_pointonsurface(a),1) where b = _st_pointonsurface(a);
select st_astext(a), st_astext(b) from test;
update test set b=_st_pointonsurface(a);
select st_astext(a), st_astext(b) from test;
select st_astext(_st_pointonsurface(a))   from test;
select st_astext(a), st_astext(b) from test where b = _st_pointonsurface(a);
delete from test where b = _st_pointonsurface(a);
drop table test;

###2-45、_st_numinteriorrings
--error 5054
select _st_numinteriorrings();
select _st_numinteriorrings(null);
select (_st_numinteriorrings(x'00000000010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000')) res;
select _st_numinteriorrings(st_geomfromtext('pointz(1 2 3)'));
select _st_numinteriorrings(st_geomfromtext('multipoint(1 2, 2 3)'));
select _st_numinteriorrings(st_geomfromtext('linestringz(1 2 3, 2 3 4)'));
select _st_numinteriorrings(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))'));
select _st_numinteriorrings(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'));
select _st_numinteriorrings(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')) res;
select _st_numinteriorrings(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1), (1 1, 2 1, 2 2, 1 2, 1 1))')) res;
select _st_numinteriorrings(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))'))res;
select _st_numinteriorrings(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))',2001));
select _st_numinteriorrings(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))',4326));
select _st_numinteriorrings(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))',7037));
select _st_numinteriorrings(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))'));
select _st_numinteriorrings(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'));
create table test(a geometry, b double);
insert into test values(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), _st_numinteriorrings(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'))),(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), _st_numinteriorrings(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select st_astext(a), b from test;
update test set b=b+1 where b = _st_numinteriorrings(a);
select st_astext(a), b from test;
update test set b=_st_numinteriorrings(a);
select st_astext(a), b from test;
select _st_numinteriorrings(a) *  _st_numinteriorrings(a) from test;
select st_astext(a), b from test where b = _st_numinteriorrings(a);
delete from test where b = _st_numinteriorrings(a);
drop table test;

###2-46、_st_touches
--error 5054
select _st_touches();
--error 5252
select _st_touches(cast(1.1 as json), point(1,1));
select _st_touches(null, point(1,1));
select _st_touches(point(1,1),null);
select _st_touches(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select _st_touches(point(1,1),point(1,2)) res;
select _st_touches(point(1,1), st_geomfromtext('point(1 2 1)'));
select _st_touches(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select _st_touches(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select _st_touches(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001)) res;
select _st_touches(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001)) res;
select _st_touches(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001)) res;
select _st_touches(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(3 1 2, 3 2 5)', 2001)) res;
select _st_touches(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((0 0, -1 0),(8 8, 3 2))', 2001)) res;
select _st_touches(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 3 6, 2 2 7),(2 2 4, 3 0 1))')) res;
select _st_touches(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((2 2, 2 1, 3 1, 2 2))', 2001)) res;
select _st_touches(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001)) res;
select _st_touches(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001)) res;
select _st_touches(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1))', 2001)) res;
select _st_touches(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((4 0, 4 4, 10 4, 10 0, 4 0)))', 2001)) res;
select _st_touches(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((9 0, 9 1, 10 1, 10 0, 9 0)))', 2001)) res;
select _st_touches(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 4326),st_geomfromtext('geometrycollection(linestring(4 4, 5 4))', 4326)) res;
select _st_touches(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(2 4), polygon((0 0, 2 0, 2 2, 0 2, 0 0)))', 2001)) res;
select _st_touches(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(1 1, 2 2)')) res;
select _st_touches(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select _st_touches(st_geomfromtext('point(2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select _st_touches(st_geomfromtext('point(0 0)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select _st_touches(st_geomfromtext('point(2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select _st_touches(st_geomfromtext('point(1 1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select _st_touches(st_geomfromtext('point(0 0)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select _st_touches(st_geomfromtext('point(2 3)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select _st_touches(st_geomfromtext('multipoint(1 1)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select _st_touches(st_geomfromtext('multipoint(1 1, 3 3)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select _st_touches(st_geomfromtext('multipoint(1.5 1.5, 3 1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select _st_touches(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select _st_touches(st_geomfromtext('multipoint(0 0, -1 -1)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select _st_touches(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select _st_touches(st_geomfromtext('multipoint(0 0, 4 4)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select _st_touches(st_geomfromtext('multipoint(-2 -2, -3 -3)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select _st_touches(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select _st_touches(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select _st_touches(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select _st_touches(st_geomfromtext('linestring(3 3, 4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select _st_touches(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select _st_touches(st_geomfromtext('linestring(2 3, 0 0)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select _st_touches(st_geomfromtext('multilinestring((0 1.5, 4 1.5),(0 0, 0 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select _st_touches(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select _st_touches(st_geomfromtext('multilinestring((0 -1, -2 0),(-2 0, -1 0))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select _st_touches(st_geomfromtext('multilinestring((5 5, 4 4),(-1 -2, -3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select _st_touches(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))')) res;
create table test(a geometry, b int, c geometry);
insert into test values(point(0,3), _st_touches(point(0,3), point(0,3)), point(0,3)),(point(0,4), _st_touches(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = _st_touches(a, c);
select _st_asewkt(a), b from test;
update test set b=_st_touches(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select _st_touches(a,c) *  _st_touches(a,c) from test;
select _st_asewkt(a), b from test where b = _st_touches(a,c);
delete from test where b = _st_touches(a,c);
drop table test;

###2-47、st_equals
--error 5054
select st_equals(1,2,3);
select st_equals(null, point(1,1));
--error 5252
select st_equals(point(1,1),cast(1.1 as json));
select st_equals(point(1,1),null);
select st_equals(x'E61000000101000000000000000000F03F000000000000F03F', x'E61000000101000000000000000000F03F000000000000F03F') res;
select st_equals(point(1,1),point(1,1)) res;
select st_equals(point(1,1), st_geomfromtext('pointz(1 2 1)'));
select st_equals(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select st_equals(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001)) res;
select st_equals(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001)) res;
select st_equals(st_geomfromtext('multipointz(1 1 1, 2 2 3)', 2001),st_geomfromtext('multipointz(3 1 2, 3 2 5)', 2001)) res;
select st_equals(st_geomfromtext('linestring(1 1, 2 2)', 2001),st_geomfromtext('linestring(3 3, 4 4)', 2001)) res;
select st_equals(st_geomfromtext('linestringz(1 1 1, 2 2 3)', 2001),st_geomfromtext('linestringz(3 1 2, 3 2 5)', 2001)) res;
select st_equals(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((3 1, 2 2),(2 2, 1 1))', 2001)) res;
select st_equals(st_geomfromtext('multilinestringz((1 1 2, 2 2 3),(2 2 4, 3 1 5))'),st_geomfromtext('multilinestringz((1 3 6, 2 2 7),(2 2 4, 3 0 1))')) res;
select st_equals(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((1 1, 3 1, 2 2, 1 1))', 2001)) res;
select st_equals(st_geomfromtext('polygonz((1 1 2, 2 2 3, 3 1 4, 1 1 2))', 2001),st_geomfromtext('polygonz((2 2 3, 2 1 4, 3 1 5, 2 2 3))', 2001)) res;
select st_equals(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001)) res;
select st_equals(st_geomfromtext('polygonz((0 0 0, 8 0 1, 8 8 2, 0 8 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0))', 2001),st_geomfromtext('polygonz((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1))', 2001)) res;
select st_equals(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 4326),st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 4326)) res;
select st_equals(st_geomfromtext('multipolygonz(((0 0 0, 8 0 1, 8 8 2, 8 0 3, 0 0 0),(2 2 0, 6 2 1, 6 6 2, 2 6 3, 2 2 0)))', 2001),st_geomfromtext('multipolygonz(((4 0 1, 4 4 2, 10 4 3, 10 0 4, 4 0 1)))', 2001)) res;
select st_equals(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(10 4), linestring(0 0, 1 2))', 2001)) res;
select st_equals(st_geomfromtext('point(1 1)'), st_geomfromtext('multipoint(1 1)')) res;
select st_equals(st_geomfromtext('point(1 1)'), st_geomfromtext('linestring(1 1, 1 1)')) res;
select st_equals(st_geomfromtext('point(0 0)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_equals(st_geomfromtext('point(1.5 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_equals(st_geomfromtext('point(1 1)'), st_geomfromtext('polygon((1 1, 1 1, 1 1, 1 1))')) res;
select st_equals(st_geomfromtext('point(0 0)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_equals(st_geomfromtext('point(4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_equals(st_geomfromtext('point(1 1)'), st_geomfromtext('geometrycollection(point(1 1))')) res;
select st_equals(st_geomfromtext('point(4 4)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_equals(st_geomfromtext('multipoint(2 2)'), st_geomfromtext('linestring(1 1, 3 3)')) res;
select st_equals(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('multilinestring((0 0, 0 0),(2 2, 2 2))')) res;
select st_equals(st_geomfromtext('multipoint(1 1, 3 1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_equals(st_geomfromtext('multipoint(0 0, 2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_equals(st_geomfromtext('multipoint(0 0, 3 3)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_equals(st_geomfromtext('multipoint(-1 -1, 0 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_equals(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_equals(st_geomfromtext('linestring(3 2, 2 2)'), st_geomfromtext('multilinestring((2 2, 3 2))')) res;
select st_equals(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))')) res;
select st_equals(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_equals(st_geomfromtext('linestring(3 3, 2 2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_equals(st_geomfromtext('linestring(-1 -1, 0 -2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_equals(st_geomfromtext('linestring(-1 -1, 0 0)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_equals(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1),(3 1, 1 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_equals(st_geomfromtext('multilinestring((0 1, 0 2),(0 4, 0 5))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))')) res;
select st_equals(st_geomfromtext('multilinestring((0 0, -1 -1),(0 0, -1 0))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))')) res;
select st_equals(st_geomfromtext('multilinestring((2 3, 3 4),(8 8, 9 9))'), st_geomfromtext('geometrycollection(linestring(3 4, 2 3),linestring(9 9, 8 8))')) res;
select st_equals(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_equals(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))')) res;
create table test(a geometry, b int, c geometry);
insert into test values(point(0,3), st_equals(point(0,3), point(0,3)), point(0,3)),(point(0,4), st_equals(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), b, _st_asewkt(c) from test;
update test set b=b+1 where b = st_equals(a, c);
select _st_asewkt(a), b from test;
update test set b=st_equals(a,c);
select _st_asewkt(a), b,_st_asewkt(c) from test;
select st_equals(a,c) *  st_equals(a,c) from test;
select _st_asewkt(a), b from test where b = st_equals(a,c);
delete from test where b = st_equals(a,c);
drop table test;

###2-48、_st_iscollection
--error 5054
select _st_iscollection(point(1,1),1);
select _st_iscollection(null);
select (_st_iscollection(x'00000000010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000')) res;
select _st_iscollection(st_geomfromtext('point(1 2)',4326));
select _st_iscollection(st_geomfromtext('pointz(1 2 3)'));
select _st_iscollection(st_geomfromtext('multipoint(1 2, 2 3)',4326));
select _st_iscollection(st_geomfromtext('multipointz(1 2 4, 2 3 5)'));
select _st_iscollection(st_geomfromtext('linestring(1 2, 2 3)',2001));
select _st_iscollection(st_geomfromtext('linestringz(1 2 3, 2 3 4)'));
select _st_iscollection(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))',4326)) res;
select _st_iscollection(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))')) res;
select _st_iscollection(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',4326)) res;
select _st_iscollection(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))')) res;
select _st_iscollection(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',4326)) res;
select _st_iscollection(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1), (1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1))')) res;
select _st_iscollection(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))',4326)) res;
select _st_iscollection(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))')) res;
select _st_iscollection(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',2001)) res;
select _st_iscollection(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))')) res;
create table test(a geometry, b double);
insert into test values(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), _st_iscollection(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'))),(st_geomfromtext('multipoint(1 1, 2 2)'), _st_iscollection(st_geomfromtext('multipoint(1 1, 2 2)')));
select st_astext(a), b from test;
update test set b=b+1 where b = _st_iscollection(a);
select st_astext(a), b from test;
update test set b=_st_iscollection(a);
select st_astext(a), b from test;
select _st_iscollection(a) *  _st_iscollection(a) from test;
select st_astext(a), b from test where b = _st_iscollection(a);
delete from test where b = _st_iscollection(a);
drop table test;

###2-49、_st_geometrytype
--error 5054
select _st_geometrytype();
--error 5252
select _st_geometrytype(cast(1.1 as double));
select _st_geometrytype(null);
select (_st_geometrytype(x'00000000010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000')) res;
select _st_geometrytype(st_geomfromtext('point(1 2)',4326));
--error 5213
select _st_geometrytype(st_geomfromtext('pointz(1 2 3)'));
select _st_geometrytype(st_geomfromtext('multipoint(1 2, 2 3)',4326));
select _st_geometrytype(st_geomfromtext('linestring(1 2, 2 3)',2001));
select _st_geometrytype(st_geomfromtext('multilinestring((1 2, 2 3),(3 4, 5 6))',4326)) res;
select _st_geometrytype(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',4326)) res;
select _st_geometrytype(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',2001)) res;
select _st_geometrytype(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))',2001)) res;
select _st_geometrytype(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))',2001)) res;
create table test(a geometry, b varchar(100));
insert into test values(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'), _st_geometrytype(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))'))),(st_geomfromtext('multipoint(1 1, 2 2)'), _st_geometrytype(st_geomfromtext('multipoint(1 1, 2 2)')));
select st_astext(a), b from test;
update test set b=substr(b,2) where b = _st_geometrytype(a);
select st_astext(a), b from test;
update test set b=_st_geometrytype(a);
select st_astext(a), b from test;
select _st_geometrytype(a)  from test;
select st_astext(a), b from test where b = _st_geometrytype(a);
delete from test where b = _st_geometrytype(a);
drop table test;

###2-50、_st_makeenvelope
--error 2
select _st_makeenvelope(1,2,3,4,5,6);
--error 2
select _st_asewkt(_st_makeenvelope(cast(1.1 as json),2,3,4));
select _st_asewkt(_st_makeenvelope(null,2,3,4));
select _st_asewkt(_st_makeenvelope(1,1,3,4));
select _st_asewkt(_st_makeenvelope(1,null,3,4));
select _st_asewkt(_st_makeenvelope(1,2,3,4,4326));
select _st_asewkt(_st_makeenvelope(1,2,3,4,'aaaa'));
--error 5238
select _st_asewkt(_st_makeenvelope(1,2,3,4,3));
select _st_asewkt(_st_makeenvelope(1,2,3,2));
select _st_asewkt(_st_makeenvelope(1,2,1,4));
select _st_asewkt(_st_makeenvelope(1,2,1,0));
select _st_asewkt(_st_makeenvelope(5,2,3,2));
select _st_asewkt(_st_makeenvelope(1,2,3,4,2001));
select _st_asewkt(_st_makeenvelope(-181,-181,181,181));
create table test(a geometry, x double, y double);
insert into test values(_st_makeenvelope(1, 1, 2, 2),1,2),(_st_makeenvelope(3, 3, 4, 4),3,4);
select st_astext(a), x, y from test;
update test set x=0 where a = _st_makeenvelope(x,x,y,y);
select st_astext(a), x, y from test;
update test set a=_st_makeenvelope(x,x,y,y);
select st_astext(a), x, y from test;
select st_astext(_st_makeenvelope(x,x,y,y))  from test;
select st_astext(a), x, y from test where a = _st_makeenvelope(x,x,y,y);
delete from test where a = _st_makeenvelope(x,x,y,y);
drop table test;

###2-51、_st_clipbybox2d
--error 5054
select _st_clipbybox2d(1,2,3);
select _st_asewkt(_st_clipbybox2d(_st_makeenvelope(1.5, 1.5, 2.5, 2.5),_st_makeenvelope(1, 1, 2, 2)));
--error 5252
select _st_asewkt(_st_clipbybox2d(cast(1.1 as json),_st_makeenvelope(1, 1, 2, 2)));
select _st_asewkt(_st_clipbybox2d(null,_st_makeenvelope(1, 1, 2, 2)));
select _st_asewkt(_st_clipbybox2d(_st_makeenvelope(1, 1, 2, 2),null));
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(1 1)', 4326),st_geomfromtext('point(1 1)', 4326))) res;select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(1 1)', 2001),st_geomfromtext('point(1 1)', 2001))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(2 2)', 2001),st_geomfromtext('point(1 1)', 2001))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipoint(1 1, 2 2)', 2001),st_geomfromtext('multipoint(3 1, 3 2)', 2001))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('linestring(0 0, 1 1)', 4326),st_geomfromtext('linestring(1 1, 0 0)', 4326))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('linestring(1 0, 0 1)'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))', 2001),st_geomfromtext('multilinestring((3 1, 2 2),(2 2, 1 1))', 2001))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 4326),st_geomfromtext('polygon((1 3, 2 2, 3 3, 1 3))', 4326))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((0 0, -1 1, 0 -1, 0 0))', 2001))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((4 0, 4 4, 10 4, 10 0, 4 0))', 2001))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))'),st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 2 6, 6 6, 6 2, 2 2)))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((9 0, 9 1, 10 1, 10 0, 9 0)))', 2001))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))', 2001),st_geomfromtext('geometrycollection(point(10 4), linestring(0 0, 1 2))', 2001))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(1 1)'), st_geomfromtext('multipoint(1 1)'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(1 1)'), st_geomfromtext('linestring(1 1, 1 1)'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(0 0)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(1.5 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(1 1)'), st_geomfromtext('polygon((1 1, 1 1, 1 1, 1 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(0 0)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(1 1)'), st_geomfromtext('geometrycollection(point(1 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('point(4 4)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipoint(2 2)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipoint(0 0, 2 2)'), st_geomfromtext('multilinestring((0 0, 0 0),(2 2, 2 2))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipoint(1 1, 3 1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipoint(0 0, 2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipoint(0 0, 3 3)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipoint(-1 -1, 0 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multipoint(-1 -1, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('linestring(3 2, 2 2)'), st_geomfromtext('multilinestring((2 2, 3 2))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('linestring(0 0, -1 -1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('linestring(3 3, 2 2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('linestring(-1 -1, 0 -2)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('linestring(-1 -1, 0 0)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1),(3 1, 1 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multilinestring((0 1, 0 2),(0 4, 0 5))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multilinestring((0 0, -1 -1),(0 0, -1 0))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multilinestring((2 3, 3 4),(8 8, 9 9))'), st_geomfromtext('geometrycollection(linestring(3 4, 2 3),linestring(9 9, 8 8))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(_st_clipbybox2d(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))'))) res;
create table test(a geometry, b geometry, c geometry);
insert into test values(point(0,3), _st_clipbybox2d(point(0,3), point(0,3)), point(0,3)),(point(0,4), _st_clipbybox2d(point(0,4), point(0,3)), point(0,3));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=point(2,7) where b = _st_clipbybox2d(a, c);
select _st_asewkt(a), _st_asewkt(b) from test;
update test set b=_st_clipbybox2d(a,c);
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select _st_asewkt(_st_clipbybox2d(a,c))  from test;
select _st_asewkt(a), _st_asewkt(b) from test where b = _st_clipbybox2d(a,c);
delete from test where b = _st_clipbybox2d(a,c);
drop table test;

###2-52、st_isvalid
--error 5054
select st_isvalid();
select st_isvalid(null);
select (st_isvalid(x'00000000010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000')) res;
select st_isvalid(st_geomfromtext('pointz(1 2 3)')) res;
select st_isvalid(st_geomfromtext('multipointz(1 2 4, 2 3 5)')) res;
select st_isvalid(st_geomfromtext('linestring(1 2, 1 2)')) res;
select st_isvalid(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))')) res;
select st_isvalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))')) res;
select st_isvalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',2001)) res;
select st_isvalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))',4326)) res;
select st_isvalid(st_geomfromtext('polygon((0 0, 1 1,2 2,0 0))',0)) res;
select st_isvalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')) res;
select st_isvalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',2001)) res;
select st_isvalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1), (1.5 1.5, 1.6 1.5, 1.6 1.6, 1.5 1.6, 1.5 1.5))')) res;
select st_isvalid(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((1 1, 2 1, 2 2, 1 2, 1 1)))')) res;
select st_isvalid(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0), (3 3, 3 5, 5 5, 5 3, 3 3)), ((1 1, 2 1, 2 2, 1 2, 1 1)))')) res;
select st_isvalid(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))')) res;
select st_isvalid(st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 1 2), polygon((0 0,1 1,2 2,0 2,1 1,2 0,0 0)))')) res;
create table test(a geometry, b double);
insert into test values(st_geomfromtext('polygon((0 0,1 1,2 2,0 2,1 1,2 0,0 0))'), st_isvalid(st_geomfromtext('polygon((0 0,1 1,2 2,0 2,1 1,2 0,0 0))'))),(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), st_isvalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select st_astext(a), b from test;
update test set b=b+1 where b = st_isvalid(a);
select st_astext(a), b from test;
update test set b=st_isvalid(a);
select st_astext(a), b from test;
select st_isvalid(a) *  st_isvalid(a) from test;
select st_astext(a), b from test where b = st_isvalid(a);
delete from test where b = st_isvalid(a);
drop table test;

###2-53、_st_makevalid
--error 5054
select _st_makevalid();
select _st_makevalid(null);
select (st_astext(_st_makevalid(x'00000000010300000001000000050000000000000000000000000000000000000000000000000010400000000000000000000000000000104000000000000010400000000000000000000000000000104000000000000000000000000000000000'))) res;
select st_astext(_st_makevalid(st_geomfromtext('pointz(1 2 3)'))) res;
select st_astext(_st_makevalid(st_geomfromtext('multipointz(1 2 4, 2 3 5)'))) res;
select st_astext(_st_makevalid(st_geomfromtext('linestring(1 2, 2 3)'))) res;
select st_astext(_st_makevalid(st_geomfromtext('multilinestringz((1 2 3, 2 3 4),(3 4 5, 5 6 6))'))) res;
--error 5252
select st_astext(_st_makevalid(st_geomfromtext('multilinestring((1 2, 1 2),(3 4, 5 6))'))) res;
select st_astext(_st_makevalid(st_geomfromtext('polygonz((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1))'))) res;
select st_astext(_st_makevalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'))) res;
select st_astext(_st_makevalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))',2001))) res;
select st_astext(_st_makevalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'))) res;
select st_astext(_st_makevalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (3 3, 3 5, 5 5, 5 3, 3 3))'))) res;
select st_astext(_st_makevalid(st_geomfromtext('multipolygonz(((0 0 1, 4 0 1, 4 4 1, 0 4 1, 0 0 1)), ((1 1 1, 2 1 1, 2 2 1, 1 2 1, 1 1 1)))'))) res;
select st_astext(_st_makevalid(st_geomfromtext('multipolygon(((0 0, 4 0, 4 4, 0 4, 0 0)), ((0 0,1 1,2 2,0 2,1 1,2 0,0 0)))'))) res;
select st_astext(_st_makevalid(st_geomfromtext('geometrycollectionz(pointz(2 3 3), linestringz(1 2 2, 2 3 4), polygonz((0 0 4, 4 0 4, 4 4 4, 0 4 4, 0 0 4)))'))) res;
create table test(a geometry, b geometry);
insert into test values(st_geomfromtext('polygon((0 0,1 1,2 2,0 2,1 1,2 0,0 0))'), _st_makevalid(st_geomfromtext('polygon((0 0,1 1,2 2,0 2,1 1,2 0,0 0))'))),(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))'), _st_makevalid(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0), (1 1, 2 1, 2 2, 1 2, 1 1))')));
select st_astext(a), st_astext(b) from test;
update test set b=point(1,1) where b = _st_makevalid(a);
select st_astext(a), st_astext(b) from test;
update test set b=_st_makevalid(a);
select st_astext(a), st_astext(b) from test;
select st_astext(_st_makevalid(a))  from test;
select st_astext(a), st_astext(b) from test where b = _st_makevalid(a);
delete from test where b = _st_makevalid(a);
drop table test;

###2-54、_st_asmvtgeom
--error 2
select _st_asmvtgeom(1,2,3,4,5,6);
select _st_asmvtgeom(null, point(1,1));
--error 5252
select _st_asmvtgeom(point(1,1),null);
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((0 0, 4 0, 4 4, 0 4, 0 0))', 0),st_geomfromtext('linestring(1 1, 2 2)', 2001))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multipoint(1 1, 2 2)'),st_geomfromtext('multipoint(1 1, 2 2)'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('linestring(1 0, 0 1)'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'),st_geomfromtext('multilinestring((1 3, 2 2),(2 2, 3 0))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))', 2001),st_geomfromtext('polygon((0 0, -1 1, 0 -1, 0 0))', 2001))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))', 2001),st_geomfromtext('polygon((9 0, 9 1, 10 1, 10 0, 9 0))', 2001))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multipolygon(((0 0, 8 0, 8 8, 8 0, 0 0)),((2 2, 6 2, 6 6, 2 6, 2 2)))', 2001),st_geomfromtext('multipolygon(((9 0, 9 1, 10 1, 10 0, 9 0)))', 2001))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('point(0 0)'), st_geomfromtext('multipoint(1 1, 5 6)'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('point(2 2)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('point(2 2)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('point(-1 -1)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('point(2 3)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('point(2 2)'), st_geomfromtext('linestring(1 1, 3 3)'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multipoint(1.5 1.5, 3 1)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multipoint(0 0, 2 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multipoint(0 0, 3 3)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multipoint(-2 -2, -3 -3)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('multilinestring((1 1, 2 2),(2 2, 3 1))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('linestring(0 1.5, 4 1.5)'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('linestring(3 3, 4 4)'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multilinestring((0 1.5, 4 1.5),(0 0, 0 1))'), st_geomfromtext('polygon((1 1, 2 2, 3 1, 1 1))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multilinestring((0 -1, -2 0),(-2 0, -1 0))'), st_geomfromtext('polygon((0 0, 8 0, 8 8, 0 8, 0 0),(2 2, 6 2, 6 6, 2 6, 2 2))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('multilinestring((-1 1, -2 2),(2 -2, 3 -1))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(-0.5 -0.5, 4 -0.5, 4 4, -0.5 4, -0.5 -0.5))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 3 0, 3 3, 0 3, 0 0)))'))) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 100)) res;
--error 5234
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 'aaa')) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), null)) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 30)) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 4096, 'aaa')) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 4096, 30)) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 4096, 256, 'aaa')) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 4096, 256, null)) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 4096, 256, true)) res;
select _st_asewkt(_st_asmvtgeom(st_geomfromtext('polygon((-1 -1, -1 5, 5 5, 5 -1, -1 -1),(0 0, 4 0, 4 4, 0 4, 0 0))'), st_geomfromtext('geometrycollection(point(2 3), linestring(1 2, 2 3), polygon((0 0, 4 0, 4 4, 0 4, 0 0)))'), 4096, 256, false)) res;
create table test(a geometry, b geometry, c geometry);
insert into test values(st_geomfromtext('linestring(0 0, 2 2)'), _st_asmvtgeom(st_geomfromtext('linestring(0 0, 2 2)'), st_geomfromtext('linestring(1 1, 3 3)')), st_geomfromtext('linestring(1 1, 3 3)')),(st_geomfromtext('linestring(0 0, 2 2)'), _st_asmvtgeom(st_geomfromtext('linestring(0 0, 2 2)'),st_geomfromtext('linestring(0 0, 3 3)')), st_geomfromtext('linestring(0 0, 3 3)'));
select _st_asewkt(a), _st_asewkt(b), _st_asewkt(c) from test;
update test set b=_st_asmvtgeom(b, linestring(point(1,1), point(2,2))) where b = _st_asmvtgeom(a, c);
select _st_asewkt(a), b from test;
update test set b=_st_asmvtgeom(a,c);
select _st_asewkt(a), _st_asewkt(b),_st_asewkt(c) from test;
select _st_asewkt(_st_asmvtgeom(a,c))  from test;
select _st_asewkt(a), _st_asewkt(b) from test where b = _st_asmvtgeom(a,c);
delete from test where b = _st_asmvtgeom(a,c);
drop table test;
