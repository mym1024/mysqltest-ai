#######################################################
###1.子查询的结果作为左表和另一张表mgrge_join,筛选条件在where后
#######################################################
--disable_warnings
drop table if exists t1,t2;
--enable_warnings

create table t1(c1 int primary key, c2 int, c3 varchar(30));
insert into t1 values(1,1,'aaa');
insert into t1 values(2,2,'bbb');
insert into t1 values(3,3,'ccc');
insert into t1 values(4,4,'ddd');
insert into t1 values(5,5,'eee');
insert into t1 values(6,6,'fff');
insert into t1 values(7,7,'ggg');
insert into t1 values(8,8,'hhh');
insert into t1 values(9,9,'iii');
insert into t1 values(10,10,'jjj');

create table t2(c1 int primary key, c2 int, c3 varchar(30));
insert into t2 values(1,1,'aaa');
insert into t2 values(2,2,'bbb');
insert into t2 values(3,3,'ccc');
insert into t2 values(4,4,'ddd');
insert into t2 values(5,5,'eee');
insert into t2 values(6,6,'fff');
insert into t2 values(7,7,'ggg');
insert into t2 values(8,8,'hhh');
insert into t2 values(9,9,'iii');
insert into t2 values(10,10,'jjj');


###2-1:子查询的结果作为左表和另一张表mgrge_join
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1;
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1;
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1;
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1;
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1;

###2-2:子查询的结果作为左表和另一张表mgrge_join,左表的主键和常量值等值比较，该等值比较条件在where后
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where a.c1=6;
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1 where a.c1=6;
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1 where a.c1=6;
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1 where a.c1=6;
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where a.c1=6;

###2-3:子查询的结果作为左表和另一张表mgrge_join,左表的主键和常量值不等值比较，该不等值比较条件在where后
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where a.c1<6;
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1 where a.c1<6;
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1 where a.c1<6;
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1 where a.c1<6;
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where a.c1<6;

###2-4:子查询的结果作为左表和另一张表mgrge_join,左表的主键取值采用between and操作符，该操作符在where后
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where a.c1 between 1 and 6;
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1 where a.c1 between 1 and 6;
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1 where a.c1 between 1 and 6;
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1 where a.c1 between 1 and 6;
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where a.c1 between 1 and 6;

###2-5:子查询的结果作为左表和另一张表mgrge_join,左表的主键取值采用in操作符，该操作符在where后
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where a.c1 in(1,2,3,4);
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1 where a.c1 in(1,2,3,4);
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1 where a.c1 in(1,2,3,4);
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1 where a.c1 in(1,2,3,4);
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where a.c1 in(1,2,3,4);

###2-6:子查询的结果作为左表和另一张表mgrge_join,左表的主键和常量值等值比较，该等值比较条件在where后
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where b.c1=6;
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1 where b.c1=6;
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1 where b.c1=6;
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1 where b.c1=6;
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where b.c1=6;

###2-7:子查询的结果作为左表和另一张表mgrge_join,左表的主键和常量值不等值比较，该不等值比较条件在where后
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where b.c1<6;
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1 where b.c1<6;
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1 where b.c1<6;
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1 where b.c1<6;
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where b.c1<6;

###2-8:子查询的结果作为左表和另一张表mgrge_join,左表的主键取值采用between and操作符，该操作符在where后
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where b.c1 between 1 and 6;
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1 where b.c1 between 1 and 6;
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1 where b.c1 between 1 and 6;
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1 where b.c1 between 1 and 6;
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where b.c1 between 1 and 6;

###2-9:子查询的结果作为左表和另一张表mgrge_join,左表的主键取值采用in操作符，该操作符在where后
#select /*+ join(hash_join_single) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where b.c1 in(1,2,3,4);
select /*+ join(merge_join) */* from (select * from t1) a inner join t2 b on a.c1=b.c1 where b.c1 in(1,2,3,4);
select /*+ join(merge_join) */* from (select * from t1) a left join t2 b on a.c1=b.c1 where b.c1 in(1,2,3,4);
select /*+ join(merge_join) */* from (select * from t1) a right join t2 b on a.c1=b.c1 where b.c1 in(1,2,3,4);
select /*+ join(merge_join) */* from (select * from t1) a full join t2 b on a.c1=b.c1 where b.c1 in(1,2,3,4);

drop table t1,t2;
#############################################################################