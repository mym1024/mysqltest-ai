####################################必填######################################################
###1.测试功能点：使用prepare执行replace操作，操作过程中修改表结构
##
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：xxx
###6.编写/修改人：zhuyinying
###7.编写/修改日期：2020-01-13
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################
--disable_warnings
drop table if exists t1; 
--enable_warnings

create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);


###2-1:add a new column
prepare stmt1 from replace into t1 values(1,'d',?),(2,'f',6);
set @x=1;
execute stmt1 using @x;
alter table t1 add d int;
--error 5007
execute stmt1 using @x;
select * from t1;
deallocate prepare stmt1;
alter table t1 drop d;


###2-2:drop a no exist column
prepare stmt2 from replace into t1 values(3,'d',3),(4,'f',?);
set @x=1;
execute stmt2 using @x;
--error 5009
alter table t1 drop q;
#set @x=4;
execute stmt2 using @x;
select * from t1;
deallocate prepare stmt2;


###2-3:drop a exist column
prepare stmt3 from replace into t1 values(3,'d',3),(4,'f',?);
set @x=1;
execute stmt3 using @x;
alter table t1 drop c;
#set @x=6;
--error 5007
execute stmt3 using @x;
select * from t1;
deallocate prepare stmt3;


###2-4:add a new column and drop it
prepare stmt4 from replace into t1 values(3,'d'),(4,?);
set @x='x';
execute stmt4 using @x;
alter table t1 add c int;
alter table t1 drop c;
#set @x=8;
execute stmt4 using @x;
select * from t1;
deallocate prepare stmt4;

drop table t1;
create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);


###2-5:drop a exist column,and add it which have same type with before
prepare stmt5 from replace into t1 values(5,'d',?),(4,'f',2);
set @x=2;
execute stmt5 using @x;
alter table t1 drop b;
alter table t1 add b varchar(255);
# set @x=5;
--error 7
execute stmt5 using @x;
select * from t1;
deallocate prepare stmt5;


###2-6:drop a exist column,and it which have difference type with before
prepare stmt6 from replace into t1 values(5,'d',?),(4,'f',2);
set @x=2;
--error 7
execute stmt6 using @x;
alter table t1 drop b;
alter table t1 add b int;
set @x=7;
--error 7
execute stmt6 using @x;
select * from t1;
deallocate prepare stmt6;


###2-7:drop table it
prepare stmt7 from replace into t1 values(1,2,?),(2,5,1);
set @x=2;
execute stmt7 using @x;
drop table t1;
# set @x=9;
--error 5019
execute stmt7 using @x;
deallocate prepare stmt7;

create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);


###2-8:drop table and create it again;
prepare stmt8 from replace into t1 values(1,2,?),(2,5,1);
set @x=2;
execute stmt8 using @x;
drop table t1;
create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);
# set @x=5;
#--error 29
execute stmt8 using @x;
select * from t1;
deallocate prepare stmt8;


###2-9:drop table and create it with diff shema 
prepare stmt9 from replace into t1 values(1,2,?),(2,5,1);
set @x=2;
execute stmt9 using @x;
drop table t1;
create table t1(a int primary key,b varchar(255));
# set @x=5;
--error 5007
execute stmt9 using @x;
select * from t1;
deallocate prepare stmt9;

drop table t1;
create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);

# add column

prepare stmt10 from replace into t1(a,b,c) values(1,'d',?),(2,'f',6);
set @x=1;
execute stmt10 using @x;
alter table t1 add d int;
# set @x=5;
execute stmt10 using @x;
select * from t1;
deallocate prepare stmt10;

drop table t1;
create table t1(a int primary key,b varchar(255),c int,d int);
--real_sleep 5
insert into t1 values(1,'a',2,2);
# alter table t1 add d int;


###2-10:drop no use column
prepare stmt11 from replace into t1(a,b,c) values(1,'d',?),(2,'f',6);
set @x=1;
execute stmt11 using @x;
alter table t1 drop d;
# set @x=5;
execute stmt11 using @x;
select * from t1;
deallocate prepare stmt11;

drop table t1;
create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);
alter table t1 add d int;


###2-11:drop use column
prepare stmt12 from replace into t1(a,b,c) values(1,'d',?),(2,'f',6);
set @x=1;
execute stmt12 using @x;
alter table t1 drop c;
# set @x=5;
--error 5009
execute stmt12 using @x;
select * from t1;
deallocate prepare stmt12;

drop table t1;
create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);


###2-12:have problem
prepare stmt13 from replace into t1(a,b) values(1,'d'),(2,?);
set @x=1;
execute stmt13 using @x;
alter table t1 drop c;
# set @x=5;
execute stmt13 using @x;
select * from t1;
deallocate prepare stmt13;

drop table t1;
create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);


###2-13:drop column add it again with same type
prepare stmt14 from replace into t1(a,b,c) values(1,'d',1),(2,?,1);
set @x=1;
execute stmt14 using @x;
alter table t1 drop c;
alter table t1 add c int;
# set @x=5;
#--error 18
execute stmt14 using @x;
select * from t1;
deallocate prepare stmt14;

drop table t1;
create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);


###2-14:drop column add it again with diff type
prepare stmt15 from replace into t1(a,b,c) values(1,'d',1),(2,?,1);
set @x=1;
execute stmt15 using @x;
alter table t1 drop b;
alter table t1 add b int;
# set @x=5;
--error 7
execute stmt15 using @x;
select * from t1;
deallocate prepare stmt15;

drop table t1;
create table t1(a int primary key,b varchar(255),c int);
--real_sleep 5
insert into t1 values(1,'a',2),(2,'b',3),(3,'c',4);


###2-15:add column drop it again
prepare stmt16 from replace into t1(a,b,c) values(1,'d',1),(2,?,1);
set @x=1;
execute stmt16 using @x;
alter table t1 add d int;
alter table t1 drop d;
# set @x=5;
execute stmt16 using @x;
select * from t1;
deallocate prepare stmt16;


###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################




















































































































































































































































































































































































































































































































































































































































































