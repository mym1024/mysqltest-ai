##############################################################################################
###1.测试功能点：在range分区规则下，批量插入不同类型的数据
##
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：xxx
###6.编写/修改人：zhuyinying
###7.编写/修改日期：2019-12-23
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################

--disable_warnings
drop table if exists trange1,trange2;
--enable_warnings

create table trange1(c1 int primary key,c2 int,c3 real) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
create table trange2(c1 int primary key,c2 int,c3 varchar(30)) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
show table rules;


###2-1:插入不同形式数据
--real_sleep 3
insert into trange2 values(1,1,'haha'),(2,1,'haha'),(3,1,'haha'),(4,1,'haha'),(5,1,'haha'),(6,1,'haha'),(7,1,'haha');
--error 119
insert into trange1 select distinct c2,c1,c3 from trange2;
insert into trange2 values(8,4,'mkoe');
insert into trange1 select c1 as grimp,c2 as tendency,c2 from trange2 where c1=8;
insert into trange2 values(9,4,'mkoe'),(10,4,'mkoe'),(11,4,'mkoe'),(12,4,'mkoe'),(13,4,'mkoe');
insert into trange1 select * from trange2 where c1>8 limit 3;
insert into trange1 select * from trange2 as tinsert where c1=13;
insert into trange2 values(15,3,'maosy');
--error 119
insert into trange1 select * from trange2 where c1=15 for update;

select * from trange1;
select * from trange2;
show partition groups;

--disable_warnings
drop table if exists trange1,trange2;
--enable_warnings
create table trange1(c1 int primary key,c2 int,c3 real) partition by range columns(c1) (partition r0 values less than (8),partition r1 values less than maxvalue);
create table trange2(c1 int primary key,c2 int,c3 varchar(30)) partition by range columns(c1) (partition r0 values less than (8),partition r1 values less than maxvalue);
show table rules;
--real_sleep 3
insert into trange2 values(1,2,'mdetg'),(2,4,'mdetg'),(3,1,'mdetg'),(4,7,'mdetg'),(5,8,'mdetg'),(6,6,'mdetg'),(7,3,'mdetg');

select * from trange1;
select * from trange2;
show partition groups;

--disable_warnings
drop table if exists trange1,trange2,trange3;
--enable_warnings
create table trange1(c1 int primary key,c2 int,c3 real) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
create table trange2(c1 int primary key,c2 int,c3 varchar(30)) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
create table trange3(c1 int primary key,c2 int,c3 varchar(30)) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
show table rules;
--real_sleep 3
insert into trange2 values(1,2,'mdetg'),(2,4,'mdetg'),(3,1,'mdetg'),(4,7,'mdetg'),(5,8,'mdetg'),(6,6,'mdetg'),(7,3,'mdetg');
insert into trange3 values(1,2,'mid'),(3,1,'rdetg');
insert into trange1 select trange2.c1,trange2.c2,trange3.c2 from trange2 inner join trange3 on trange2.c2=trange3.c2;
select * from trange1;
select * from trange2;
select * from trange3;
show partition groups;

--disable_warnings
drop table if exists trange1,trange2;
--enable_warnings
create table trange1(c1 int primary key,c2 int,c3 real) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
create table trange2(c1 int primary key,c2 int,c3 varchar(30)) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
show table rules;
--real_sleep 3
insert into trange2 values(1,2,'mdetg'),(2,4,'mdetg'),(3,1,'mdetg'),(4,7,'mdetg'),(5,8,'mdetg'),(6,6,'mdetg'),(7,3,'mdetg');
insert into trange1(c1,c2) select trange2.c1,trange2.c2 from trange2 left join trange1 on trange2.c2=trange1.c2;
select * from trange1;
select * from trange2;
show partition groups;


--disable_warnings
drop table if exists trange1,trange2,trange3;
--enable_warnings
create table trange1(c1 int primary key,c2 int,c3 real) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
create table trange2(c1 int primary key,c2 int,c3 varchar(30)) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
create table trange3(c1 int primary key,c2 int,c3 varchar(30)) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
--real_sleep 6
show table rules;
--real_sleep 3
insert into trange2 values(1,2,'mdetg'),(2,4,'mdetg'),(3,1,'mdetg'),(4,7,'mdetg'),(5,8,'mdetg'),(6,6,'mdetg'),(7,3,'mdetg');
insert into trange3 values(1,2,'mid'),(3,1,'rdetg');
insert into trange1(c1,c2) select c1,c2 from trange2 union select c1,c2 from trange3;
select * from trange1;
select * from trange2;
select * from trange3;
show partition groups;

--disable_warnings
--real_sleep 6
drop table if exists trange1;
--enable_warnings
create table trange1(c1 int primary key,c2 int,c3 real) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
show table rules;
--real_sleep 3
insert into trange1(c1,c2) select c1,c2 from trange2 except select c1,c2 from trange3;

select * from trange1;
show partition groups;

--disable_warnings
drop table if exists trange1;
--enable_warnings
create table trange1(c1 int primary key,c2 int,c3 real) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
show table rules;
--real_sleep 3
insert into trange1(c1,c2) select c1,c2 from trange2 intersect select c1,c2 from trange3;
select * from trange1;
show partition groups;

--disable_warnings
drop table if exists trange1;
--enable_warnings
create table trange1(c1 int primary key,c2 int,c3 real) partition by range columns(c1) (partition r0 values less than (20),partition r1 values less than maxvalue);
show table rules;
--real_sleep 3
insert into trange1(c1,c2) select c1,c2 from trange2 where c1 in( select c1 from trange3);
insert into trange1(c1,c2) select c1,c2 from trange2 where c1 not in( select c1 from trange1);
select * from trange1;
show partition groups;

###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
