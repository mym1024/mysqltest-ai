##############################################################################################
###1.测试功能点：指定分区规则，通过prepare预执行insert
##
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：xxx
###6.编写/修改人：zhuyinying
###7.编写/修改日期：2020-01-02
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################
--echo case 1:continue insert
###2-1：指定分区规则，通过prepare预执行insert
connect (conn1,$OBMYSQL_MS0,admin,admin,test,$OBMYSQL_PORT);
connection conn1;
drop table if exists t1;
create table t1(pk int primary key,c1 int) partition by list(pk) (partition q0 values in(1,3),partition q1 values in(2,4,5));
--real_sleep 5
prepare stmt from insert into t1 values(?,?);
set autocommit=0;
set @a=1;
set @b=1;
--real_sleep 3
execute stmt using @a,@b;
set @a=2;
set @b=2;
execute stmt using @a,@b;
set @a=3;
set @b=3;
--real_sleep 3
execute stmt using @a,@b;
set @a=4;
set @b=4;
execute stmt using @a,@b;
commit;
set autocommit=1;
--real_sleep 3
select * from t1;
disconnect conn1;


--echo case 2:
connect (conn1,$OBMYSQL_MS0,admin,admin,test,$OBMYSQL_PORT);
connection conn1;
drop table if exists t2;
create table t2(pk int primary key,c1 int) partition by range(pk) (partition r0 values less than(5),partition r1 values less than (10),partition r2 values less than maxvalue);
--real_sleep 5
prepare stmt from insert into t2 values(?,?),(?,?);
set autocommit=0;
set @a=1;
set @b=1;
set @c=2;
set @d=2;
execute stmt using @a,@b,@c,@d;
set @a=3;
set @b=3;
set @c=1;
set @d=1;
--error 5024
execute stmt using @a,@b,@c,@d;
rollback;
set autocommit=1;
select * from t2;
disconnect conn1;
###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
