###########################################################################################
###1.测试功能点：不同分区表的全连接
##
#
###2.测试项：（每新添一测试项,需在添加前注明测试项,注释填写在新添sql前,不填在此处,如下样例）
###2.问题网址：xxx
###3.问题号：xxx
###4.预计运行时间：xxx
###5.编写/修改人：zhuyiying
###6.编写/修改日期：2020-01-03
###7.其它（选填）：case格式规范化修改
###
##
#
###########################################################################################

##########################################################################################
--disable_warnings
drop table if exists t1,t2;
--error 5077
drop partition function h1,e1;
--enable_warnings
#
##
## bug http://
## join with null values
##
create  hash partition function h1(x)'x+4';
CREATE TABLE t1 (
  pk int primary key,
  id int,
  gender varchar(1)
) partition by(ta1,h1,pk);

create enum partition function e1(x)'[(1)],[(2)],[(3)],[(4)],[(null)]';
CREATE TABLE t2 (
  user_id int primary key,
  birthday datetime
) partition by (ta2,e1,user_id);
#--error 7
--real_sleep 5
insert into t1 values (1, NULL, 'M'), (2, 1, 'M'), (3, 2, 'F'),(4, 3, 'F'),(5, 4, 'F'),(6, 5, 'M');
--error 7
insert into t2 values (1, '2002-06-09 00:00:00'),(2, '2002-06-09 00:00:00'),(NULL, '2002-06-09 00:00:00'),
(3, '2002-06-09 00:00:00'),(4, '2002-06-09 00:00:00');

select  id,gender,user_id from t1,t2  where t2.user_id=t1.id;
drop table t1,t2;
--real_sleep 1
drop partition function h1,e1;
###///新添测试项///###
###2-x:(新添测试项说明)
#do sql
##########################################################################################
