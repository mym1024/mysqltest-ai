####################################必填######################################################
###1.测试功能点：分区功能与group功能结合测试
##
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：xxx
###6.编写/修改人：zhuyinying
###7.编写/修改日期：2019-12-18
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################
--disable_warnings
drop table if exists t1,t2;
--real_sleep 3
--enable_warnings

###2-1:range分区
create table t1 (USR_ID int not null,MAX_REQ int not null,primary key (USR_ID))partition by range (USR_ID)(partition v1 values less than(2),partition v2 values less than maxvalue);
exec $LOCAL_DIR/tools/as_admin -r $RS0_IP -p $RS0_PORT refresh_schema | tail -1;
--real_sleep 3
insert into t1 values(1,3);
select count(*) + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ + MAX_REQ - MAX_REQ from t1 group by MAX_REQ;
select Case When Count(*) < MAX_REQ Then 1 Else 0 End from t1 where t1.USR_ID = 1 group by MAX_REQ;
drop table t1;
--real_sleep 3

###2-2:枚举分区
create enum partition function e1(x)'[(a)],[(b)],[(c)]';
create table t1(a char(10) primary key, b char(10));
exec $LOCAL_DIR/tools/as_admin -r $RS0_IP -p $RS0_PORT refresh_schema | tail -1;
--real_sleep 3
insert into t1(a) values('a'),('b'),('c');
select max(a) from t1;
drop table t1;
--real_sleep 3
drop partition function e1;

###2-3:哈希分区
create hash partition function h1(x)'(x+3)*2';
create table t1(a int primary key, b int) partition by (ht1, h1, a);
exec $LOCAL_DIR/tools/as_admin -r $RS0_IP -p $RS0_PORT refresh_schema | tail -1;
--real_sleep 3
insert into t1(a) values(1);
select max(a) as b from t1 having b=1;
select a from t1 having a=1;
drop table t1;
--real_sleep 3
drop partition function h1;


###2-4:list分区
create table t1(a int primary key, b int) partition by list(a)(partition f1 values in(1,3), partition f2 values in(2,4));
exec $LOCAL_DIR/tools/as_admin -r $RS0_IP -p $RS0_PORT refresh_schema | tail -1;
--real_sleep 3
insert into t1(a) values (1),(2),(3),(4);
select MAX(a) from t1 where a > 5; 
select MIN(a) from t1 where a < 0; 
drop table t1;
exec $LOCAL_DIR/tools/as_admin -r $RS0_IP -p $RS0_PORT refresh_schema | tail -1;
--real_sleep 3

###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
