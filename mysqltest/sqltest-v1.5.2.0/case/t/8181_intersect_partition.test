##############################################################################################
###1.测试功能点：在不同分区规则下，测试intersect函数
##
#
###2.测试项：(每新添一测试项，需在添加前注明测试项，注释填写在新添sq1前，不填在此处，如下样例）
###3.问题网址：xxx
###4.问题号：xxx
###5.预计运行时间：xxx
###6.编写/修改人：zhuyinying
###7.编写/修改日期：2020-01-02
###8.其他（选填）：case格式规范化修改
###
##
#
##############################################################################################

#####################################Do sql###################################################

drop table if exists t1,t2,t3,t4;

###2-1：在不同分区规则下，测试intersect函数

create table t1(c1 int primary key ,c2 int) partition by list(c1) (partition q0 values in(1,3),partition q1 values in(2,4,5));
create table t2(c1 int primary key ,c2 int) partition by list(c1) (partition q0 values in(0,1,3,6),partition q1 values in(2,4,5));
create table t3(c1 int ,c2 int primary key) partition by range(c2) (partition r0 values less than(5),partition r1 values less than (10),partition r2 values less than (15),partition r3 values less than maxvalue);
create table t4(c1 int primary key,c2 int ) partition by range(c1) (partition r0 values less than(5),partition r1 values less than (10),partition r2 values less than (15),partition r3 values less than maxvalue);
--real_sleep 5
insert into t1 values(1,1),(2,2),(3,3),(4,4),(5,5);
insert into t2 values(0,0),(2,2),(4,4),(6,6);
insert into t3 values(1,1),(3,3),(5,5),(7,7);
insert into t4 values(1,0),(2,0),(3,1),(4,1);

(select * from t1 where false) intersect (select * from t2 where false);
(select * from t1 where false) intersect select * from t2;
select * from t1  intersect (select * from t2 where false);
(select * from t1 where false) intersect (select * from t2 where false) intersect (select * from t3 where false);
select c1 from t1  intersect select c1 from t1;
select c1 from t1  intersect select c1 from t4;
select c1 from t4  intersect select c1 from t1;
select c1 from t2  intersect select c1 from t3;
select c1 from t1  intersect select c1 from t2;

select c2 from t4  intersect select c2 from t1;
select c2 from t1  intersect select c2 from t4;
select * from t1  intersect (select * from t2 union select * from t3);
(select * from t1  intersect select * from t2) union (select * from t1  intersect select * from t3);

select c2 from t1  intersect select c2 from t3 intersect select c2 from t4;
select c2 from t1  intersect (select c2 from t3 intersect select c2 from t4);
###///新添测试项///###
###2-x:(新增测试项说明)
#do sql
########################################################################################################
